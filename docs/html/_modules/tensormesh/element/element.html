<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tensormesh.element.element &mdash; tensormesh  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/mytheme.css?v=e73ece32" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />

  
    <link rel="shortcut icon" href="https://raw.githubusercontent.com/walkerchi/tensormesh_sphinx_theme/master/tensormesh_sphinx_theme/static/img/tensormesh_logo.webp"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../_static/doctools.js?v=9bcbadda"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="https://raw.githubusercontent.com/walkerchi/tensormesh_sphinx_theme/master/tensormesh_sphinx_theme/static/img/tensormesh_logo.webp" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../get_started/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../get_started/installation.html#installatoion-via-pypi">Installatoion via PyPi</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../get_started/benchmark.html">Benchmark</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../get_started/benchmark.html#m2-pro-cpu">M2 Pro CPU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../get_started/benchmark.html#assemble-speed">Assemble Speed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../get_started/benchmark.html#pipeline-speed">Pipeline Speed</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../get_started/element.html">Basis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../get_started/element.html#line">Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../get_started/element.html#triangle">Triangle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../get_started/element.html#quadrilateral">Quadrilateral</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../get_started/element.html#tetrahedron">Tetrahedron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../get_started/element.html#hexahedron">Hexahedron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../get_started/element.html#pyramid">Pyramid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../get_started/element.html#prism">Prism</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/mesh_gen.html">Mesh Generation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/mesh_gen.html#d-high-order-mesh">2D high order mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/mesh_gen.html#d-high-circle-mesh">2D high circle mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/mesh_gen.html#d-hybrid-mesh">2D hybrid mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/mesh_gen.html#id1">3D high order mesh</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/adjacency.html">Adjacency</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/adjacency.html#d-node-adjacency">2D Node Adjacency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/adjacency.html#d-element-adjacency">2D Element Adjacency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/adjacency.html#id1">3D Node Adjacency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/adjacency.html#id2">3D Element Adjacency</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/basis.html">Basis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/basis.html#d-line-basis">1D Line Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/basis.html#d-triangle-basis">2D Triangle Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/basis.html#d-quadrilateral-basis">2D Quadrilateral Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/basis.html#d-tetrahedron-basis">3D Tetrahedron Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/basis.html#d-hexahedron-basis">3D Hexahedron Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/basis.html#d-pyramid-basis">3D Pyramid Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/basis.html#d-prism-basis">3D Prism Basis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/values.html">Plot values</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/values.html#d-point-value">2D Point Value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/values.html#d-element-value">2D Element Value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/values.html#id1">3D Point Value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/values.html#id2">3D Element Value</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/poisson.html">Poisson Equation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/poisson.html#adaptive-mesh-refinement">Adaptive Mesh Refinement</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/wave.html">Wave Equation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/wave.html#multi-frequency-dataset">multi frequency dataset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/linear_elasticity.html">Linear Elasticity</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/linear_elasticity.html#pressed-hollow-rectangle">Pressed Hollow Rectangle</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference/dataset.html">tensormesh.dataset</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/dataset.html#mesh">Mesh</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.mesh.MeshGen"><code class="docutils literal notranslate"><span class="pre">MeshGen</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.mesh.MeshGen.__init__"><code class="docutils literal notranslate"><span class="pre">MeshGen.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.mesh.MeshGen.add_rectangle"><code class="docutils literal notranslate"><span class="pre">MeshGen.add_rectangle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.mesh.MeshGen.remove_rectangle"><code class="docutils literal notranslate"><span class="pre">MeshGen.remove_rectangle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.mesh.MeshGen.add_circle"><code class="docutils literal notranslate"><span class="pre">MeshGen.add_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.mesh.MeshGen.remove_circle"><code class="docutils literal notranslate"><span class="pre">MeshGen.remove_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.mesh.MeshGen.add_cube"><code class="docutils literal notranslate"><span class="pre">MeshGen.add_cube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.mesh.MeshGen.remove_cube"><code class="docutils literal notranslate"><span class="pre">MeshGen.remove_cube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.mesh.MeshGen.add_sphere"><code class="docutils literal notranslate"><span class="pre">MeshGen.add_sphere()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.mesh.MeshGen.remove_sphere"><code class="docutils literal notranslate"><span class="pre">MeshGen.remove_sphere()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.mesh.MeshGen.gen"><code class="docutils literal notranslate"><span class="pre">MeshGen.gen()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/dataset.html#equation">Equation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.equation.PoissonMultiFrequency"><code class="docutils literal notranslate"><span class="pre">PoissonMultiFrequency</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.equation.PoissonMultiFrequency.__init__"><code class="docutils literal notranslate"><span class="pre">PoissonMultiFrequency.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.equation.PoissonMultiFrequency.source_term"><code class="docutils literal notranslate"><span class="pre">PoissonMultiFrequency.source_term()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.equation.PoissonMultiFrequency.solution"><code class="docutils literal notranslate"><span class="pre">PoissonMultiFrequency.solution()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.equation.HeatMultiFrequency"><code class="docutils literal notranslate"><span class="pre">HeatMultiFrequency</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.equation.HeatMultiFrequency.__init__"><code class="docutils literal notranslate"><span class="pre">HeatMultiFrequency.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.equation.HeatMultiFrequency.initial_condition"><code class="docutils literal notranslate"><span class="pre">HeatMultiFrequency.initial_condition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.equation.HeatMultiFrequency.solution"><code class="docutils literal notranslate"><span class="pre">HeatMultiFrequency.solution()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.equation.WaveMultiFrequency"><code class="docutils literal notranslate"><span class="pre">WaveMultiFrequency</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.equation.WaveMultiFrequency.__init__"><code class="docutils literal notranslate"><span class="pre">WaveMultiFrequency.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.equation.WaveMultiFrequency.initial_condition"><code class="docutils literal notranslate"><span class="pre">WaveMultiFrequency.initial_condition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/dataset.html#tensormesh.dataset.equation.WaveMultiFrequency.solution"><code class="docutils literal notranslate"><span class="pre">WaveMultiFrequency.solution()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference/mesh.html">tensormesh.mesh</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/mesh.html#mesh">Mesh</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh"><code class="docutils literal notranslate"><span class="pre">Mesh</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.points"><code class="docutils literal notranslate"><span class="pre">Mesh.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.cells"><code class="docutils literal notranslate"><span class="pre">Mesh.cells</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.point_data"><code class="docutils literal notranslate"><span class="pre">Mesh.point_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.cell_data"><code class="docutils literal notranslate"><span class="pre">Mesh.cell_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.field_data"><code class="docutils literal notranslate"><span class="pre">Mesh.field_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.cell_sets"><code class="docutils literal notranslate"><span class="pre">Mesh.cell_sets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.dim2eletyp"><code class="docutils literal notranslate"><span class="pre">Mesh.dim2eletyp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.default_eletyp"><code class="docutils literal notranslate"><span class="pre">Mesh.default_eletyp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.default_element_type"><code class="docutils literal notranslate"><span class="pre">Mesh.default_element_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#id0"><code class="docutils literal notranslate"><span class="pre">Mesh.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.__init__"><code class="docutils literal notranslate"><span class="pre">Mesh.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#id1"><code class="docutils literal notranslate"><span class="pre">Mesh.cells</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#id2"><code class="docutils literal notranslate"><span class="pre">Mesh.point_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#id3"><code class="docutils literal notranslate"><span class="pre">Mesh.cell_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#id4"><code class="docutils literal notranslate"><span class="pre">Mesh.field_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#id5"><code class="docutils literal notranslate"><span class="pre">Mesh.cell_sets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#id6"><code class="docutils literal notranslate"><span class="pre">Mesh.dim2eletyp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#id7"><code class="docutils literal notranslate"><span class="pre">Mesh.default_eletyp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.register_point_data"><code class="docutils literal notranslate"><span class="pre">Mesh.register_point_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.register_element_data"><code class="docutils literal notranslate"><span class="pre">Mesh.register_element_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.to_meshio"><code class="docutils literal notranslate"><span class="pre">Mesh.to_meshio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.dim"><code class="docutils literal notranslate"><span class="pre">Mesh.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.save"><code class="docutils literal notranslate"><span class="pre">Mesh.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.to_file"><code class="docutils literal notranslate"><span class="pre">Mesh.to_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.node_adjacency"><code class="docutils literal notranslate"><span class="pre">Mesh.node_adjacency()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.element_adjacency"><code class="docutils literal notranslate"><span class="pre">Mesh.element_adjacency()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.elements"><code class="docutils literal notranslate"><span class="pre">Mesh.elements()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.clone"><code class="docutils literal notranslate"><span class="pre">Mesh.clone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.plot"><code class="docutils literal notranslate"><span class="pre">Mesh.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.n_points"><code class="docutils literal notranslate"><span class="pre">Mesh.n_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.n_elements"><code class="docutils literal notranslate"><span class="pre">Mesh.n_elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.boundary_mask"><code class="docutils literal notranslate"><span class="pre">Mesh.boundary_mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#id8"><code class="docutils literal notranslate"><span class="pre">Mesh.default_element_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.dtype"><code class="docutils literal notranslate"><span class="pre">Mesh.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.device"><code class="docutils literal notranslate"><span class="pre">Mesh.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.from_meshio"><code class="docutils literal notranslate"><span class="pre">Mesh.from_meshio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.read"><code class="docutils literal notranslate"><span class="pre">Mesh.read()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.from_file"><code class="docutils literal notranslate"><span class="pre">Mesh.from_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.gen_rectangle"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_rectangle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.gen_hollow_rectangle"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_hollow_rectangle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.gen_circle"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.gen_hollow_circle"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_hollow_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.gen_L"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_L()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.gen_cube"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_cube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.gen_hollow_cube"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_hollow_cube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.gen_sphere"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_sphere()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/mesh.html#tensormesh.mesh.Mesh.gen_hollow_sphere"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_hollow_sphere()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference/element.html">tensormesh.element</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/element.html#elements">Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element"><code class="docutils literal notranslate"><span class="pre">Element</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.points"><code class="docutils literal notranslate"><span class="pre">Element.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.vertex"><code class="docutils literal notranslate"><span class="pre">Element.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.edge"><code class="docutils literal notranslate"><span class="pre">Element.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.face"><code class="docutils literal notranslate"><span class="pre">Element.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.cell"><code class="docutils literal notranslate"><span class="pre">Element.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.dim"><code class="docutils literal notranslate"><span class="pre">Element.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.n_vertex"><code class="docutils literal notranslate"><span class="pre">Element.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.n_edge"><code class="docutils literal notranslate"><span class="pre">Element.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.n_face"><code class="docutils literal notranslate"><span class="pre">Element.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.n_cell"><code class="docutils literal notranslate"><span class="pre">Element.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.is_mix_facet"><code class="docutils literal notranslate"><span class="pre">Element.is_mix_facet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Element.get_facet_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_basis"><code class="docutils literal notranslate"><span class="pre">Element.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_facet"><code class="docutils literal notranslate"><span class="pre">Element.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_edge"><code class="docutils literal notranslate"><span class="pre">Element.get_edge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Element.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Element.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Element.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_basis_fns"><code class="docutils literal notranslate"><span class="pre">Element.get_basis_fns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_basis_grad_fns"><code class="docutils literal notranslate"><span class="pre">Element.get_basis_grad_fns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.eval_cell_jacobian"><code class="docutils literal notranslate"><span class="pre">Element.eval_cell_jacobian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.eval_shape_val"><code class="docutils literal notranslate"><span class="pre">Element.eval_shape_val()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.eval_shape_grad"><code class="docutils literal notranslate"><span class="pre">Element.eval_shape_grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_local_facet_mapping_fns"><code class="docutils literal notranslate"><span class="pre">Element.get_local_facet_mapping_fns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_local_facet_mapping_grad_fns"><code class="docutils literal notranslate"><span class="pre">Element.get_local_facet_mapping_grad_fns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_outwards_facet_normal"><code class="docutils literal notranslate"><span class="pre">Element.get_outwards_facet_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_n_facet"><code class="docutils literal notranslate"><span class="pre">Element.get_n_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_n_basis"><code class="docutils literal notranslate"><span class="pre">Element.get_n_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.eval_facet_cell_jacobian"><code class="docutils literal notranslate"><span class="pre">Element.eval_facet_cell_jacobian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.eval_facet_jacobian"><code class="docutils literal notranslate"><span class="pre">Element.eval_facet_jacobian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.element_to_facet"><code class="docutils literal notranslate"><span class="pre">Element.element_to_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.element_to_edge"><code class="docutils literal notranslate"><span class="pre">Element.element_to_edge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_tri_mask"><code class="docutils literal notranslate"><span class="pre">Element.get_tri_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_quad_mask"><code class="docutils literal notranslate"><span class="pre">Element.get_quad_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_contour"><code class="docutils literal notranslate"><span class="pre">Element.get_contour()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Line"><code class="docutils literal notranslate"><span class="pre">Line</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Line.points"><code class="docutils literal notranslate"><span class="pre">Line.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Line.vertex"><code class="docutils literal notranslate"><span class="pre">Line.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Line.edge"><code class="docutils literal notranslate"><span class="pre">Line.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Line.dim"><code class="docutils literal notranslate"><span class="pre">Line.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Line.n_vertex"><code class="docutils literal notranslate"><span class="pre">Line.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Line.n_edge"><code class="docutils literal notranslate"><span class="pre">Line.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Line.n_face"><code class="docutils literal notranslate"><span class="pre">Line.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Line.n_cell"><code class="docutils literal notranslate"><span class="pre">Line.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Line.get_basis"><code class="docutils literal notranslate"><span class="pre">Line.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Line.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Line.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Line.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Line.get_quadrature()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle"><code class="docutils literal notranslate"><span class="pre">Triangle</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.points"><code class="docutils literal notranslate"><span class="pre">Triangle.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.vertex"><code class="docutils literal notranslate"><span class="pre">Triangle.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.edge"><code class="docutils literal notranslate"><span class="pre">Triangle.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.face"><code class="docutils literal notranslate"><span class="pre">Triangle.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.dim"><code class="docutils literal notranslate"><span class="pre">Triangle.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.n_vertex"><code class="docutils literal notranslate"><span class="pre">Triangle.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.n_edge"><code class="docutils literal notranslate"><span class="pre">Triangle.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.n_face"><code class="docutils literal notranslate"><span class="pre">Triangle.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.n_cell"><code class="docutils literal notranslate"><span class="pre">Triangle.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_basis"><code class="docutils literal notranslate"><span class="pre">Triangle.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Triangle.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_facet"><code class="docutils literal notranslate"><span class="pre">Triangle.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Triangle.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Triangle.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Triangle.get_facet_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_contour"><code class="docutils literal notranslate"><span class="pre">Triangle.get_contour()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron"><code class="docutils literal notranslate"><span class="pre">Tetrahedron</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.points"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.vertex"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.edge"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.face"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.cell"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.dim"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.n_vertex"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.n_edge"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.n_face"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.n_cell"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.get_basis"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.get_facet"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.get_facet_type()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral"><code class="docutils literal notranslate"><span class="pre">Quadrilateral</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.points"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.vertex"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.edge"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.face"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.dim"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.n_vertex"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.n_edge"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.n_face"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.n_cell"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_basis"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_facet"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_facet_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_coutour"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_coutour()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron"><code class="docutils literal notranslate"><span class="pre">Hexahedron</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.points"><code class="docutils literal notranslate"><span class="pre">Hexahedron.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.vertex"><code class="docutils literal notranslate"><span class="pre">Hexahedron.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.edge"><code class="docutils literal notranslate"><span class="pre">Hexahedron.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.face"><code class="docutils literal notranslate"><span class="pre">Hexahedron.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.cell"><code class="docutils literal notranslate"><span class="pre">Hexahedron.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.dim"><code class="docutils literal notranslate"><span class="pre">Hexahedron.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.n_vertex"><code class="docutils literal notranslate"><span class="pre">Hexahedron.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.n_edge"><code class="docutils literal notranslate"><span class="pre">Hexahedron.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.n_face"><code class="docutils literal notranslate"><span class="pre">Hexahedron.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.n_cell"><code class="docutils literal notranslate"><span class="pre">Hexahedron.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.get_basis"><code class="docutils literal notranslate"><span class="pre">Hexahedron.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Hexahedron.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Hexahedron.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.get_facet"><code class="docutils literal notranslate"><span class="pre">Hexahedron.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Hexahedron.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Hexahedron.get_facet_type()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism"><code class="docutils literal notranslate"><span class="pre">Prism</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.points"><code class="docutils literal notranslate"><span class="pre">Prism.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.vertex"><code class="docutils literal notranslate"><span class="pre">Prism.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.edge"><code class="docutils literal notranslate"><span class="pre">Prism.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.face"><code class="docutils literal notranslate"><span class="pre">Prism.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.cell"><code class="docutils literal notranslate"><span class="pre">Prism.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.dim"><code class="docutils literal notranslate"><span class="pre">Prism.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.n_vertex"><code class="docutils literal notranslate"><span class="pre">Prism.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.n_edge"><code class="docutils literal notranslate"><span class="pre">Prism.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.n_face"><code class="docutils literal notranslate"><span class="pre">Prism.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.n_cell"><code class="docutils literal notranslate"><span class="pre">Prism.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.is_mix_facet"><code class="docutils literal notranslate"><span class="pre">Prism.is_mix_facet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.get_basis"><code class="docutils literal notranslate"><span class="pre">Prism.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Prism.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Prism.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.get_facet"><code class="docutils literal notranslate"><span class="pre">Prism.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Prism.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Prism.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Prism.get_facet_type()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid"><code class="docutils literal notranslate"><span class="pre">Pyramid</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.points"><code class="docutils literal notranslate"><span class="pre">Pyramid.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.vertex"><code class="docutils literal notranslate"><span class="pre">Pyramid.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.edge"><code class="docutils literal notranslate"><span class="pre">Pyramid.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.face"><code class="docutils literal notranslate"><span class="pre">Pyramid.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.cell"><code class="docutils literal notranslate"><span class="pre">Pyramid.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.dim"><code class="docutils literal notranslate"><span class="pre">Pyramid.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.n_vertex"><code class="docutils literal notranslate"><span class="pre">Pyramid.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.n_edge"><code class="docutils literal notranslate"><span class="pre">Pyramid.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.n_face"><code class="docutils literal notranslate"><span class="pre">Pyramid.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.n_cell"><code class="docutils literal notranslate"><span class="pre">Pyramid.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.is_mix_facet"><code class="docutils literal notranslate"><span class="pre">Pyramid.is_mix_facet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.get_basis"><code class="docutils literal notranslate"><span class="pre">Pyramid.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Pyramid.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Pyramid.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.get_facet"><code class="docutils literal notranslate"><span class="pre">Pyramid.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Pyramid.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Pyramid.get_facet_type()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/element.html#transformation">Transformation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation"><code class="docutils literal notranslate"><span class="pre">Transformation</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.elements"><code class="docutils literal notranslate"><span class="pre">Transformation.elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.points"><code class="docutils literal notranslate"><span class="pre">Transformation.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.element"><code class="docutils literal notranslate"><span class="pre">Transformation.element</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.basis_order"><code class="docutils literal notranslate"><span class="pre">Transformation.basis_order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.quadrature_order"><code class="docutils literal notranslate"><span class="pre">Transformation.quadrature_order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#id0"><code class="docutils literal notranslate"><span class="pre">Transformation.elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#id1"><code class="docutils literal notranslate"><span class="pre">Transformation.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.__init__"><code class="docutils literal notranslate"><span class="pre">Transformation.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#id2"><code class="docutils literal notranslate"><span class="pre">Transformation.element</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#id3"><code class="docutils literal notranslate"><span class="pre">Transformation.basis_order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#id4"><code class="docutils literal notranslate"><span class="pre">Transformation.quadrature_order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.update_points"><code class="docutils literal notranslate"><span class="pre">Transformation.update_points()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.dim"><code class="docutils literal notranslate"><span class="pre">Transformation.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.device"><code class="docutils literal notranslate"><span class="pre">Transformation.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.dtype"><code class="docutils literal notranslate"><span class="pre">Transformation.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.element_coords"><code class="docutils literal notranslate"><span class="pre">Transformation.element_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.n_elements"><code class="docutils literal notranslate"><span class="pre">Transformation.n_elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.basis"><code class="docutils literal notranslate"><span class="pre">Transformation.basis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.n_basis"><code class="docutils literal notranslate"><span class="pre">Transformation.n_basis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.quadrature"><code class="docutils literal notranslate"><span class="pre">Transformation.quadrature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.n_quadrature"><code class="docutils literal notranslate"><span class="pre">Transformation.n_quadrature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.shape_val"><code class="docutils literal notranslate"><span class="pre">Transformation.shape_val</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.shape_grad"><code class="docutils literal notranslate"><span class="pre">Transformation.shape_grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.jacobian"><code class="docutils literal notranslate"><span class="pre">Transformation.jacobian</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.facets"><code class="docutils literal notranslate"><span class="pre">Transformation.facets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Transformation.facet_quadrature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.facet_shape_val"><code class="docutils literal notranslate"><span class="pre">Transformation.facet_shape_val</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.facet_shape_grad"><code class="docutils literal notranslate"><span class="pre">Transformation.facet_shape_grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.facet_jacobian"><code class="docutils literal notranslate"><span class="pre">Transformation.facet_jacobian</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.nanson_scale"><code class="docutils literal notranslate"><span class="pre">Transformation.nanson_scale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.phi"><code class="docutils literal notranslate"><span class="pre">Transformation.phi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.gradphi"><code class="docutils literal notranslate"><span class="pre">Transformation.gradphi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.J"><code class="docutils literal notranslate"><span class="pre">Transformation.J</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.detJ"><code class="docutils literal notranslate"><span class="pre">Transformation.detJ</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.JxW"><code class="docutils literal notranslate"><span class="pre">Transformation.JxW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.G"><code class="docutils literal notranslate"><span class="pre">Transformation.G</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.detG"><code class="docutils literal notranslate"><span class="pre">Transformation.detG</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.GxW"><code class="docutils literal notranslate"><span class="pre">Transformation.GxW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.F"><code class="docutils literal notranslate"><span class="pre">Transformation.F</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.detF"><code class="docutils literal notranslate"><span class="pre">Transformation.detF</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.FxW"><code class="docutils literal notranslate"><span class="pre">Transformation.FxW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.n"><code class="docutils literal notranslate"><span class="pre">Transformation.n</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.batch_quadrature"><code class="docutils literal notranslate"><span class="pre">Transformation.batch_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.batch_elements_coords"><code class="docutils literal notranslate"><span class="pre">Transformation.batch_elements_coords()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.batch_shape_val"><code class="docutils literal notranslate"><span class="pre">Transformation.batch_shape_val()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.transformation.Transformation.batch_shape_grad_jxw"><code class="docutils literal notranslate"><span class="pre">Transformation.batch_shape_grad_jxw()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/element.html#polynomial">Polynomial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial"><code class="docutils literal notranslate"><span class="pre">Polynomial</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.__init__"><code class="docutils literal notranslate"><span class="pre">Polynomial.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.n_vars"><code class="docutils literal notranslate"><span class="pre">Polynomial.n_vars</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.n_terms"><code class="docutils literal notranslate"><span class="pre">Polynomial.n_terms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.forward"><code class="docutils literal notranslate"><span class="pre">Polynomial.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.get_exp_terms"><code class="docutils literal notranslate"><span class="pre">Polynomial.get_exp_terms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.deriv"><code class="docutils literal notranslate"><span class="pre">Polynomial.deriv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.grad"><code class="docutils literal notranslate"><span class="pre">Polynomial.grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.reset_coef"><code class="docutils literal notranslate"><span class="pre">Polynomial.reset_coef()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.repeat"><code class="docutils literal notranslate"><span class="pre">Polynomial.repeat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.lin_exp"><code class="docutils literal notranslate"><span class="pre">Polynomial.lin_exp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.poly_exp"><code class="docutils literal notranslate"><span class="pre">Polynomial.poly_exp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.tens_exp"><code class="docutils literal notranslate"><span class="pre">Polynomial.tens_exp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.pyr_exp"><code class="docutils literal notranslate"><span class="pre">Polynomial.pyr_exp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomial.pri_exp"><code class="docutils literal notranslate"><span class="pre">Polynomial.pri_exp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials"><code class="docutils literal notranslate"><span class="pre">Polynomials</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials._coef"><code class="docutils literal notranslate"><span class="pre">Polynomials._coef</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials._exp"><code class="docutils literal notranslate"><span class="pre">Polynomials._exp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.n_polys"><code class="docutils literal notranslate"><span class="pre">Polynomials.n_polys</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.n_vars"><code class="docutils literal notranslate"><span class="pre">Polynomials.n_vars</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.n_terms"><code class="docutils literal notranslate"><span class="pre">Polynomials.n_terms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.device"><code class="docutils literal notranslate"><span class="pre">Polynomials.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.dtype"><code class="docutils literal notranslate"><span class="pre">Polynomials.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.shape"><code class="docutils literal notranslate"><span class="pre">Polynomials.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.__init__"><code class="docutils literal notranslate"><span class="pre">Polynomials.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#id7"><code class="docutils literal notranslate"><span class="pre">Polynomials.n_polys</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#id8"><code class="docutils literal notranslate"><span class="pre">Polynomials.n_vars</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#id9"><code class="docutils literal notranslate"><span class="pre">Polynomials.n_terms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.numel"><code class="docutils literal notranslate"><span class="pre">Polynomials.numel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#id10"><code class="docutils literal notranslate"><span class="pre">Polynomials.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.ndim"><code class="docutils literal notranslate"><span class="pre">Polynomials.ndim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#id11"><code class="docutils literal notranslate"><span class="pre">Polynomials.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#id12"><code class="docutils literal notranslate"><span class="pre">Polynomials.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.dim"><code class="docutils literal notranslate"><span class="pre">Polynomials.dim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.forward"><code class="docutils literal notranslate"><span class="pre">Polynomials.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.get_exp_terms"><code class="docutils literal notranslate"><span class="pre">Polynomials.get_exp_terms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.apply_coefficient"><code class="docutils literal notranslate"><span class="pre">Polynomials.apply_coefficient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.map"><code class="docutils literal notranslate"><span class="pre">Polynomials.map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.map_exp_terms"><code class="docutils literal notranslate"><span class="pre">Polynomials.map_exp_terms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.reshape"><code class="docutils literal notranslate"><span class="pre">Polynomials.reshape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.transpose"><code class="docutils literal notranslate"><span class="pre">Polynomials.transpose()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.deriv"><code class="docutils literal notranslate"><span class="pre">Polynomials.deriv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.grad"><code class="docutils literal notranslate"><span class="pre">Polynomials.grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.reset_coef"><code class="docutils literal notranslate"><span class="pre">Polynomials.reset_coef()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.repeat"><code class="docutils literal notranslate"><span class="pre">Polynomials.repeat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.polynomial.Polynomials.stack"><code class="docutils literal notranslate"><span class="pre">Polynomials.stack()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/element.html#module-tensormesh.element.basis">Basis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.lin_linspace"><code class="docutils literal notranslate"><span class="pre">lin_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.quad_linspace"><code class="docutils literal notranslate"><span class="pre">quad_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.tri_linspace"><code class="docutils literal notranslate"><span class="pre">tri_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.hex_linspace"><code class="docutils literal notranslate"><span class="pre">hex_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.tet_linspace"><code class="docutils literal notranslate"><span class="pre">tet_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.pyr_linspace"><code class="docutils literal notranslate"><span class="pre">pyr_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.pri_linspace"><code class="docutils literal notranslate"><span class="pre">pri_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.lin_basis"><code class="docutils literal notranslate"><span class="pre">lin_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.tri_basis"><code class="docutils literal notranslate"><span class="pre">tri_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.quad_basis"><code class="docutils literal notranslate"><span class="pre">quad_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.tet_basis"><code class="docutils literal notranslate"><span class="pre">tet_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.hex_basis"><code class="docutils literal notranslate"><span class="pre">hex_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.pyr_basis"><code class="docutils literal notranslate"><span class="pre">pyr_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.pri_basis"><code class="docutils literal notranslate"><span class="pre">pri_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.accumulate_range"><code class="docutils literal notranslate"><span class="pre">accumulate_range()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.index_reverse_mapping"><code class="docutils literal notranslate"><span class="pre">index_reverse_mapping()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.facet_basis_index_2d"><code class="docutils literal notranslate"><span class="pre">facet_basis_index_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.tet_facet_basis_index"><code class="docutils literal notranslate"><span class="pre">tet_facet_basis_index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.hex_facet_basis_index"><code class="docutils literal notranslate"><span class="pre">hex_facet_basis_index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.mix_facet_basis_index"><code class="docutils literal notranslate"><span class="pre">mix_facet_basis_index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.basis.edge_index"><code class="docutils literal notranslate"><span class="pre">edge_index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/element.html#module-tensormesh.element.quadrature">Quadrature</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.quadrature.lin_quadrature"><code class="docutils literal notranslate"><span class="pre">lin_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.quadrature.tri_quadrature"><code class="docutils literal notranslate"><span class="pre">tri_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.quadrature.tet_quadrature"><code class="docutils literal notranslate"><span class="pre">tet_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.quadrature.quad_quadrature"><code class="docutils literal notranslate"><span class="pre">quad_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.quadrature.hex_quadrature"><code class="docutils literal notranslate"><span class="pre">hex_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.quadrature.pyr_quadrature"><code class="docutils literal notranslate"><span class="pre">pyr_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.quadrature.pri_quadrature"><code class="docutils literal notranslate"><span class="pre">pri_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.quadrature.facet_quadrature_2d"><code class="docutils literal notranslate"><span class="pre">facet_quadrature_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.quadrature.tet_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">tet_facet_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.quadrature.hex_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">hex_facet_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.quadrature.mix_facet_quadrature_3d"><code class="docutils literal notranslate"><span class="pre">mix_facet_quadrature_3d()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/element.html#module-tensormesh.element.normal">Normal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.normal.outwards_normal_2d"><code class="docutils literal notranslate"><span class="pre">outwards_normal_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/element.html#tensormesh.element.normal.outwards_normal_3d"><code class="docutils literal notranslate"><span class="pre">outwards_normal_3d()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference/assemble.html">tensormesh.assemble</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/assemble.html#element-assembler">Element Assembler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler"><code class="docutils literal notranslate"><span class="pre">ElementAssembler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.quadrature_weights"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.quadrature_weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.quadrature_points"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.quadrature_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.shape_val"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.shape_val</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.projector"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.projector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.elements"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.edges"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.edges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.n_points"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.n_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.dimension"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.dimension</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.element_types"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.element_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#id0"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.edges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.__init__"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#id1"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.projector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.transformation"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.transformation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#id2"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#id3"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.dimension</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#id4"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.element_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#id5"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.n_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.device"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.dtype"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.type"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.forward"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.from_assembler"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.from_assembler()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.from_mesh"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.from_mesh()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/assemble.html#facet-assembler">Facet Assembler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/assemble.html#node-assembler">Node Assembler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler"><code class="docutils literal notranslate"><span class="pre">NodeAssembler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.quadrature_weights"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.quadrature_weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.quadrature_points"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.quadrature_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.shape_val"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.shape_val</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.projector"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.projector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.elements"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.n_points"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.n_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.dimension"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.dimension</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.element_types"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.element_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.__init__"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#id6"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.projector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.transformation"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.transformation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#id7"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#id8"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.dimension</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#id9"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.element_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#id10"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.n_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.device"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.dtype"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.type"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.forward"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.from_assembler"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.from_assembler()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.from_elements"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.from_elements()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.from_mesh"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.from_mesh()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/assemble.html#built-in-assemblers">Built-in Assemblers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.builtin.LaplaceElementAssembler"><code class="docutils literal notranslate"><span class="pre">LaplaceElementAssembler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.builtin.LaplaceElementAssembler.forward"><code class="docutils literal notranslate"><span class="pre">LaplaceElementAssembler.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.builtin.MassElementAssembler"><code class="docutils literal notranslate"><span class="pre">MassElementAssembler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/assemble.html#tensormesh.assemble.builtin.MassElementAssembler.forward"><code class="docutils literal notranslate"><span class="pre">MassElementAssembler.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference/sparse.html">tensormesh.sparse</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/sparse.html#sparsematirx">SparseMatirx</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix"><code class="docutils literal notranslate"><span class="pre">SparseMatrix</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.edata"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.edata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.row"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.row</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.col"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.shape"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.hash_layout"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.hash_layout</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#id0"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.edata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#id1"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.row</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#id2"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.__init__"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#id3"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.layout_hash"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.layout_hash</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.edges"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.edges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.elementwise_operation"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.elementwise_operation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.solve"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.solve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.requires_grad_"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.requires_grad_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.transpose"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.transpose()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.sqrt"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.sqrt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.reciprocal"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.reciprocal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.degree"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.degree()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.sum"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.sum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.clone"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.clone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.T"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.requires_grad"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.requires_grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.dtype"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.device"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.grad"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.grad_fn"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.grad_fn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.nnz"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.nnz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.layout_mask"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.layout_mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.type"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.detach"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.detach()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.to_scipy_coo"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.to_scipy_coo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.to_sparse_coo"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.to_sparse_coo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.to_dense"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.to_dense()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.has_same_layout"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.has_same_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.from_scipy_coo"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.from_scipy_coo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.from_sparse_coo"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.from_sparse_coo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.from_block_coo"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.from_block_coo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.from_dense"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.from_dense()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.random"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.random()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.random_layout"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.random_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.random_from_layout"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.random_from_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.eye"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.eye()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.full"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.full()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.combine_vector"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.combine_vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.combine_matrix"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.combine_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/sparse.html#tensormesh.sparse.SparseMatrix.combine"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.combine()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference/operator.html">tensormesh.operator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/operator.html#condenser">Condenser</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser"><code class="docutils literal notranslate"><span class="pre">Condenser</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.dirichlet_mask"><code class="docutils literal notranslate"><span class="pre">Condenser.dirichlet_mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.dirichlet_value"><code class="docutils literal notranslate"><span class="pre">Condenser.dirichlet_value</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.__init__"><code class="docutils literal notranslate"><span class="pre">Condenser.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#id0"><code class="docutils literal notranslate"><span class="pre">Condenser.dirichlet_mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#id1"><code class="docutils literal notranslate"><span class="pre">Condenser.dirichlet_value</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.inner_row"><code class="docutils literal notranslate"><span class="pre">Condenser.inner_row</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.inner_col"><code class="docutils literal notranslate"><span class="pre">Condenser.inner_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.ou2in_row"><code class="docutils literal notranslate"><span class="pre">Condenser.ou2in_row</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.ou2in_col"><code class="docutils literal notranslate"><span class="pre">Condenser.ou2in_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.is_inner_edge"><code class="docutils literal notranslate"><span class="pre">Condenser.is_inner_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.is_ou2in_edge"><code class="docutils literal notranslate"><span class="pre">Condenser.is_ou2in_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.layout_hash"><code class="docutils literal notranslate"><span class="pre">Condenser.layout_hash</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.K_ou2in"><code class="docutils literal notranslate"><span class="pre">Condenser.K_ou2in</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.condense_rhs"><code class="docutils literal notranslate"><span class="pre">Condenser.condense_rhs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/operator.html#tensormesh.operator.Condenser.recover"><code class="docutils literal notranslate"><span class="pre">Condenser.recover()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference/ode.html">tensormesh.ode</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/ode.html#runge-kutta-methods">Runge-Kutta methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/ode.html#built-in-methods">Built-in Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ExplicitRungeKutta"><code class="docutils literal notranslate"><span class="pre">ExplicitRungeKutta</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ExplicitRungeKutta.__init__"><code class="docutils literal notranslate"><span class="pre">ExplicitRungeKutta.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ExplicitRungeKutta.forward"><code class="docutils literal notranslate"><span class="pre">ExplicitRungeKutta.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ExplicitRungeKutta.step"><code class="docutils literal notranslate"><span class="pre">ExplicitRungeKutta.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ImplicitLinearRungeKutta"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ImplicitLinearRungeKutta.__init__"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ImplicitLinearRungeKutta.forward_M"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.forward_M()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ImplicitLinearRungeKutta.forward_A"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.forward_A()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ImplicitLinearRungeKutta.forward_B"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.forward_B()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ImplicitLinearRungeKutta.pre_solve_lhs"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.pre_solve_lhs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ImplicitLinearRungeKutta.pre_solve_rhs"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.pre_solve_rhs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ImplicitLinearRungeKutta.post_solve"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.post_solve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.ImplicitLinearRungeKutta.step"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.builtin.ExplicitEuler"><code class="docutils literal notranslate"><span class="pre">ExplicitEuler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.builtin.ExplicitEuler.__init__"><code class="docutils literal notranslate"><span class="pre">ExplicitEuler.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.builtin.ImplicitLinearEuler"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearEuler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.builtin.ImplicitLinearEuler.__init__"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearEuler.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.builtin.MidPointLinearEuler"><code class="docutils literal notranslate"><span class="pre">MidPointLinearEuler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/ode.html#tensormesh.ode.builtin.MidPointLinearEuler.__init__"><code class="docutils literal notranslate"><span class="pre">MidPointLinearEuler.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference/functional.html">tensormesh.functional</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/functional.html#module-tensormesh.functional.ops">ops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.ops.sym"><code class="docutils literal notranslate"><span class="pre">sym()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.ops.skew"><code class="docutils literal notranslate"><span class="pre">skew()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.ops.sqrt"><code class="docutils literal notranslate"><span class="pre">sqrt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.ops.divide"><code class="docutils literal notranslate"><span class="pre">divide()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/functional.html#module-tensormesh.functional.elasticity">elasticity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.elasticity.strain"><code class="docutils literal notranslate"><span class="pre">strain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.elasticity.isotropic_stress"><code class="docutils literal notranslate"><span class="pre">isotropic_stress()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.elasticity.deviatoric_stress"><code class="docutils literal notranslate"><span class="pre">deviatoric_stress()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.elasticity.deviatoric_stress_norm"><code class="docutils literal notranslate"><span class="pre">deviatoric_stress_norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.elasticity.voigt_shape_grad"><code class="docutils literal notranslate"><span class="pre">voigt_shape_grad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.elasticity.voigt_stiffness"><code class="docutils literal notranslate"><span class="pre">voigt_stiffness()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.elasticity.voigt_shape_val"><code class="docutils literal notranslate"><span class="pre">voigt_shape_val()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.elasticity.voigt_C"><code class="docutils literal notranslate"><span class="pre">voigt_C()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.elasticity.voigt_B"><code class="docutils literal notranslate"><span class="pre">voigt_B()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.elasticity.voigt_N"><code class="docutils literal notranslate"><span class="pre">voigt_N()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/functional.html#module-tensormesh.functional.plastic">plastic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/functional.html#tensormesh.functional.plastic.update_plastic_stress"><code class="docutils literal notranslate"><span class="pre">update_plastic_stress()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference/nn.html">NN</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/nn.html#bufferutils">BufferUtils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict"><code class="docutils literal notranslate"><span class="pre">BufferDict</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict.__init__"><code class="docutils literal notranslate"><span class="pre">BufferDict.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict.as_parameter"><code class="docutils literal notranslate"><span class="pre">BufferDict.as_parameter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict.as_buffer"><code class="docutils literal notranslate"><span class="pre">BufferDict.as_buffer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict.keys"><code class="docutils literal notranslate"><span class="pre">BufferDict.keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict.items"><code class="docutils literal notranslate"><span class="pre">BufferDict.items()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict.values"><code class="docutils literal notranslate"><span class="pre">BufferDict.values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict.is_floating_point"><code class="docutils literal notranslate"><span class="pre">BufferDict.is_floating_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict.is_complex"><code class="docutils literal notranslate"><span class="pre">BufferDict.is_complex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict.dtype"><code class="docutils literal notranslate"><span class="pre">BufferDict.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict.device"><code class="docutils literal notranslate"><span class="pre">BufferDict.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict.to_dict"><code class="docutils literal notranslate"><span class="pre">BufferDict.to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferDict.clone"><code class="docutils literal notranslate"><span class="pre">BufferDict.clone()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList"><code class="docutils literal notranslate"><span class="pre">BufferList</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.__init__"><code class="docutils literal notranslate"><span class="pre">BufferList.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.as_parameter"><code class="docutils literal notranslate"><span class="pre">BufferList.as_parameter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.as_buffer"><code class="docutils literal notranslate"><span class="pre">BufferList.as_buffer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.append"><code class="docutils literal notranslate"><span class="pre">BufferList.append()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.insert"><code class="docutils literal notranslate"><span class="pre">BufferList.insert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.pop"><code class="docutils literal notranslate"><span class="pre">BufferList.pop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.item"><code class="docutils literal notranslate"><span class="pre">BufferList.item()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.is_floating_point"><code class="docutils literal notranslate"><span class="pre">BufferList.is_floating_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.is_complex"><code class="docutils literal notranslate"><span class="pre">BufferList.is_complex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.dtype"><code class="docutils literal notranslate"><span class="pre">BufferList.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.device"><code class="docutils literal notranslate"><span class="pre">BufferList.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.to_list"><code class="docutils literal notranslate"><span class="pre">BufferList.to_list()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/nn.html#tensormesh.nn.BufferList.clone"><code class="docutils literal notranslate"><span class="pre">BufferList.clone()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference/visualization.html">visualization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/visualization.html#module-tensormesh.visualization.draw_graph">Draw Facet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_graph.draw_graph"><code class="docutils literal notranslate"><span class="pre">draw_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_mesh.draw_mesh"><code class="docutils literal notranslate"><span class="pre">draw_mesh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_facet.draw_facet_2d"><code class="docutils literal notranslate"><span class="pre">draw_facet_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_facet.draw_face"><code class="docutils literal notranslate"><span class="pre">draw_face()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_element_value.draw_element_value_2d_tri"><code class="docutils literal notranslate"><span class="pre">draw_element_value_2d_tri()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_element_value.draw_element_value_2d"><code class="docutils literal notranslate"><span class="pre">draw_element_value_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_element_value.update_element_value_2d_tri"><code class="docutils literal notranslate"><span class="pre">update_element_value_2d_tri()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_element_value.update_element_value_2d"><code class="docutils literal notranslate"><span class="pre">update_element_value_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_element_value.draw_element_value_3d"><code class="docutils literal notranslate"><span class="pre">draw_element_value_3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_element_value.update_element_value_3d"><code class="docutils literal notranslate"><span class="pre">update_element_value_3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_element_value.draw_element_value"><code class="docutils literal notranslate"><span class="pre">draw_element_value()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_element_value.update_element_value"><code class="docutils literal notranslate"><span class="pre">update_element_value()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_point_value.draw_point_value_2d_tri_gouraud"><code class="docutils literal notranslate"><span class="pre">draw_point_value_2d_tri_gouraud()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_point_value.update_point_value_2d_tri_gouraud"><code class="docutils literal notranslate"><span class="pre">update_point_value_2d_tri_gouraud()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_point_value.draw_point_value_2d_interpolation"><code class="docutils literal notranslate"><span class="pre">draw_point_value_2d_interpolation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_point_value.update_point_value_2d_interpolation"><code class="docutils literal notranslate"><span class="pre">update_point_value_2d_interpolation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_point_value.draw_point_value_2d"><code class="docutils literal notranslate"><span class="pre">draw_point_value_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_point_value.update_point_value_2d"><code class="docutils literal notranslate"><span class="pre">update_point_value_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_point_value.draw_point_value_3d_interpolation"><code class="docutils literal notranslate"><span class="pre">draw_point_value_3d_interpolation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_point_value.update_point_value_3d_interpolation"><code class="docutils literal notranslate"><span class="pre">update_point_value_3d_interpolation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_point_value.draw_point_value"><code class="docutils literal notranslate"><span class="pre">draw_point_value()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.draw_point_value.update_point_value"><code class="docutils literal notranslate"><span class="pre">update_point_value()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.stream_plotter.StreamPlotter"><code class="docutils literal notranslate"><span class="pre">StreamPlotter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.stream_plotter.StreamPlotter.__init__"><code class="docutils literal notranslate"><span class="pre">StreamPlotter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.stream_plotter.StreamPlotter.grab_frame"><code class="docutils literal notranslate"><span class="pre">StreamPlotter.grab_frame()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.stream_plotter.StreamPlotter.update"><code class="docutils literal notranslate"><span class="pre">StreamPlotter.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.stream_plotter.StreamPlotter.draw_mesh_2d"><code class="docutils literal notranslate"><span class="pre">StreamPlotter.draw_mesh_2d()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.stream_plotter.draw_mesh_2d_static"><code class="docutils literal notranslate"><span class="pre">draw_mesh_2d_static()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/visualization.html#tensormesh.visualization.stream_plotter.draw_mesh_2d_stream"><code class="docutils literal notranslate"><span class="pre">draw_mesh_2d_stream()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference/profile.html">Profile</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/profile.html#cpuprofiler">CPUProfiler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CPUProfiler"><code class="docutils literal notranslate"><span class="pre">CPUProfiler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CPUProfiler.pid"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.pid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CPUProfiler.results"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.results</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CPUProfiler.times"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.times</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CPUProfiler.scopes"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.scopes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CPUProfiler.__init__"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CPUProfiler.max"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CPUProfiler.min"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CPUProfiler.mean"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CPUProfiler.std"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.std()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CPUProfiler.plot"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CPUProfiler.scope"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.scope()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/profile.html#cudaprofiler">CUDAProfiler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CUDAProfiler"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CUDAProfiler.__init__"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CUDAProfiler.max"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CUDAProfiler.min"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CUDAProfiler.mean"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CUDAProfiler.std"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.std()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CUDAProfiler.plot"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.CUDAProfiler.scope"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.scope()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/profile.html#timeprofiler">TimeProfiler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.TimeProfiler"><code class="docutils literal notranslate"><span class="pre">TimeProfiler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.TimeProfiler.time"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.TimeProfiler.start"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.start</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.TimeProfiler.scopes"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.scopes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.TimeProfiler.only_cpu"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.only_cpu</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.TimeProfiler.__init__"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.TimeProfiler.scope"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.scope()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/profile.html#tensormesh.profile.TimeProfiler.plot"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">tensormesh</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">tensormesh.element.element</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for tensormesh.element.element</h1><div class="highlight"><pre>
<span></span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">lru_cache</span><span class="p">,</span> <span class="n">reduce</span>
<span class="kn">from</span> <span class="nn">logging</span> <span class="kn">import</span> <span class="n">warning</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span> <span class="nn">.polynomial</span> <span class="kn">import</span> <span class="n">Polynomial</span><span class="p">,</span> \
                        <span class="n">Polynomials</span>
<span class="kn">from</span> <span class="nn">.basis</span> <span class="kn">import</span>  <span class="n">lin_basis</span><span class="p">,</span>\
                    <span class="n">tri_basis</span><span class="p">,</span>\
                    <span class="n">quad_basis</span><span class="p">,</span>\
                    <span class="n">tet_basis</span><span class="p">,</span>\
                    <span class="n">hex_basis</span><span class="p">,</span>\
                    <span class="n">pyr_basis</span><span class="p">,</span>\
                    <span class="n">pri_basis</span><span class="p">,</span>\
                    <span class="n">facet_basis_index_2d</span><span class="p">,</span> \
                    <span class="n">tet_facet_basis_index</span><span class="p">,</span> \
                    <span class="n">hex_facet_basis_index</span><span class="p">,</span>\
                    <span class="n">mix_facet_basis_index</span><span class="p">,</span> \
                    <span class="n">edge_index</span>
<span class="kn">from</span> <span class="nn">.quadrature</span> <span class="kn">import</span> <span class="n">lin_quadrature</span><span class="p">,</span>\
                        <span class="n">tri_quadrature</span><span class="p">,</span>\
                        <span class="n">tet_quadrature</span><span class="p">,</span>\
                        <span class="n">quad_quadrature</span><span class="p">,</span>\
                        <span class="n">hex_quadrature</span><span class="p">,</span>\
                        <span class="n">pyr_quadrature</span><span class="p">,</span>\
                        <span class="n">pri_quadrature</span><span class="p">,</span>\
                        <span class="n">facet_quadrature_2d</span><span class="p">,</span>\
                        <span class="n">tet_facet_quadrature</span><span class="p">,</span>\
                        <span class="n">hex_facet_quadrature</span><span class="p">,</span>\
                        <span class="n">mix_facet_quadrature_3d</span>
<span class="kn">from</span> <span class="nn">.normal</span> <span class="kn">import</span> <span class="n">outwards_normal_2d</span><span class="p">,</span>\
                    <span class="n">outwards_normal_3d</span>
<span class="c1"># from .plot import plot_1d,\</span>
<span class="c1">#                   plot_2d,\</span>
<span class="c1">#                   plot_3d </span>
<span class="kn">from</span> <span class="nn">.types</span> <span class="kn">import</span> <span class="n">Tensorx1</span><span class="p">,</span> <span class="n">Tensorx2</span><span class="p">,</span> <span class="n">Tensorx3</span><span class="p">,</span> <span class="n">Tensorx4</span><span class="p">,</span> <span class="n">Tensorx5</span>






<div class="viewcode-block" id="Element">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element">[docs]</a>
<span class="k">class</span> <span class="nc">Element</span><span class="p">:</span>
    <span class="c1">#: Coordinates of element vertices</span>
    <span class="c1">#: Shape: :math:`[V, D]` where :math:`V` = number of vertices and :math:`D` = spatial dimension</span>
    <span class="n">points</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> 

    <span class="c1">#: Vertex indices for the element</span>
    <span class="c1">#: Shape: :math:`[V, 1]` where :math:`V` = number of vertices</span>
    <span class="n">vertex</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> 

    <span class="c1">#: Edge connectivity defining pairs of vertex indices</span>
    <span class="c1">#: Shape: :math:`[E, 2]` where :math:`E` = number of edges</span>
    <span class="n">edge</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>

    <span class="c1">#: Face connectivity defining vertex indices for each face.</span>
    <span class="c1">#: Shape: Tuple of tuples, each inner tuple contains vertex indices </span>
    <span class="c1">#: for one face.</span>
    <span class="c1">#:</span>
    <span class="c1">#: Example:</span>
    <span class="c1">#:     ((0,1,2), (1,2,3)) for two triangular faces</span>
    <span class="n">face</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="o">...</span><span class="p">],</span><span class="o">...</span><span class="p">]]</span>

    <span class="c1">#: Cell connectivity defining vertex indices for volumetric elements</span>
    <span class="c1">#: Shape: :math:`[N_c, V_c]` where :math:`N_c` = number of cells and :math:`V_c` = vertices per cell</span>
    <span class="n">cell</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>

    <span class="c1">#: Spatial dimension of the element (1D, 2D, or 3D)</span>
    <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span>

    <span class="c1">#: Number of vertices in the element</span>
    <span class="n">n_vertex</span><span class="p">:</span> <span class="nb">int</span> 

    <span class="c1">#: Number of edges in the element</span>
    <span class="n">n_edge</span><span class="p">:</span> <span class="nb">int</span>

    <span class="c1">#: Number of faces in the element</span>
    <span class="n">n_face</span><span class="p">:</span> <span class="nb">int</span>

    <span class="c1">#: Number of cells in the element </span>
    <span class="n">n_cell</span><span class="p">:</span> <span class="nb">int</span>
   
    <span class="n">is_mix_facet</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Boolean indicating whether the element has mixed facet types.</span>

<span class="sd">    False indicates uniform facets (e.g. all triangles or all quads).</span>
<span class="sd">    True indicates mixed facets (e.g. prism or pyramid).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># @abstractmethod</span>
<div class="viewcode-block" id="Element.get_facet_type">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_facet_type">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_facet_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">],</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">],</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the element type(s) for the facets of this element.</span>

<span class="sd">        This method returns the element type(s) that make up the facets (faces) of the current element.</span>
<span class="sd">        For example, a triangle element has line segment facets, while a prism has both triangular and</span>
<span class="sd">        quadrilateral facets.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Triangle, Line</span>
<span class="sd">        &gt;&gt;&gt; Triangle.get_facet_type()</span>
<span class="sd">        Line</span>

<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Prism, Triangle, Quadrilateral </span>
<span class="sd">        &gt;&gt;&gt; facet_types = Prism.get_facet_type()</span>
<span class="sd">        &gt;&gt;&gt; facet_types == (Triangle, Quadrilateral)</span>
<span class="sd">        True</span>

<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Tetrahedron</span>
<span class="sd">        &gt;&gt;&gt; Tetrahedron.get_facet_type()</span>
<span class="sd">        Triangle</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Union[Type[&#39;Element&#39;], Tuple[Type[&#39;Element&#39;], Type[&#39;Element&#39;]]]</span>
<span class="sd">            The element type(s) for the facets. Returns either:</span>

<span class="sd">            - A single Element type for elements with uniform facets (e.g. Line for Triangle)</span>
<span class="sd">            - A tuple of Element types for elements with mixed facets (e.g. (Triangle, Quadrilateral) for Prism)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>


    <span class="c1"># @abstractmethod</span>
<div class="viewcode-block" id="Element.get_basis">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_basis">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_basis</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                  <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                  <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                  <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                  <span class="p">)</span><span class="o">-&gt;</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the basis node coordinates for the element.</span>

<span class="sd">        This method returns the coordinates of the basis nodes that define the element&#39;s shape functions.</span>
<span class="sd">        The number and location of basis nodes depends on the polynomial order.</span>

<span class="sd">        For example:</span>
<span class="sd">        - For order=1 (linear), returns vertices of the element</span>
<span class="sd">        - For order=2 (quadratic), returns vertices plus midpoints of edges</span>
<span class="sd">        - For higher orders, returns additional nodes in the interior</span>

<span class="sd">        The basis nodes are used to construct the element&#39;s shape functions and define the geometric</span>
<span class="sd">        mapping between reference and physical elements.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Triangle</span>
<span class="sd">        &gt;&gt;&gt; basis = Triangle.get_basis(order=1)</span>
<span class="sd">        &gt;&gt;&gt; basis.shape</span>
<span class="sd">        torch.Size([3, 2])  # 3 vertices in 2D</span>
<span class="sd">        &gt;&gt;&gt; basis</span>
<span class="sd">        tensor([[0., 0.],</span>
<span class="sd">                [1., 0.], </span>
<span class="sd">                [0., 1.]])</span>

<span class="sd">        &gt;&gt;&gt; # Quadratic basis has additional nodes at edge midpoints</span>
<span class="sd">        &gt;&gt;&gt; basis = Triangle.get_basis(order=2) </span>
<span class="sd">        &gt;&gt;&gt; basis.shape</span>
<span class="sd">        torch.Size([6, 2])  # 3 vertices + 3 edge midpoints</span>

<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Tetrahedron</span>
<span class="sd">        &gt;&gt;&gt; basis = Tetrahedron.get_basis(order=1)</span>
<span class="sd">        &gt;&gt;&gt; basis.shape</span>
<span class="sd">        torch.Size([4, 3])  # 4 vertices in 3D</span>
<span class="sd">        &gt;&gt;&gt; basis</span>
<span class="sd">        tensor([[0., 0., 0.],</span>
<span class="sd">                [1., 0., 0.],</span>
<span class="sd">                [0., 1., 0.],</span>
<span class="sd">                [0., 0., 1.]])</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order: int </span>
<span class="sd">            the order of the basis</span>
<span class="sd">        dtype: torch.dtype</span>
<span class="sd">            the float data type of the polynomial</span>
<span class="sd">        device: torch.device</span>
<span class="sd">            the device of the polynomial</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        basis: torch.Tensor </span>
<span class="sd">            2D Tensor of shape [B, D], </span>
<span class="sd">            where B is the number of basis nodes and D is the dimension</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

    
    <span class="c1"># @abstractmethod</span>
<div class="viewcode-block" id="Element.get_facet">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_facet">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span> <span class="nf">get_facet</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Union</span><span class="p">[</span><span class="n">Tensorx1</span><span class="p">,</span><span class="n">Tensorx2</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the facet connectivity for the element.</span>

<span class="sd">        For elements with uniform facets (e.g. Triangle, Quadrilateral), returns a single tensor </span>
<span class="sd">        containing facet connectivity. For elements with mixed facets (e.g. Prism), returns a tuple </span>
<span class="sd">        of tensors containing facet connectivity for each facet type.</span>

<span class="sd">        The facet connectivity defines how the basis nodes are connected to form each facet of the element.</span>
<span class="sd">        For example, for a triangle element with linear basis (order=1), the facet connectivity would be::</span>

<span class="sd">            [[0,1],  # First edge connects nodes 0 and 1</span>
<span class="sd">             [1,2],  # Second edge connects nodes 1 and 2  </span>
<span class="sd">             [2,0]]  # Third edge connects nodes 2 and 0</span>

<span class="sd">        For a prism element which has both triangular and quadrilateral facets, would return::</span>

<span class="sd">            (tri_facets, quad_facets)</span>

<span class="sd">        Where tri_facets contains connectivity for the triangular faces and quad_facets contains</span>
<span class="sd">        connectivity for the quadrilateral faces.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Triangle</span>
<span class="sd">        &gt;&gt;&gt; facets = Triangle.get_facet(order=1)</span>
<span class="sd">        &gt;&gt;&gt; facets</span>
<span class="sd">        tensor([[0, 1],  # First edge connects nodes 0 and 1</span>
<span class="sd">                [1, 2],  # Second edge connects nodes 1 and 2</span>
<span class="sd">                [2, 0]]) # Third edge connects nodes 2 and 0</span>

<span class="sd">        &gt;&gt;&gt; # Higher order elements have more nodes per facet</span>
<span class="sd">        &gt;&gt;&gt; facets = Triangle.get_facet(order=2)</span>
<span class="sd">        &gt;&gt;&gt; facets.shape</span>
<span class="sd">        torch.Size([3, 3])  # 3 edges with 3 nodes each</span>

<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Prism</span>
<span class="sd">        &gt;&gt;&gt; tri_facets, quad_facets = Prism.get_facet(order=1)</span>
<span class="sd">        &gt;&gt;&gt; tri_facets.shape  # Two triangular faces</span>
<span class="sd">        torch.Size([2, 3])</span>
<span class="sd">        &gt;&gt;&gt; quad_facets.shape  # Three quadrilateral faces </span>
<span class="sd">        torch.Size([3, 4])</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order: int </span>
<span class="sd">            the order of the basis</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        if cls.is_mix_facet</span>
<span class="sd">        </span>
<span class="sd">            - tri_facet: torch.Tensor </span>
<span class="sd">                2D Tensor of shape [:math:`F_t`, :math:`B_{ft}`] where :math:`F_t` is number of triangular facets, :math:`B_{ft}` is basis nodes per triangular facet</span>
<span class="sd">            - quad_facet: torch.Tensor  </span>
<span class="sd">                2D Tensor of shape [:math:`F_q`, :math:`B_{fq}`] where :math:`F_q` is number of quadrilateral facets, :math:`B_{fq}` is basis nodes per quadrilateral facet</span>

<span class="sd">        else</span>
<span class="sd">        </span>
<span class="sd">            - facet: torch.Tensor </span>
<span class="sd">                2D Tensor of shape [:math:`F`, :math:`B_f`] where :math:`F` is number of facets, :math:`B_f` is basis nodes per facet</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="Element.get_edge">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_edge">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_edge</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx1</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the edge basis indices for the element.</span>

<span class="sd">        Returns the connectivity array for the edges of the element. Each row represents an edge</span>
<span class="sd">        and contains the indices of the basis nodes along that edge.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Triangle</span>
<span class="sd">        &gt;&gt;&gt; edges = Triangle.get_edge(order=1)</span>
<span class="sd">        &gt;&gt;&gt; edges</span>
<span class="sd">        tensor([[0, 1],  # First edge connects nodes 0 and 1</span>
<span class="sd">                [1, 2],  # Second edge connects nodes 1 and 2</span>
<span class="sd">                [2, 0]]) # Third edge connects nodes 2 and 0</span>

<span class="sd">        &gt;&gt;&gt; # Higher order elements have more nodes per edge</span>
<span class="sd">        &gt;&gt;&gt; edges = Triangle.get_edge(order=2)</span>
<span class="sd">        &gt;&gt;&gt; edges.shape</span>
<span class="sd">        torch.Size([3, 3])  # 3 edges with 3 nodes each</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order: int </span>
<span class="sd">            the order of the basis</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        edge: torch.Tensor</span>
<span class="sd">            2D Tensor of shape [n_edge, 2] containing edge connectivity</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">edge_index</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span></div>


    <span class="c1"># @abstractmethod</span>
<div class="viewcode-block" id="Element.get_polynomial">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_polynomial">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_polynomial</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Polynomial</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the polynomial form for the element.</span>

<span class="sd">        For a given order n, returns a polynomial with terms up to maximum total degree n.</span>
<span class="sd">        The polynomial will have n_vars equal to the dimension of the element.</span>

<span class="sd">        For example, </span>
<span class="sd">        </span>
<span class="sd">        * For a 2D element with order=1:</span>
<span class="sd">          :math:`P(x,y) = a_0 + a_1x + a_2y`</span>

<span class="sd">        * For order=2:</span>
<span class="sd">          :math:`P(x,y) = a_0 + a_1x + a_2y + a_3x^2 + a_4xy + a_5y^2`</span>

<span class="sd">        The exact form and number of terms depends on the specific element type.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Triangle</span>
<span class="sd">        &gt;&gt;&gt; poly = Triangle.get_polynomial(order=1)</span>
<span class="sd">        &gt;&gt;&gt; poly.n_vars  # 2D element</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; poly.n_terms  # Linear terms: 1, x, y</span>
<span class="sd">        3</span>

<span class="sd">        &gt;&gt;&gt; poly = Triangle.get_polynomial(order=2)</span>
<span class="sd">        &gt;&gt;&gt; poly.n_terms  # Quadratic terms: 1, x, y, x^2, xy, y^2</span>
<span class="sd">        6</span>

<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Tetrahedron</span>
<span class="sd">        &gt;&gt;&gt; poly = Tetrahedron.get_polynomial(order=1)</span>
<span class="sd">        &gt;&gt;&gt; poly.n_vars  # 3D element</span>
<span class="sd">        3</span>
<span class="sd">        &gt;&gt;&gt; poly.n_terms  # Linear terms: 1, x, y, z</span>
<span class="sd">        4</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order: int </span>
<span class="sd">            the order of the basis</span>
<span class="sd">        dtype: torch.dtype</span>
<span class="sd">            the float data type of the polynomial</span>
<span class="sd">        device: torch.device</span>
<span class="sd">            the device of the polynomial</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        polynomial: Polynomial</span>
<span class="sd">            A polynomial object with number of variables equal to the element dimension, </span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>


    <span class="c1"># @abstractmethod</span>
<div class="viewcode-block" id="Element.get_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_quadrature">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the quadrature points and weights for the element.</span>

<span class="sd">        For elements with single type of facets (e.g. Tetrahedron):</span>
<span class="sd">            * Returns a tuple of two tensors containing quadrature weights and points</span>

<span class="sd">        For elements with mixed facets (e.g. Prism):</span>
<span class="sd">            * Returns a tuple of four tensors containing quadrature weights and points for each facet type </span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Triangle</span>
<span class="sd">        &gt;&gt;&gt; weights, points = Triangle.get_quadrature(order=1)</span>
<span class="sd">        &gt;&gt;&gt; weights.shape  # Number of quadrature points</span>
<span class="sd">        torch.Size([1])</span>
<span class="sd">        &gt;&gt;&gt; points.shape  # [n_points, dimension]</span>
<span class="sd">        torch.Size([1, 2])</span>

<span class="sd">        &gt;&gt;&gt; weights, points = Triangle.get_quadrature(order=2)</span>
<span class="sd">        &gt;&gt;&gt; weights.shape  # More quadrature points for higher order</span>
<span class="sd">        torch.Size([3])</span>
<span class="sd">        &gt;&gt;&gt; points.shape</span>
<span class="sd">        torch.Size([3, 2])</span>

<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Tetrahedron</span>
<span class="sd">        &gt;&gt;&gt; weights, points = Tetrahedron.get_quadrature(order=1)</span>
<span class="sd">        &gt;&gt;&gt; weights.shape</span>
<span class="sd">        torch.Size([1])</span>
<span class="sd">        &gt;&gt;&gt; points.shape  # 3D points</span>
<span class="sd">        torch.Size([1, 3])</span>
<span class="sd">            </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order: int </span>
<span class="sd">            quadrature order</span>
<span class="sd">        dtype: torch.dtype</span>
<span class="sd">            the float data type of the polynomial</span>
<span class="sd">        device: torch.device</span>
<span class="sd">            the device of the polynomial</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        - quadrature_weights : torch.Tensor</span>
<span class="sd">            1D Tensor of shape :math:`[N_q]` where :math:`N_q` = number of quadrature points </span>
<span class="sd">        - quadrature_points : torch.Tensor</span>
<span class="sd">            2D Tensor of shape :math:`[N_q, D]` where :math:`N_q` = number of quadrature points and :math:`D` = dimension of element (1, 2, or 3)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>


    <span class="c1"># @abstractmethod</span>
<div class="viewcode-block" id="Element.get_facet_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_facet_quadrature">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_facet_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                             <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                             <span class="n">transform</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                             <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                             <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                             <span class="p">)</span><span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tensorx2</span><span class="p">,</span><span class="n">Tensorx4</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the quadrature points and weights for the facets of the element.</span>

<span class="sd">        This method returns quadrature rules for integrating over element facets. The return format depends on whether the element has uniform or mixed facet types.</span>

<span class="sd">        **For elements with uniform facets** (e.g. Tetrahedron):</span>
<span class="sd">            * Returns a tuple of (weights, points) tensors</span>
<span class="sd">            * weights: quadrature weights for each facet point</span>
<span class="sd">            * points: quadrature point coordinates </span>

<span class="sd">        **For elements with mixed facets** (e.g. Prism):</span>
<span class="sd">            * Returns a tuple of (tri_weights, tri_points, quad_weights, quad_points)</span>
<span class="sd">            * tri_weights: quadrature weights for triangular facets</span>
<span class="sd">            * tri_points: quadrature points for triangular facets  </span>
<span class="sd">            * quad_weights: quadrature weights for quadrilateral facets</span>
<span class="sd">            * quad_points: quadrature points for quadrilateral facets</span>

<span class="sd">        The quadrature points can be returned either in the reference element coordinates (transform=True) or in facet-local coordinates (transform=False).</span>
<span class="sd">        </span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; # Example for tetrahedron element with uniform triangular facets</span>
<span class="sd">        &gt;&gt;&gt; weights, points = Tetrahedron.get_facet_quadrature(order=1)</span>
<span class="sd">        &gt;&gt;&gt; weights.shape  # [n_facet=4, n_quad_points=1] </span>
<span class="sd">        torch.Size([4, 1])</span>
<span class="sd">        &gt;&gt;&gt; points.shape  # [n_facet=4, n_quad_points=1, dim=3]</span>
<span class="sd">        torch.Size([4, 1, 3])</span>

<span class="sd">        &gt;&gt;&gt; # Example for prism element with mixed facets (triangular and quadrilateral)</span>
<span class="sd">        &gt;&gt;&gt; tri_w, tri_p, quad_w, quad_p = Prism.get_facet_quadrature(order=1)</span>
<span class="sd">        &gt;&gt;&gt; tri_w.shape  # [n_tri_facet=2, n_quad_points=1]</span>
<span class="sd">        torch.Size([2, 1]) </span>
<span class="sd">        &gt;&gt;&gt; tri_p.shape  # [n_tri_facet=2, n_quad_points=1, dim=3]</span>
<span class="sd">        torch.Size([2, 1, 3])</span>
<span class="sd">        &gt;&gt;&gt; quad_w.shape # [n_quad_facet=3, n_quad_points=1]</span>
<span class="sd">        torch.Size([3, 1])</span>
<span class="sd">        &gt;&gt;&gt; quad_p.shape # [n_quad_facet=3, n_quad_points=1, dim=3] </span>
<span class="sd">        torch.Size([3, 1, 3])</span>

<span class="sd">        &gt;&gt;&gt; # Example with transform=False returns points in facet-local coordinates</span>
<span class="sd">        &gt;&gt;&gt; weights, points = Triangle.get_facet_quadrature(order=1, transform=False)</span>
<span class="sd">        &gt;&gt;&gt; weights.shape  # [n_quad_points=1]</span>
<span class="sd">        torch.Size([1])</span>
<span class="sd">        &gt;&gt;&gt; points.shape  # [n_quad_points=1, dim-1=1] </span>
<span class="sd">        torch.Size([1, 1])</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order : int, optional</span>
<span class="sd">            Quadrature order. Default is 1.</span>
<span class="sd">        transform : bool, optional</span>
<span class="sd">            Whether to return the transformed facet quadrature.</span>
<span class="sd">            If True, returns points in reference element coordinates with shape :math:`[N_f, N_q, D]`, where :math:`N_f` = number of facets, :math:`N_q` = quadrature points per facet, and :math:`D` = spatial dimension.</span>
<span class="sd">            If False, returns points in facet-local coordinates with shape :math:`[N_q, D-1]`, where :math:`N_q` = quadrature points per facet and :math:`D` = spatial dimension.</span>
<span class="sd">        dtype : torch.dtype, optional</span>
<span class="sd">            The float data type of the polynomial.</span>
<span class="sd">        device : torch.device, optional</span>
<span class="sd">            The device of the polynomial.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        For elements with uniform facets</span>
<span class="sd">            quadrature_weights : torch.Tensor</span>
<span class="sd">                If transform=True,  2D tensor of shape :math:`[N_f, N_q]` where :math:`N_f` = number of facets, :math:`N_q` = quadrature points per facet</span>
<span class="sd">                If transform=False, 1D tensor of shape :math:`[N_q]` where :math:`N_q` = quadrature points per facet</span>
<span class="sd">            quadrature_points : torch.Tensor</span>
<span class="sd">                If transform=True, 3D tensor of shape :math:`[N_f, N_q, D]` where :math:`N_f` = number of facets, :math:`N_q` = quadrature points per facet, :math:`D` = spatial dimension</span>
<span class="sd">                If transform=False, 2D tensor of shape :math:`[N_q, D-1]` where :math:`N_q` = quadrature points per facet, :math:`D` = spatial dimension</span>

<span class="sd">        For elements with mixed facets</span>
<span class="sd">            tri_quadrature_weights : torch.Tensor</span>
<span class="sd">                If transform=True, 2D tensor of shape :math:`[N_{tf}, N_{tq}]` where :math:`N_{tf}` = number of triangular facets, :math:`N_{tq}` = quadrature points per triangular facet</span>
<span class="sd">                If transform=False, 1D tensor of shape :math:`[N_{tq}]` where :math:`N_{tq}` = quadrature points per triangular facet</span>
<span class="sd">            tri_quadrature_points : torch.Tensor</span>
<span class="sd">                If transform=True, 3D tensor of shape :math:`[N_{tf}, N_{tq}, D]` where :math:`N_{tf}` = number of triangular facets, :math:`N_{tq}` = quadrature points per triangular facet, :math:`D` = spatial dimension</span>
<span class="sd">                If transform=False, 2D tensor of shape :math:`[N_{tq}, D-1]` where :math:`N_{tq}` = quadrature points per triangular facet, :math:`D` = spatial dimension</span>
<span class="sd">            quad_quadrature_weights : torch.Tensor</span>
<span class="sd">                If transform=True, 2D tensor of shape :math:`[N_{qf}, N_{qq}]` where :math:`N_{qf}` = number of quadrilateral facets, :math:`N_{qq}` = quadrature points per quadrilateral facet</span>
<span class="sd">                If transform=False, 1D tensor of shape :math:`[N_{qq}]` where :math:`N_{qq}` = quadrature points per quadrilateral facet</span>
<span class="sd">            quad_quadrature_points : torch.Tensor</span>
<span class="sd">                If transform=True, 3D tensor of shape :math:`[N_{qf}, N_{qq}, D]` where :math:`N_{qf}` = number of quadrilateral facets, :math:`N_{qq}` = quadrature points per quadrilateral facet, :math:`D` = spatial dimension</span>
<span class="sd">                If transform=False, 2D tensor of shape :math:`[N_{qq}, D-1]` where :math:`N_{qq}` = quadrature points per quadrilateral facet, :math:`D` = spatial dimension</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>


<div class="viewcode-block" id="Element.get_basis_fns">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_basis_fns">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_basis_fns</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                      <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                      <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                      <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                      <span class="p">)</span><span class="o">-&gt;</span><span class="n">Polynomials</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the basis functions for this element type.</span>

<span class="sd">        Returns polynomial basis functions that interpolate values at the element nodes.</span>
<span class="sd">        The basis functions have the Kronecker delta property, meaning each basis function</span>
<span class="sd">        is 1 at its corresponding node and 0 at all other nodes.</span>

<span class="sd">        For example, for a linear triangle element (order=1), returns 3 basis functions</span>
<span class="sd">        corresponding to the 3 vertices. Each basis function is 1 at one vertex and 0</span>
<span class="sd">        at the other vertices.</span>

<span class="sd">        For higher orders, returns basis functions for both vertex and edge nodes.</span>
<span class="sd">        The number and location of nodes depends on the specific element type.</span>

<span class="sd">        The basis functions are returned as a Polynomials object containing the</span>
<span class="sd">        polynomial coefficients and exponents. This allows efficient evaluation</span>
<span class="sd">        and manipulation of the basis functions.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        .. code-block:: python</span>

<span class="sd">            &gt;&gt;&gt; from tensormesh.element import Triangle</span>
<span class="sd">            &gt;&gt;&gt; basis_fns = Triangle.get_basis_fns(order=1)</span>
<span class="sd">            &gt;&gt;&gt; basis_fns</span>
<span class="sd">            Polynomials([</span>
<span class="sd">                1 - x - y,  # First basis function, 1 at vertex 0 (0,0)</span>
<span class="sd">                x,          # Second basis function, 1 at vertex 1 (1,0)</span>
<span class="sd">                y           # Third basis function, 1 at vertex 2 (0,1)</span>
<span class="sd">            ])</span>

<span class="sd">            &gt;&gt;&gt; # Evaluate basis functions at a point</span>
<span class="sd">            &gt;&gt;&gt; point = torch.tensor([[0.5, 0.25]])</span>
<span class="sd">            &gt;&gt;&gt; values = basis_fns(point)</span>
<span class="sd">            &gt;&gt;&gt; values</span>
<span class="sd">            tensor([[0.25, 0.50, 0.25]])  # Values sum to 1</span>

<span class="sd">            &gt;&gt;&gt; # Higher order basis functions</span>
<span class="sd">            &gt;&gt;&gt; basis_fns = Triangle.get_basis_fns(order=2)</span>
<span class="sd">            &gt;&gt;&gt; basis_fns</span>
<span class="sd">            Polynomials([</span>
<span class="sd">                # Vertex basis functions</span>
<span class="sd">                2*x^2 + 2*y^2 - 3*x - 3*y + 1,  # Node 0 </span>
<span class="sd">                2*x^2 - x,                       # Node 1</span>
<span class="sd">                2*y^2 - y,                       # Node 2</span>
<span class="sd">                # Edge basis functions  </span>
<span class="sd">                4*x*y,                           # Node 3</span>
<span class="sd">                -4*x*y + 4*x,                    # Node 4 </span>
<span class="sd">                -4*x*y + 4*y                     # Node 5</span>
<span class="sd">            ])</span>

<span class="sd">            &gt;&gt;&gt; from tensormesh.element import Tetrahedron</span>
<span class="sd">            &gt;&gt;&gt; basis_fns = Tetrahedron.get_basis_fns(order=1)</span>
<span class="sd">            &gt;&gt;&gt; basis_fns</span>
<span class="sd">            Polynomials([</span>
<span class="sd">                1 - x - y - z,  # First basis function</span>
<span class="sd">                x,              # Second basis function  </span>
<span class="sd">                y,              # Third basis function</span>
<span class="sd">                z               # Fourth basis function</span>
<span class="sd">            ])</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order : int </span>
<span class="sd">            The order of the basis functions.</span>
<span class="sd">        dtype : torch.dtype</span>
<span class="sd">            The float data type of the polynomial.</span>
<span class="sd">        device : torch.device</span>
<span class="sd">            The device to place the polynomial on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Polynomials</span>
<span class="sd">            The basis functions of the element. Shape is :math:`[N_b]` where :math:`N_b` is the number of basis functions, with :math:`N_{vars}=D` variables and :math:`N_{exp}=N_b` expansion terms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">adaptive_inv</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
            <span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-7</span>
            <span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Input tensor must be 2D, got </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span><span class="si">}</span><span class="s2">D&quot;</span>
            <span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;Input tensor must be square, got shape </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">order</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">result</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">device</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
                <span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;basis functions are not accurate for </span><span class="si">{</span><span class="bp">cls</span><span class="si">}</span><span class="s2"> with order </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>
        
        <span class="n">basis</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span> <span class="c1"># [n_basis, n_dim] n_dim ~ n_vars</span>
        
        <span class="n">n_basis</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># basis [order + 1, 1]</span>
        
        <span class="n">polys</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">n_basis</span><span class="p">)</span> <span class="c1"># Polynomials [n_basis] n_vars=dim n_exp=n_basis</span>
        
        <span class="n">V</span> <span class="o">=</span> <span class="n">polys</span><span class="o">.</span><span class="n">get_exp_terms</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span> <span class="c1"># [n_basis, n_basis]</span>
        <span class="n">coef</span> <span class="o">=</span> <span class="n">adaptive_inv</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="c1"># [n_basis, n_basis] </span>
        <span class="n">polys</span><span class="o">.</span><span class="n">reset_coef</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span>
        <span class="n">polys</span> <span class="o">=</span> <span class="n">polys</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">polys</span></div>


<div class="viewcode-block" id="Element.get_basis_grad_fns">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_basis_grad_fns">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_basis_grad_fns</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                                 <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                                 <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                                 <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                                 <span class="p">)</span><span class="o">-&gt;</span><span class="n">Polynomials</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get the gradient of basis functions with respect to reference coordinates.</span>

<span class="sd">        For a basis function :math:`\phi(x_1,\ldots,x_n)`, computes the gradient:</span>

<span class="sd">        .. math::</span>

<span class="sd">            \nabla \phi = \left[\frac{\partial \phi}{\partial x_1}, \ldots, \frac{\partial \phi}{\partial x_n}\right]</span>

<span class="sd">        The gradient is computed by taking the partial derivative of each basis function</span>
<span class="sd">        with respect to each coordinate direction :math:`x_i` in the reference element.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; # Get gradients of linear basis functions for a triangle</span>
<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Triangle</span>
<span class="sd">        &gt;&gt;&gt; grad_fns = Triangle.get_basis_grad_fns(order=1)</span>
<span class="sd">        &gt;&gt;&gt; points = torch.tensor([[0.0, 0.0], [0.5, 0.5]])</span>
<span class="sd">        &gt;&gt;&gt; grads = grad_fns(points)  # [n_points=2, dim=2, n_basis=3]</span>
<span class="sd">        &gt;&gt;&gt; grads.shape</span>
<span class="sd">        torch.Size([2, 2, 3])</span>

<span class="sd">        &gt;&gt;&gt; # Get gradients of quadratic basis functions for a tetrahedron</span>
<span class="sd">        &gt;&gt;&gt; from tensormesh.element import Tetrahedron</span>
<span class="sd">        &gt;&gt;&gt; grad_fns = Tetrahedron.get_basis_grad_fns(order=2)</span>
<span class="sd">        &gt;&gt;&gt; points = torch.tensor([[0.25, 0.25, 0.25]])</span>
<span class="sd">        &gt;&gt;&gt; grads = grad_fns(points)  # [n_points=1, dim=3, n_basis=10]</span>
<span class="sd">        &gt;&gt;&gt; grads.shape</span>
<span class="sd">        torch.Size([1, 3, 10])</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        .. code-block:: python</span>

<span class="sd">            element = Triangle</span>
<span class="sd">            grad_fns = element.get_basis_grad_fns(order=1)</span>
<span class="sd">            points = torch.tensor([[0.0, 0.0], [0.5, 0.5]], dtype=torch.float32)</span>
<span class="sd">            grads = grad_fns(points) # [n_points, dim, n_basis]</span>
<span class="sd">            print(grads.shape) # torch.Size([2, 2, 3])  # 2 points, 2D gradients, 3 basis functions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order : int </span>
<span class="sd">            The order of the basis functions</span>
<span class="sd">        dtype : torch.dtype</span>
<span class="sd">            The float data type of the polynomial</span>
<span class="sd">        device : torch.device</span>
<span class="sd">            The device to place the polynomial on</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Polynomials</span>
<span class="sd">            The gradient basis functions. Shape is :math:`[D, N_b]` where</span>
<span class="sd">            - :math:`D` = spatial dimension</span>
<span class="sd">            - :math:`N_b` = number of basis functions</span>
<span class="sd">            - n_vars = :math:`D`</span>
<span class="sd">            - n_terms = :math:`N_b`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">basis_fns</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_basis_fns</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span> <span class="c1"># Polynomials [n_basis] n_vars=dim n_exp=n_basis</span>
        <span class="k">return</span> <span class="n">basis_fns</span><span class="o">.</span><span class="n">grad</span><span class="p">()</span> <span class="c1"># Polynomials [dim, n_basis] n_vars=dim n_terms = n_basis</span></div>


<div class="viewcode-block" id="Element.eval_cell_jacobian">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.eval_cell_jacobian">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span> <span class="nf">eval_cell_jacobian</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                        <span class="n">quadrature</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> 
                        <span class="n">element_coords</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> 
                        <span class="n">basis_order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Evaluate the Jacobian matrix at quadrature points for each element.</span>

<span class="sd">        The Jacobian matrix represents the linear transformation from reference coordinates to physical coordinates.</span>
<span class="sd">        It is computed by multiplying the element coordinates by the gradients of the basis functions.</span>

<span class="sd">        For each quadrature point q and element e, computes:</span>

<span class="sd">        .. math::</span>

<span class="sd">            J_{e,q,i,j} = \sum_b \text{coords}_{e,b,j} \frac{\partial \phi_b}{\partial x_i}(q)</span>

<span class="sd">        where:</span>

<span class="sd">        * :math:`\text{coords}_{e,b,j}` is the j-th coordinate of basis node b in element e</span>
<span class="sd">        * :math:`\phi_b` is basis function b  </span>
<span class="sd">        * :math:`\frac{\partial \phi_b}{\partial x_i}` is the derivative of basis function b with respect to reference coordinate i</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        .. code-block:: python</span>

<span class="sd">            element = Triangle</span>
<span class="sd">            quadrature = torch.tensor([[0.0, 0.0], [0.5, 0.5]], dtype=torch.float32)</span>
<span class="sd">            element_coords = torch.tensor([[[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]], dtype=torch.float32)</span>
<span class="sd">            jacobian = element.eval_cell_jacobian(quadrature, element_coords)</span>
<span class="sd">            print(jacobian.shape)  # torch.Size([1, 2, 2, 2])</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        quadrature : torch.Tensor</span>
<span class="sd">            Shape :math:`[N_q, D]` or :math:`[N_e, N_q, D]` where:</span>
<span class="sd">            </span>
<span class="sd">            * :math:`N_q` = number of quadrature points</span>
<span class="sd">            * :math:`N_e` = number of elements</span>
<span class="sd">            * :math:`D` = spatial dimension</span>
<span class="sd">            </span>
<span class="sd">            Quadrature points for each element</span>
<span class="sd">        element_coords : torch.Tensor </span>
<span class="sd">            Shape :math:`[N_e, N_b, D]` where:</span>
<span class="sd">            </span>
<span class="sd">            * :math:`N_e` = number of elements</span>
<span class="sd">            * :math:`N_b` = number of basis nodes</span>
<span class="sd">            * :math:`D` = spatial dimension</span>
<span class="sd">            </span>
<span class="sd">            Physical coordinates of element nodes</span>
<span class="sd">        basis_order : int, optional</span>
<span class="sd">            Order of basis functions, by default 1</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        torch.Tensor</span>
<span class="sd">            Shape :math:`[N_e, N_q, D, D]` where:</span>
<span class="sd">            </span>
<span class="sd">            * :math:`N_e` = number of elements</span>
<span class="sd">            * :math:`N_q` = number of quadrature points</span>
<span class="sd">            * :math:`D` = spatial dimension</span>
<span class="sd">            </span>
<span class="sd">            Jacobian matrix evaluated at each quadrature point for each element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">quadrature</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">element_coords</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;quadrature dtype </span><span class="si">{</span><span class="n">quadrature</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2"> != element_coords dtype </span><span class="si">{</span><span class="n">element_coords</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="n">quadrature</span><span class="o">.</span><span class="n">device</span> <span class="o">==</span> <span class="n">element_coords</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;quadrature device </span><span class="si">{</span><span class="n">quadrature</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2"> != element_coords device </span><span class="si">{</span><span class="n">element_coords</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">dtype</span>  <span class="o">=</span> <span class="n">quadrature</span><span class="o">.</span><span class="n">dtype</span>
        <span class="n">device</span> <span class="o">=</span> <span class="n">quadrature</span><span class="o">.</span><span class="n">device</span>

        <span class="n">shape_grad_fns</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_basis_grad_fns</span><span class="p">(</span><span class="n">basis_order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span> <span class="c1"># Polynomials  [dim, n_basis] n_vars=dim n_terms = n_basis</span>
        
        <span class="k">if</span> <span class="n">quadrature</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">n_basis</span>        <span class="o">=</span> <span class="n">shape_grad_fns</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">shape_grad</span>     <span class="o">=</span> <span class="n">shape_grad_fns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">quadrature</span><span class="p">)</span> <span class="c1"># [n_quadrature, dim, n_basis]</span>
            <span class="n">cell_jacobian</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ebj,qib-&gt;eqij&quot;</span><span class="p">,</span> <span class="n">element_coords</span><span class="p">,</span> <span class="n">shape_grad</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_element</span><span class="p">,</span> <span class="n">n_quadrature_per_element</span><span class="p">,</span> <span class="n">dim</span> <span class="o">=</span> <span class="n">quadrature</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">assert</span> <span class="n">n_element</span> <span class="o">==</span> <span class="n">element_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n_basis</span>        <span class="o">=</span> <span class="n">element_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">shape_grad</span>     <span class="o">=</span> <span class="n">shape_grad_fns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">quadrature</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span> <span class="c1"># [n_element,n_quadrature, dim, n_basis]</span>
            <span class="n">shape_grad</span>     <span class="o">=</span> <span class="n">shape_grad</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_element</span><span class="p">,</span> <span class="n">n_quadrature_per_element</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">n_basis</span><span class="p">)</span>
            <span class="n">cell_jacobian</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ebj,eqib-&gt;eqij&quot;</span><span class="p">,</span> <span class="n">element_coords</span><span class="p">,</span> <span class="n">shape_grad</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cell_jacobian</span></div>


<div class="viewcode-block" id="Element.eval_shape_val">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.eval_shape_val">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span> <span class="nf">eval_shape_val</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">quadrature_points</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                       <span class="n">quadrature_order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluates the shape functions at quadrature points.</span>

<span class="sd">        For a given set of quadrature points, evaluates each basis function phi_i at those points.</span>
<span class="sd">        Returns a matrix where entry (q,i) is the value of basis function i at quadrature point q.</span>

<span class="sd">        The shape functions have two key properties:</span>

<span class="sd">        1. Partition of unity: The functions sum to 1 at any point</span>
<span class="sd">        2. Interpolation property: phi_i(x_j) = delta_ij at the nodes</span>

<span class="sd">        For example, for linear elements (order=1):</span>

<span class="sd">        .. math::</span>
<span class="sd">            \phi_1(x) &amp;= 1-x \quad \text{(equals 1 at x=0, 0 at x=1)} \\</span>
<span class="sd">            \phi_2(x) &amp;= x \quad \text{(equals 0 at x=0, 1 at x=1)}</span>

<span class="sd">        For quadratic elements (order=2), includes additional mid-node basis functions.</span>

<span class="sd">        If quadrature_points are not provided, uses default quadrature rule of specified order.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        .. code-block:: python</span>

<span class="sd">            import torch</span>
<span class="sd">            from tensormesh.element import Element</span>

<span class="sd">            # Create quadrature points</span>
<span class="sd">            quad_points = torch.tensor([[0.0], [0.5], [1.0]])</span>
<span class="sd">            </span>
<span class="sd">            # Evaluate shape functions at quadrature points</span>
<span class="sd">            shape_vals = Element.eval_shape_val(quad_points, order=1)</span>
<span class="sd">            print(shape_vals.shape)  # [3, 2] for linear element</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        quadrature_points : Optional[torch.Tensor]</span>
<span class="sd">            Tensor of shape :math:`[N_q, D]` containing quadrature points, where :math:`N_q` = number of quadrature points and :math:`D` = spatial dimension</span>
<span class="sd">        order : int</span>
<span class="sd">            Order of the basis functions</span>
<span class="sd">        quadrature_order : int </span>
<span class="sd">            The order for quadrature, if quadrature is not None, quadrature_order will be ignored</span>
<span class="sd">        dtype : torch.dtype</span>
<span class="sd">            The float data type of the shape value, if quadrature_points is not None, the dtype will be ignored.</span>
<span class="sd">            Default is torch.float32</span>
<span class="sd">        device : torch.device</span>
<span class="sd">            The device of the shape value, if quadrature_points is not None, the device will be ignored.</span>
<span class="sd">            Default is torch.device(&#39;cpu&#39;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        torch.Tensor</span>
<span class="sd">            Tensor of shape :math:`[N_q, N_b]` containing shape function values, where :math:`N_q` = number of quadrature points and :math:`N_b` = number of basis functions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">quadrature_points</span><span class="o">.</span><span class="n">dtype</span> <span class="k">if</span> <span class="n">quadrature_points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dtype</span>
        <span class="n">device</span><span class="o">=</span> <span class="n">quadrature_points</span><span class="o">.</span><span class="n">device</span> <span class="k">if</span> <span class="n">quadrature_points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">device</span>
        <span class="k">if</span> <span class="n">quadrature_points</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">quadrature_points</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">quadrature_order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
        <span class="n">basis_fns</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_basis_fns</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span> <span class="c1"># Polynomials [n_basis] n_vars=dim n_exp=n_basis</span>
        <span class="n">shape_val</span> <span class="o">=</span> <span class="n">basis_fns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">quadrature_points</span><span class="p">)</span> <span class="c1"># [n_quadrature, n_basis]</span>
        <span class="k">return</span> <span class="n">shape_val</span> </div>

    
<div class="viewcode-block" id="Element.eval_shape_grad">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.eval_shape_grad">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span> <span class="nf">eval_shape_grad</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                        <span class="n">element_coords</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> 
                        <span class="n">quadrature</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                        <span class="n">basis_order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                        <span class="n">quadrature_order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span>
                        <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluates the shape function gradients and cell Jacobians at quadrature points.</span>

<span class="sd">        For each element, computes:</span>

<span class="sd">        1. Shape function gradients in reference coordinates</span>
<span class="sd">        2. Cell Jacobian mapping from reference to physical coordinates </span>
<span class="sd">        3. Transforms gradients to physical coordinates using inverse Jacobian</span>

<span class="sd">        The shape function gradients are used in weak form assembly:</span>

<span class="sd">        .. math::</span>
<span class="sd">            \nabla \phi_i = \sum_j J^{-1}_{jk} \frac{\partial \phi_i}{\partial \xi_k}</span>

<span class="sd">        where:</span>

<span class="sd">        - :math:`\phi_i` are the basis functions</span>
<span class="sd">        - :math:`J` is the Jacobian matrix</span>
<span class="sd">        - :math:`\xi_k` are reference coordinates</span>

<span class="sd">        The cell Jacobian :math:`J_{ij} = \frac{\partial x_i}{\partial \xi_j}` maps derivatives between reference and physical coordinates.</span>

<span class="sd">        For linear elements (order=1), the Jacobian is constant within each element.</span>
<span class="sd">        For higher order elements, the Jacobian varies spatially.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        .. code-block:: python</span>

<span class="sd">            import torch</span>
<span class="sd">            from tensormesh.element import Element</span>

<span class="sd">            # Create element coordinates</span>
<span class="sd">            element_coords = torch.tensor([[[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]])</span>
<span class="sd">            </span>
<span class="sd">            # Evaluate shape function gradients and Jacobian</span>
<span class="sd">            shape_grad, cell_jacobian = Element.eval_shape_grad(element_coords, basis_order=1)</span>
<span class="sd">            print(shape_grad.shape)      # [1, n_quad, 3, 2] </span>
<span class="sd">            print(cell_jacobian.shape)   # [1, n_quad, 2, 2]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        element_coords: torch.Tensor </span>
<span class="sd">            Tensor of shape :math:`[N_e, N_b, D]` containing element vertex coordinates, where:</span>
<span class="sd">            - :math:`N_e` = number of elements</span>
<span class="sd">            - :math:`N_b` = number of basis functions</span>
<span class="sd">            - :math:`D` = spatial dimension</span>
<span class="sd">        quadrature: torch.Tensor</span>
<span class="sd">            Tensor of shape :math:`[N_q, D]` containing quadrature points for each element, where:</span>
<span class="sd">            - :math:`N_q` = number of quadrature points</span>
<span class="sd">            - :math:`D` = spatial dimension</span>
<span class="sd">        basis_order: int </span>
<span class="sd">            Order for basis functions</span>
<span class="sd">        quadrature_order: int </span>
<span class="sd">            Order for quadrature, if element_coords is not None, the quadrature_order will be ignored,</span>
<span class="sd">            default is 1</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        shape_grad: torch.Tensor</span>
<span class="sd">            Tensor of shape :math:`[N_e, N_q, N_b, D]` containing shape function gradients, where:</span>
<span class="sd">            - :math:`N_e` = number of elements</span>
<span class="sd">            - :math:`N_q` = number of quadrature points</span>
<span class="sd">            - :math:`N_b` = number of basis functions</span>
<span class="sd">            - :math:`D` = spatial dimension</span>
<span class="sd">        cell_jacobian: torch.Tensor </span>
<span class="sd">            Tensor of shape :math:`[N_e, N_q, D, D]` containing cell Jacobians, where:</span>
<span class="sd">            - :math:`N_e` = number of elements</span>
<span class="sd">            - :math:`N_q` = number of quadrature points</span>
<span class="sd">            - :math:`D` = spatial dimension</span>
<span class="sd">        &quot;&quot;&quot;</span>
  
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">element_coords</span><span class="o">.</span><span class="n">dtype</span>
        <span class="n">device</span><span class="o">=</span> <span class="n">element_coords</span><span class="o">.</span><span class="n">device</span>
        <span class="k">if</span> <span class="n">quadrature</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">quadrature</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">quadrature_order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span> <span class="c1"># [n_quadrature, dim]</span>

        <span class="n">shape_grad_fns</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_basis_grad_fns</span><span class="p">(</span><span class="n">basis_order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span> <span class="c1"># Polynomials  [dim, n_basis]</span>
    
        <span class="n">shape_grad</span>     <span class="o">=</span> <span class="n">shape_grad_fns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">quadrature</span><span class="p">)</span> <span class="c1"># [n_qudrature, dim, n_basis]</span>

        <span class="n">cell_jacobian</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ebj,qib-&gt;eqij&quot;</span><span class="p">,</span> <span class="n">element_coords</span><span class="p">,</span> <span class="n">shape_grad</span><span class="p">)</span> <span class="c1"># TODO: check the order</span>
        
        <span class="n">inv_cell_jacobian</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="n">cell_jacobian</span><span class="p">)</span>

        <span class="n">shape_grad</span>     <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;qib, eqji-&gt;eqbj&quot;</span><span class="p">,</span> <span class="n">shape_grad</span><span class="p">,</span> <span class="n">inv_cell_jacobian</span><span class="p">)</span> 

        <span class="k">return</span> <span class="n">shape_grad</span><span class="p">,</span> <span class="n">cell_jacobian</span></div>


<div class="viewcode-block" id="Element.get_local_facet_mapping_fns">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_local_facet_mapping_fns">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_local_facet_mapping_fns</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                                    <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                                    <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                                    <span class="p">)</span><span class="o">-&gt;</span><span class="n">Polynomials</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Maps points from the reference facet to the facet of the reference element.</span>

<span class="sd">        For a facet :math:`f`, defines a mapping :math:`\gamma_f(r)` from reference facet coordinates :math:`r` </span>
<span class="sd">        to reference element coordinates :math:`\xi`:</span>

<span class="sd">        .. math::</span>
<span class="sd">            \gamma_f: \hat{F} \rightarrow F</span>

<span class="sd">        where:</span>
<span class="sd">        - :math:`\hat{F}` is the reference facet (e.g. line for 2D, triangle for 3D)</span>
<span class="sd">        - :math:`F` is the facet of the reference element</span>
<span class="sd">        - :math:`\gamma_f(r)` is a linear mapping</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        .. code-block:: python</span>

<span class="sd">            import torch</span>
<span class="sd">            from tensormesh.element import Triangle</span>
<span class="sd">            </span>
<span class="sd">            # Get mapping functions for triangle element facets</span>
<span class="sd">            facet_fns = Triangle.get_local_facet_mapping_fns()</span>
<span class="sd">            </span>
<span class="sd">            # Map points from reference facet to element facet</span>
<span class="sd">            ref_points = torch.tensor([[0.0], [0.5], [1.0]])  # Points on reference line</span>
<span class="sd">            mapped_points = facet_fns.map(ref_points)  # Points on triangle facet</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dtype: torch.dtype</span>
<span class="sd">            the float data type of the polynomials</span>
<span class="sd">            default is torch.float32</span>
<span class="sd">        device: torch.device</span>
<span class="sd">            the device of the polynomials</span>
<span class="sd">            default is torch.device(&#39;cpu&#39;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        local_facet_fns : Polynomials</span>
<span class="sd">            Polynomial functions mapping reference facet to element facet coordinates.</span>
<span class="sd">            Shape is :math:`[N_f, D]` where:</span>
<span class="sd">            </span>
<span class="sd">            - :math:`N_f` = number of facets</span>
<span class="sd">            - :math:`D` = spatial dimension</span>
<span class="sd">            </span>
<span class="sd">            Each polynomial has:</span>
<span class="sd">            </span>
<span class="sd">            - :math:`D-1` variables (reference facet coordinates)</span>
<span class="sd">            - :math:`D` terms (affine transformation)</span>
<span class="sd">            </span>
<span class="sd">            The mapping takes the form:</span>
<span class="sd">            </span>
<span class="sd">            .. math::</span>
<span class="sd">                \gamma_f(r) = c + \sum_{i=1}^{D-1} \alpha_i r_i</span>
<span class="sd">                </span>
<span class="sd">            where :math:`c, \alpha_i \in \mathbb{R}^D` are the coefficients</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">facet</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">2</span> <span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> 
            <span class="mi">3</span> <span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">face</span> 
        <span class="p">}[</span><span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">]</span>
    
        <span class="n">facet_dim</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span>
    
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">origin_facet_coords</span> <span class="o">=</span> <span class="n">Line</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">Line</span><span class="o">.</span><span class="n">vertex</span><span class="p">]</span> <span class="c1"># [2(points), 1, 1(dim-1)]</span>
            <span class="n">origin_facet_coords</span> <span class="o">=</span> <span class="n">origin_facet_coords</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># [1, 2(points), 1(dim-1)]</span>
            <span class="n">transf_facet_coords</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span>    <span class="c1"># [n_facet, n_edge, 1(dim-1)]</span>
        <span class="k">elif</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">origin_facet_coords</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">Triangle</span><span class="o">.</span><span class="n">vertex</span><span class="p">]</span> <span class="c1"># [3(points), n_triangle, 2(dim-1)]</span>
            <span class="n">origin_facet_coords</span> <span class="o">=</span> <span class="n">origin_facet_coords</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># [n_triangle, 3(points), 2(dim-1)]</span>
            <span class="n">transf_facet_coords</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">x</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">facet</span><span class="p">])]</span> <span class="c1"># [n_triangle, 3(points), 3(dim)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid dim </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="n">transf_facet_coords</span> <span class="o">=</span> <span class="n">transf_facet_coords</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="c1"># [n_facet, n_vertex_per_facet, dim]   </span>
       
        <span class="n">polys</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">lin_exp</span><span class="p">(</span><span class="n">facet_dim</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span> <span class="c1"># n_vars=dim-1(n_vars), n_terms=dim</span>
        <span class="n">polys</span> <span class="o">=</span> <span class="n">polys</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">facet</span><span class="p">),</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>         <span class="c1"># [n_face, dim] n_vars=dim-1 n_terms=dim</span>
       
        <span class="n">origin_facet_coords</span> <span class="o">=</span> <span class="n">origin_facet_coords</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">facet</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 
        <span class="n">origin_facet_coords</span> <span class="o">=</span> <span class="n">origin_facet_coords</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>    <span class="c1"># [n_face, n_vertex_per_facet, dim-1]</span>

        <span class="n">result</span><span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">polys</span><span class="o">.</span><span class="n">get_exp_terms</span><span class="p">(</span><span class="n">origin_facet_coords</span><span class="p">),</span> <span class="c1"># [n_vertex_per_facet, n_facet, dim] </span>
                                <span class="n">transf_facet_coords</span><span class="p">)</span>
        <span class="n">x</span>     <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">solution</span> <span class="c1"># [n_facet, dim, dim]</span>
        
        <span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">facet</span><span class="p">),</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
        <span class="n">polys</span><span class="o">.</span><span class="n">reset_coef</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>   
        <span class="k">return</span> <span class="n">polys</span>     </div>

    
<div class="viewcode-block" id="Element.get_local_facet_mapping_grad_fns">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_local_facet_mapping_grad_fns">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_local_facet_mapping_grad_fns</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                                         <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                                         <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                                         <span class="p">)</span><span class="o">-&gt;</span><span class="n">Polynomials</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Computes the gradient of the facet mapping function with respect to the reference coordinates.</span>

<span class="sd">        For a facet mapping function :math:`\gamma_f(r)` that maps from reference coordinates :math:`r` to global coordinates,</span>
<span class="sd">        computes the Jacobian matrix:</span>

<span class="sd">        .. math::</span>
<span class="sd">            \frac{\partial \gamma_f (r)}{\partial r}</span>

<span class="sd">        This gives the derivatives of each global coordinate with respect to each reference coordinate.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        .. code-block:: python</span>

<span class="sd">            element = Triangle()</span>
<span class="sd">            facet_mapping_grad = element.get_local_facet_mapping_grad_fns()</span>
<span class="sd">            # Returns polynomial tensor with derivatives of mapping</span>
<span class="sd">            # Shape: [1, 3, 2] for 2D triangle element (1 ref coord, 3 edges, 2 global coords)</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dtype: torch.dtype</span>
<span class="sd">            the float data type of the polynomials</span>
<span class="sd">            default is torch.float32</span>
<span class="sd">        device: torch.device</span>
<span class="sd">            the device of the polynomials</span>
<span class="sd">            default is torch.device(&#39;cpu&#39;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PolynomialTensor</span>
<span class="sd">            Tensor containing the Jacobian with shape :math:`[D-1, N_f, D]` where:</span>
<span class="sd">            </span>
<span class="sd">            * :math:`D-1` = number of reference coordinates (gradient dimension)</span>
<span class="sd">            * :math:`N_f` = number of facets</span>
<span class="sd">            * :math:`D` = spatial dimension (global coordinates)</span>
<span class="sd">            </span>
<span class="sd">            The polynomial has :math:`n_{vars}=D-1` variables and :math:`n_{terms}=D` terms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">local_facet_fns</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_local_facet_mapping_fns</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span> <span class="c1"># Polynomials [n_facet, dim] n_vars=dim-1 n_terms = dim</span>
        <span class="k">return</span> <span class="n">local_facet_fns</span><span class="o">.</span><span class="n">grad</span><span class="p">()</span> <span class="c1"># [dim-1(gradient), n_facet, dim(global_coords)]</span></div>


<div class="viewcode-block" id="Element.get_outwards_facet_normal">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_outwards_facet_normal">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_outwards_facet_normal</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                                  <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                                  <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                                  <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx1</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Computes the outward unit normal vectors for each facet of the element.</span>

<span class="sd">        This returns the geometric normal vectors without the Nanson scale factor.</span>
<span class="sd">        For 2D elements, returns normals for each edge.</span>
<span class="sd">        For 3D elements, returns normals for each face.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        .. code-block:: python</span>

<span class="sd">            element = Triangle()</span>
<span class="sd">            normals = element.get_outwards_facet_normal()</span>
<span class="sd">            # Returns tensor of shape [3, 2] containing outward normals</span>
<span class="sd">            # for each edge of the triangle</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dtype: torch.dtype</span>
<span class="sd">            The float data type for the output tensor</span>
<span class="sd">            Default is torch.float32</span>
<span class="sd">        device: torch.device</span>
<span class="sd">            The device to place the output tensor on</span>
<span class="sd">            Default is torch.device(&#39;cpu&#39;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        outward_facet_normal : torch.Tensor</span>
<span class="sd">            Tensor of shape :math:`[N_f, D]` containing the outward unit normal vector for each facet, where:</span>
<span class="sd">            </span>
<span class="sd">            * :math:`N_f` = number of facets (edges in 2D, faces in 3D)</span>
<span class="sd">            * :math:`D` = spatial dimension (2 or 3)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">outwards_normal_fns</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">2</span><span class="p">:</span> <span class="n">outwards_normal_2d</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">:</span> <span class="n">outwards_normal_3d</span>
        <span class="p">}</span>
        <span class="n">facet</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">2</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">face</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">outwards_normal_fns</span><span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">](</span><span class="bp">cls</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">facet</span><span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">])</span></div>


<div class="viewcode-block" id="Element.get_n_facet">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_n_facet">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_n_facet</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">int</span><span class="p">:</span>
        <span class="n">dim2nfacet</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">2</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">),</span> 
            <span class="mi">3</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">dim2nfacet</span><span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">]</span></div>


<div class="viewcode-block" id="Element.get_n_basis">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_n_basis">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_n_basis</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


<div class="viewcode-block" id="Element.eval_facet_cell_jacobian">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.eval_facet_cell_jacobian">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval_facet_cell_jacobian</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                                 <span class="n">element_coords</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
                                 <span class="n">basis_order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">quadrature_order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span>
                                 <span class="p">)</span><span class="o">-&gt;</span><span class="n">Union</span><span class="p">[</span><span class="n">Tensorx1</span><span class="p">,</span><span class="n">Tensorx2</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluates the Jacobian matrix of the mapping from reference to physical coordinates at facet quadrature points.</span>

<span class="sd">        For each element and facet, computes the Jacobian matrix :math:`\mathbf{J} = \frac{\partial\mathbf{x}}{\partial\boldsymbol{\xi}}` </span>
<span class="sd">        at the quadrature points on that facet. The Jacobian describes how the reference element coordinates </span>
<span class="sd">        :math:`\boldsymbol{\xi}` map to physical coordinates :math:`\mathbf{x}`.</span>

<span class="sd">        For mixed elements with both triangular and quadrilateral facets (e.g. pyramids), returns separate Jacobians</span>
<span class="sd">        for each facet type.</span>

<span class="sd">        The Jacobian matrix components are:</span>

<span class="sd">        .. math::</span>

<span class="sd">            J_{ij} = \frac{\partial x_i}{\partial \xi_j}</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        .. code-block:: python</span>

<span class="sd">            # Create a triangle element</span>
<span class="sd">            element = Triangle()</span>
<span class="sd">            # Element coordinates for a single triangle </span>
<span class="sd">            coords = torch.tensor([[[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]])</span>
<span class="sd">            # Evaluate facet Jacobians using linear basis and 2nd order quadrature</span>
<span class="sd">            jacobians = element.eval_facet_cell_jacobian(coords, basis_order=1, quadrature_order=2)</span>
<span class="sd">            # jacobians shape: [1, 3, 2, 2, 2] for 1 element, 3 edges, 2 quad points per edge</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        element_coords : torch.Tensor</span>
<span class="sd">            3D Tensor of shape :math:`[N_e, N_b, D]` containing the physical coordinates of element nodes,</span>
<span class="sd">            where :math:`N_e` = number of elements, :math:`N_b` = number of basis nodes, :math:`D` = spatial dimension</span>
<span class="sd">        basis_order : int</span>
<span class="sd">            Order of the basis functions used for the mapping</span>
<span class="sd">        quadrature_order : int </span>
<span class="sd">            Order of quadrature rule used for facet integration</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        facet_cell_jacobian : torch.Tensor</span>
<span class="sd">            For elements with uniform facet types,</span>
<span class="sd">            5D Tensor of shape :math:`[N_e, N_f, N_q, D, D]` containing Jacobian matrices at facet quadrature points,</span>
<span class="sd">            where</span>
<span class="sd">            </span>
<span class="sd">            - :math:`N_e` = number of elements</span>
<span class="sd">            - :math:`N_f` = number of facets </span>
<span class="sd">            - :math:`N_q` = quadrature points per facet</span>
<span class="sd">            - :math:`D` = spatial dimension</span>
<span class="sd">            </span>
<span class="sd">        (tri_facet_cell_jacobian, quad_facet_cell_jacobian) : tuple of torch.Tensor</span>
<span class="sd">            For mixed elements with both triangular and quadrilateral facets,</span>

<span class="sd">            - tri_facet_cell_jacobian: :math:`[N_e, N_{tf}, N_{tq}, D, D]`, where :math:`N_{tf}` = number of triangular facets,</span>
<span class="sd">              :math:`N_{tq}` = quadrature points per triangular facet</span>
<span class="sd">            - quad_facet_cell_jacobian: :math:`[N_e, N_{qf}, N_{qq}, D, D]`, where :math:`N_{qf}` = number of quadrilateral facets,</span>
<span class="sd">              :math:`N_{qq}` = quadrature points per quadrilateral facet</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The Jacobian is used to:</span>

<span class="sd">        * Transform integrals from reference to physical space:</span>
<span class="sd">          </span>
<span class="sd">          .. math::</span>
<span class="sd">             </span>
<span class="sd">             \int_K f(\mathbf{x}) \,d\mathbf{x} = \int_{\hat{K}} f(\mathbf{x}(\boldsymbol{\xi})) \vert\det(\mathbf{J})\vert \,d\boldsymbol{\xi}</span>

<span class="sd">        * Compute geometric quantities like normal vectors and surface measures</span>
<span class="sd">        * Map derivatives between reference and physical coordinates:</span>

<span class="sd">          .. math::</span>
<span class="sd">             </span>
<span class="sd">             \nabla_{\mathbf{x}} = \mathbf{J}^{-T} \nabla_{\boldsymbol{\xi}}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">device</span> <span class="o">=</span> <span class="n">element_coords</span><span class="o">.</span><span class="n">device</span>
        <span class="n">dtype</span>  <span class="o">=</span> <span class="n">element_coords</span><span class="o">.</span><span class="n">dtype</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">is_mix_facet</span><span class="p">:</span>
            <span class="n">tri_w</span><span class="p">,</span> <span class="n">tri_q</span><span class="p">,</span> <span class="n">quad_w</span><span class="p">,</span> <span class="n">quad_q</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span>
                                            <span class="n">quadrature_order</span><span class="p">,</span> 
                                            <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
            <span class="n">n_tri_facet</span><span class="p">,</span> <span class="n">n_quadrature_per_tri_facet</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">tri_q</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">n_quad_facet</span><span class="p">,</span> <span class="n">n_quadrature_per_quad_facet</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">quad_q</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">tri_q</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">),</span> <span class="n">quad_q</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">j</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eval_cell_jacobian</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">element_coords</span><span class="p">,</span> <span class="n">basis_order</span><span class="p">)</span>
            <span class="n">tri_j</span> <span class="o">=</span> <span class="n">j</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_tri_facet</span> <span class="o">*</span> <span class="n">n_quadrature_per_tri_facet</span><span class="p">]</span>
            <span class="n">quad_j</span><span class="o">=</span> <span class="n">j</span><span class="p">[:,</span> <span class="n">n_tri_facet</span> <span class="o">*</span> <span class="n">n_quadrature_per_tri_facet</span><span class="p">:]</span>
            <span class="n">tri_j</span> <span class="o">=</span> <span class="n">tri_j</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_tri_facet</span><span class="p">,</span> <span class="n">n_quadrature_per_tri_facet</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
            <span class="n">quad_j</span><span class="o">=</span> <span class="n">quad_j</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_quad_facet</span><span class="p">,</span> <span class="n">n_quadrature_per_quad_facet</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tri_j</span><span class="p">,</span> <span class="n">quad_j</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">w</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">quadrature_order</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span> 
            <span class="n">n_facet</span><span class="p">,</span> <span class="n">n_quadrature_per_facet</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">q</span>    <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
            <span class="n">j</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eval_cell_jacobian</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">element_coords</span><span class="p">,</span> <span class="n">basis_order</span><span class="p">)</span> <span class="c1"># [n_element, n_facet*n_quadrature_per_facet, dim, dim]</span>
            <span class="k">return</span> <span class="n">j</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_facet</span><span class="p">,</span> <span class="n">n_quadrature_per_facet</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span></div>


<div class="viewcode-block" id="Element.eval_facet_jacobian">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.eval_facet_jacobian">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span> <span class="nf">eval_facet_jacobian</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                            <span class="n">element_coords</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> 
                            <span class="n">basis_order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">quadrature_order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="p">)</span><span class="o">-&gt;</span><span class="n">Union</span><span class="p">[</span><span class="n">Tensorx1</span><span class="p">,</span><span class="n">Tensorx2</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Evaluate the Jacobian mapping from reference facet coordinates to physical coordinates.</span>

<span class="sd">        For each facet of the element, computes the Jacobian matrix that maps from local facet </span>
<span class="sd">        coordinates to global physical coordinates.</span>

<span class="sd">        The facet Jacobian is used to:</span>

<span class="sd">        * Transform integrals over facets from reference to physical space:</span>
<span class="sd">          </span>
<span class="sd">          .. math::</span>
<span class="sd">             </span>
<span class="sd">             \int_F f(\mathbf{x}) \,ds = \int_{\hat{F}} f(\mathbf{x}(\boldsymbol{\xi})) \|\mathbf{J}\mathbf{t}\| \,d\boldsymbol{\xi}</span>

<span class="sd">        * Compute geometric quantities like normal vectors and surface measures</span>
<span class="sd">        * Map derivatives between reference facet and physical coordinates:</span>

<span class="sd">          .. math::</span>
<span class="sd">             </span>
<span class="sd">             \nabla_{\mathbf{x}} = \mathbf{J}^{-T} \nabla_{\boldsymbol{\xi}}</span>

<span class="sd">        where :math:`\mathbf{t}` is a tangent vector to the facet.</span>

<span class="sd">        For mixed elements like pyramids that have both triangular and quadrilateral facets,</span>
<span class="sd">        returns separate Jacobians for each facet type.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        .. code-block:: python</span>

<span class="sd">            # Create a triangle element</span>
<span class="sd">            element_coords = torch.tensor([[[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]])</span>
<span class="sd">            # Evaluate facet Jacobian with linear basis and 2nd order quadrature </span>
<span class="sd">            facet_jacobian = Triangle.eval_facet_jacobian(element_coords,</span>
<span class="sd">                                                        basis_order=1,</span>
<span class="sd">                                                        quadrature_order=2)</span>
<span class="sd">            facet_jacobian.shape  # torch.Size([1, 3, 2, 1, 2])</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        element_coords : torch.Tensor :math:`[N_e, N_b, D]`</span>
<span class="sd">            Boundary element coordinates, where :math:`N_e` = number of elements, :math:`N_b` = number of basis functions, :math:`D` = spatial dimension</span>
<span class="sd">        basis_order : int</span>
<span class="sd">            The order of the basis</span>
<span class="sd">        quadrature_order : int</span>
<span class="sd">            The order of quadrature rule to use</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        facet_jacobian : torch.Tensor</span>
<span class="sd">            5D tensor of shape :math:`[N_e, N_f, N_q, D-1, D]`, where</span>
<span class="sd">            </span>
<span class="sd">            * :math:`N_e` = number of elements</span>
<span class="sd">            * :math:`N_f` = number of facets  </span>
<span class="sd">            * :math:`N_q` = quadrature points per facet</span>
<span class="sd">            * :math:`D` = spatial dimension</span>
<span class="sd">        or</span>
<span class="sd">        tri_facet_jacobian, quad_facet_jacobian, tri_mask : Tuple[torch.Tensor, torch.Tensor, torch.Tensor]</span>
<span class="sd">            5D tensor of shape :math:`[N_e, N_{tf}, N_{tq}, D-1, D]`,</span>
<span class="sd">            D tensor of shape :math:`[N_e, N_{qf}, N_{qq}, D-1, D]`</span>
<span class="sd">            , where</span>
<span class="sd">            </span>
<span class="sd">            * :math:`N_e` = number of elements</span>
<span class="sd">            * :math:`N_{tf}` = number of triangular facets  </span>
<span class="sd">            * :math:`N_{tq}` = quadrature points per triangular facet</span>
<span class="sd">            * :math:`D` = spatial dimension</span>

<span class="sd">            Boolean mask indicating which facets are triangular</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dtype</span> <span class="o">=</span> <span class="n">element_coords</span><span class="o">.</span><span class="n">dtype</span>
        <span class="n">device</span><span class="o">=</span> <span class="n">element_coords</span><span class="o">.</span><span class="n">device</span>
  
        <span class="n">facet_quadrature_orig</span>     <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">quadrature_order</span><span class="p">,</span> 
                                                             <span class="n">transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                                             <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> 
                                                             <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span> 

        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">is_mix_facet</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">facet_quadrature_orig</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>

            <span class="n">tri_j</span><span class="p">,</span> <span class="n">quad_j</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eval_facet_cell_jacobian</span><span class="p">(</span><span class="n">element_coords</span><span class="p">,</span> <span class="n">basis_order</span><span class="p">,</span> <span class="n">quadrature_order</span><span class="p">)</span>

            <span class="n">facet_mapping_grad_fns</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_local_facet_mapping_grad_fns</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span> <span class="c1"># Polynomials [dim-1(gradient), n_facet, dim(global_coords)] n_vars=dim-1 n_terms = dim</span>

            <span class="n">tri_mask</span>  <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_tri_mask</span><span class="p">()</span> <span class="c1"># [n_facet]</span>

            <span class="n">tri_facet_mapping_grad_fns</span> <span class="o">=</span> <span class="n">facet_mapping_grad_fns</span><span class="p">[:,</span> <span class="n">tri_mask</span><span class="p">]</span>   <span class="c1"># Polynomials [dim-1(gradient), n_tri_facet, dim(global_coords)] n_vars=dim-1 n_terms = dim</span>
            <span class="n">quad_facet_mapping_grad_fns</span><span class="o">=</span> <span class="n">facet_mapping_grad_fns</span><span class="p">[:,</span> <span class="o">~</span><span class="n">tri_mask</span><span class="p">]</span>  <span class="c1"># Polynomials [dim-1(gradient), n_quad_facet, dim(global_coords)] n_vars=dim-1 n_terms = dim</span>

            <span class="n">n_tri_facet</span> <span class="o">=</span> <span class="n">tri_facet_mapping_grad_fns</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">n_quad_facet</span><span class="o">=</span> <span class="n">quad_facet_mapping_grad_fns</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tri_facet_mapping_grad_fns</span><span class="p">,</span> <span class="n">Polynomials</span><span class="p">)</span> <span class="ow">and</span> <span class="n">tri_facet_mapping_grad_fns</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_tri_facet</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span> 
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quad_facet_mapping_grad_fns</span><span class="p">,</span> <span class="n">Polynomials</span><span class="p">)</span> <span class="ow">and</span> <span class="n">quad_facet_mapping_grad_fns</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_quad_facet</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>

            <span class="n">tri_w</span><span class="p">,</span> <span class="n">tri_q</span><span class="p">,</span><span class="n">quad_w</span><span class="p">,</span> <span class="n">quad_q</span> <span class="o">=</span> <span class="n">facet_quadrature_orig</span> 
            <span class="c1"># triw, triq [n_quadrature_per_tri_facet] [n_quadrature_per_tri_facet, dim-1]</span>

            <span class="n">tri_facet_mapping_grad</span> <span class="o">=</span> <span class="n">tri_facet_mapping_grad_fns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tri_q</span><span class="p">)</span>  <span class="c1"># [n_quadrature_per_tri_face,  dim-1(gradient), n_tri_facet, dim(global_coords)]</span>
            <span class="n">quad_facet_mapping_grad</span><span class="o">=</span> <span class="n">quad_facet_mapping_grad_fns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">quad_q</span><span class="p">)</span><span class="c1"># [n_quadrature_per_quad_face, dim-1(gradient), n_quad_facet, dim(global_coords)]</span>

            <span class="n">tri_facet_mapping_grad</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;efqij, qgfi-&gt; efqgj&quot;</span><span class="p">,</span><span class="n">tri_j</span><span class="p">,</span> <span class="n">tri_facet_mapping_grad</span><span class="p">)</span>   <span class="c1">#[n_element, n_tri_facet, n_quadrature_per_tri_face, dim-1(gradient), dim(global_coords)]</span>
            <span class="n">quad_facet_mapping_grad</span><span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;efqij, qgfi-&gt; efqgj&quot;</span><span class="p">,</span><span class="n">quad_j</span><span class="p">,</span> <span class="n">quad_facet_mapping_grad</span><span class="p">)</span> <span class="c1">#[n_element, n_quad_facet, n_quadrature_per_quad_face, dim-1(gradient), dim(global_coords)]</span>

            <span class="k">return</span> <span class="n">tri_facet_mapping_grad</span><span class="p">,</span> <span class="n">quad_facet_mapping_grad</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">facet_quadrature_orig</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
            <span class="n">w</span><span class="p">,</span> <span class="n">q</span>                   <span class="o">=</span> <span class="n">facet_quadrature_orig</span>
    
            <span class="n">j</span>                      <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eval_facet_cell_jacobian</span><span class="p">(</span><span class="n">element_coords</span><span class="p">,</span> <span class="n">basis_order</span><span class="p">,</span> <span class="n">quadrature_order</span><span class="p">)</span>

            <span class="n">facet_mapping_grad_fns</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_local_facet_mapping_grad_fns</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>        <span class="c1"># PolynomialTensor [dim-1(gradient), n_facet, dim(global_coords)] n_vars=dim-1 n_terms = dim</span>
            <span class="n">facet_mapping_grad</span>     <span class="o">=</span> <span class="n">facet_mapping_grad_fns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1"># [n_quadrature_per_face, dim-1(gradient), n_facet, dim(global_coords)]</span>
            <span class="n">facet_mapping_grad</span>     <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;efqij, qkfi-&gt; efqkj&quot;</span><span class="p">,</span><span class="n">j</span><span class="p">,</span> <span class="n">facet_mapping_grad</span><span class="p">)</span> <span class="c1">#[n_element, n_facet, n_quadrature_per_face, dim-1(gradient), dim(global_coords)]</span>

            <span class="k">return</span> <span class="n">facet_mapping_grad</span></div>


<div class="viewcode-block" id="Element.element_to_facet">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.element_to_facet">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">element_to_facet</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                         <span class="n">elements</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
                         <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
                         <span class="p">)</span><span class="o">-&gt;</span><span class="n">Union</span><span class="p">[</span><span class="n">Tensorx1</span><span class="p">,</span><span class="n">Tensorx2</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Maps element basis functions to facet basis functions.</span>

<span class="sd">        For each facet of an element, extracts the subset of element basis functions that are active on that facet.</span>

<span class="sd">        For mixed elements with both triangular and quadrilateral facets, returns separate tensors for each facet type.</span>

<span class="sd">        For example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            # Hexahedral element (order=1)</span>
<span class="sd">            hex_element = torch.randn(8)  # 8 basis functions</span>
<span class="sd">            hex_facets = element_to_facet(hex_element, order=1)  # [6, 4] tensor</span>
<span class="sd">            </span>
<span class="sd">            # Tetrahedral element (order=2)</span>
<span class="sd">            tet_element = torch.randn(10)  # 10 basis functions</span>
<span class="sd">            tet_facets = element_to_facet(tet_element, order=2)  # [4, 6] tensor</span>
<span class="sd">            </span>
<span class="sd">            # Wedge element (order=2)</span>
<span class="sd">            wedge_element = torch.randn(18)  # 18 basis functions</span>
<span class="sd">            tri_facets, quad_facets = element_to_facet(wedge_element, order=2)</span>
<span class="sd">            # tri_facets: [2, 6] tensor for triangular faces</span>
<span class="sd">            # quad_facets: [3, 9] tensor for quadrilateral faces</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        elements : torch.Tensor</span>
<span class="sd">            2D tensor of shape :math:`[N_e, N_b]` containing element basis function values</span>
<span class="sd">            or 1D tensor of shape :math:`[N_b]` for a single element,</span>
<span class="sd">            where:</span>

<span class="sd">            - :math:`N_e` = number of elements</span>
<span class="sd">            - :math:`N_b` = number of basis functions</span>

<span class="sd">        order : int</span>
<span class="sd">            Order of the basis functions</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        If is_mix_facet is True</span>


<span class="sd">        tri_facet : torch.Tensor </span>
<span class="sd">            3D tensor of shape :math:`[N_e, N_{tf}, N_{tb}]` for multiple elements</span>
<span class="sd">            or 2D tensor of shape :math:`[N_{tf}, N_{tb}]` for single element,</span>
<span class="sd">            where</span>

<span class="sd">            - :math:`N_e` = number of elements</span>
<span class="sd">            - :math:`N_{tf}` = number of triangular facets</span>
<span class="sd">            - :math:`N_{tb}` = number of basis functions per triangular facet</span>

<span class="sd">        quad_facet : torch.Tensor</span>
<span class="sd">            3D tensor of shape :math:`[N_e, N_{qf}, N_{qb}]` for multiple elements</span>
<span class="sd">            or 2D tensor of shape :math:`[N_{qf}, N_{qb}]` for single element,</span>
<span class="sd">            where</span>

<span class="sd">            - :math:`N_e` = number of elements</span>
<span class="sd">            - :math:`N_{qf}` = number of quadrilateral facets</span>
<span class="sd">            - :math:`N_{qb}` = number of basis functions per quadrilateral facet</span>

<span class="sd">        If is_mix_facet is False</span>


<span class="sd">        facet : torch.Tensor</span>
<span class="sd">            3D tensor of shape :math:`[N_e, N_f, N_b]` for multiple elements</span>
<span class="sd">            or 2D tensor of shape :math:`[N_f, N_b]` for single element,</span>
<span class="sd">            where</span>

<span class="sd">            - :math:`N_e` = number of elements</span>
<span class="sd">            - :math:`N_f` = number of facets</span>
<span class="sd">            - :math:`N_b` = number of basis functions per facet</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">elements</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_n_basis</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
        

        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">is_mix_facet</span><span class="p">:</span>
            <span class="n">tri_facet</span><span class="p">,</span> <span class="n">quad_facet</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
            <span class="n">tri_facet</span>  <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">tri_facet</span><span class="p">]</span> <span class="c1"># [n_element, n_tri_facet, n_basis_per_tri_facet]</span>
            <span class="n">quad_facet</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">quad_facet</span><span class="p">]</span><span class="c1"># [n_element, n_quad_facet, n_basis_per_quad_facet]</span>
            <span class="k">return</span> <span class="n">tri_facet</span><span class="p">,</span> <span class="n">quad_facet</span>
        
        <span class="k">else</span><span class="p">:</span> <span class="c1"># facet of the same shape </span>
            <span class="n">facet</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="c1"># [n_facet, n_basis_per_facet]</span>
            <span class="k">return</span> <span class="n">elements</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">facet</span><span class="p">]</span></div>


<div class="viewcode-block" id="Element.element_to_edge">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.element_to_edge">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">element_to_edge</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                         <span class="n">elements</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
                         <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
                         <span class="n">unique</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx1</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract edge values from element values.</span>

<span class="sd">        Maps element basis function values to edge basis function values using the edge connectivity.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        elements : torch.Tensor</span>
<span class="sd">            ND tensor of shape [..., N_b] containing basis function values,</span>
<span class="sd">            where N_b is the number of basis functions. The leading dimensions</span>
<span class="sd">            can be arbitrary (e.g., batch dimensions).</span>

<span class="sd">        order : int</span>
<span class="sd">            Order of the basis functions</span>
<span class="sd">        </span>
<span class="sd">        unique : bool, optional</span>
<span class="sd">            If True, returns only unique edges after sorting edge values.</span>
<span class="sd">            If False, returns all edges including duplicates.</span>
<span class="sd">            Default is True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        edge : torch.Tensor</span>
<span class="sd">            (N+1)D tensor of shape [..., N_ed, N_eb] containing edge basis function values,</span>
<span class="sd">            where:</span>

<span class="sd">            - [...] = input tensor&#39;s leading dimensions</span>
<span class="sd">            - N_ed = number of edges</span>
<span class="sd">            - N_eb = number of basis functions per edge</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">elements</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_n_basis</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>

        <span class="n">edges</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_edge</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="c1"># [n_edge, 2]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">edges</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># [n_all_edges, 2]</span>
        
        <span class="k">if</span> <span class="n">unique</span><span class="p">:</span>
            
            <span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        
            <span class="n">edges</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
          
        <span class="k">return</span> <span class="n">edges</span></div>

        

<div class="viewcode-block" id="Element.get_tri_mask">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_tri_mask">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_tri_mask</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a boolean mask indicating which faces are triangular.</span>

<span class="sd">        For elements with mixed face types (triangular and quadrilateral faces), returns a boolean tensor </span>
<span class="sd">        marking which faces are triangular (True) vs quadrilateral (False).</span>

<span class="sd">        The mask has length equal to the total number of faces and True values for each triangular face.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For a prism element with 2 triangular faces and 3 quadrilateral faces:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            &gt;&gt;&gt; Element.get_tri_mask()</span>
<span class="sd">            tensor([True, True, False, False, False])</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tri_mask: torch.Tensor </span>
<span class="sd">            1D boolean Tensor of shape :math:`[N_f]` where :math:`N_f` = number of facets</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">cls</span><span class="o">.</span><span class="n">is_mix_facet</span> 
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">face</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">])</span></div>


<div class="viewcode-block" id="Element.get_quad_mask">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_quad_mask">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_quad_mask</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a boolean mask indicating which faces are quadrilateral.</span>

<span class="sd">        For elements with mixed face types (triangular and quadrilateral faces), returns a boolean tensor</span>
<span class="sd">        marking which faces are quadrilateral (True) vs triangular (False).</span>

<span class="sd">        The mask has length equal to the total number of faces and True values for each quadrilateral face.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For a prism element with 2 triangular faces and 3 quadrilateral faces:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            &gt;&gt;&gt; Element.get_quad_mask()</span>
<span class="sd">            tensor([False, False, True, True, True])</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        quad_mask: torch.Tensor </span>
<span class="sd">            1D boolean Tensor of shape :math:`[N_f]` where :math:`N_f` = number of facets</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">cls</span><span class="o">.</span><span class="n">is_mix_facet</span> 
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">face</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">])</span></div>


<div class="viewcode-block" id="Element.get_contour">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Element.get_contour">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_contour</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the contour points for a 2D element at the specified order.</span>

<span class="sd">        For a 2D element, returns points along the element boundary at the given polynomial order.</span>
<span class="sd">        The points are ordered counterclockwise around the boundary.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Get contour points for a quadrilateral at order 2:</span>

<span class="sd">        &gt;&gt;&gt; quad = Quadrilateral()</span>
<span class="sd">        &gt;&gt;&gt; contour = quad.get_contour(2)</span>
<span class="sd">        &gt;&gt;&gt; contour.shape</span>
<span class="sd">        torch.Size([8, 2])</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order : int</span>
<span class="sd">            The polynomial order. Must be &gt;= 1.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        contour : torch.Tensor</span>
<span class="sd">            Tensor of shape :math:`[N_p, 2]` containing the :math:`(x,y)` coordinates of points </span>
<span class="sd">            along the element boundary, ordered counterclockwise, where :math:`N_p` = number of points.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - Only implemented for 2D elements (dim=2)</span>
<span class="sd">        - Points are distributed according to the polynomial order</span>
<span class="sd">        - Points are ordered counterclockwise starting from the first vertex</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">order</span> <span class="o">&gt;=</span> <span class="mi">1</span>
        <span class="k">assert</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Only 2d elements has contour, but got </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">dim</span><span class="si">}</span><span class="s2">d element&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>
</div>

        

<div class="viewcode-block" id="Line">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Line">[docs]</a>
<span class="k">class</span> <span class="nc">Line</span><span class="p">(</span><span class="n">Element</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">]])</span> <span class="c1"># 2x1</span>
    <span class="n">vertex</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="c1"># 2x1</span>
    <span class="n">edge</span>   <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span> <span class="c1"># 1x2</span>
    <span class="n">dim</span>    <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n_vertex</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_edge</span>   <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_face</span>   <span class="o">=</span> <span class="mi">0</span>
    <span class="n">n_cell</span>   <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="Line.get_basis">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Line.get_basis">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">Element</span><span class="o">.</span><span class="n">get_basis</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_basis</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                  <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                  <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                    <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">lin_basis</span><span class="p">(</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> 
                <span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span></div>


<div class="viewcode-block" id="Line.get_polynomial">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Line.get_polynomial">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">Element</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_polynomial</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Polynomial</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">tens_exp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>


<div class="viewcode-block" id="Line.get_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Line.get_quadrature">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">Element</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">lin_quadrature</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="Triangle">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Triangle">[docs]</a>
<span class="k">class</span> <span class="nc">Triangle</span><span class="p">(</span><span class="n">Element</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span> <span class="c1"># 3x2</span>
    <span class="n">vertex</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span> <span class="c1"># 3x1</span>
    <span class="n">edge</span>   <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span> <span class="c1"># 3x2</span>
    <span class="n">face</span>   <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),)</span> <span class="c1"># 1x3</span>
    <span class="n">dim</span>    <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n_vertex</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_edge</span>   <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_face</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
    <span class="n">n_cell</span>   <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="Triangle.get_basis">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_basis">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_basis</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                  <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                  <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                  <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                  <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tri_basis</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> 
                         <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">),</span> 
                         <span class="n">order</span>
                         <span class="p">)</span></div>


<div class="viewcode-block" id="Triangle.get_polynomial">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_polynomial">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_polynomial</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Polynomial</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">poly_exp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Triangle.get_facet">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_facet">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_facet</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx1</span><span class="p">:</span>
        <span class="n">facet</span> <span class="o">=</span> <span class="n">facet_basis_index_2d</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">facet</span></div>


<div class="viewcode-block" id="Triangle.get_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_quadrature">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span> 
    <span class="k">def</span> <span class="nf">get_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tri_quadrature</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>


<div class="viewcode-block" id="Triangle.get_facet_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_facet_quadrature">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_facet_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                             <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                             <span class="n">transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                             <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                             <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                             <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">facet_quadrature_2d</span><span class="p">(</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">get_local_facet_mapping_fns</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">),</span> 
                    <span class="n">order</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="Triangle.get_facet_type">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_facet_type">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span> <span class="nf">get_facet_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">Line</span></div>

    
<div class="viewcode-block" id="Triangle.get_contour">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Triangle.get_contour">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_contour</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">order</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">facet</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="c1"># [n_facet, n_basis_per_facet]</span>
            <span class="n">facet</span> <span class="o">=</span> <span class="n">facet</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span> <span class="c1"># facet without boundaries</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
                <span class="n">facet</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">facet</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">]),</span>
                <span class="n">facet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">flip</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
            <span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid order </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="Quadrilateral">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral">[docs]</a>
<span class="k">class</span> <span class="nc">Quadrilateral</span><span class="p">(</span><span class="n">Element</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span> <span class="c1"># 4x2</span>
    <span class="n">vertex</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span> <span class="c1"># 4x1</span>
    <span class="n">edge</span>   <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span> <span class="c1"># 4x2</span>
    <span class="n">face</span>   <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),)</span> <span class="c1"># 1x4</span>
    <span class="n">dim</span>    <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n_vertex</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_edge</span>   <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_face</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
    <span class="n">n_cell</span>   <span class="o">=</span> <span class="mi">0</span>

   
<div class="viewcode-block" id="Quadrilateral.get_basis">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_basis">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_basis</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                  <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                  <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                  <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                  <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">quad_basis</span><span class="p">(</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> 
                    <span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> 
                    <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> 
                    <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">),</span> 
                    <span class="n">order</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Quadrilateral.get_polynomial">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_polynomial">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_polynomial</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Polynomial</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">tens_exp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>


<div class="viewcode-block" id="Quadrilateral.get_facet">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_facet">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_facet</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">facet</span> <span class="o">=</span> <span class="n">facet_basis_index_2d</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">facet</span></div>


<div class="viewcode-block" id="Quadrilateral.get_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_quadrature">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> 
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">quad_quadrature</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>

       
<div class="viewcode-block" id="Quadrilateral.get_facet_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_facet_quadrature">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_facet_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>  
                             <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                             <span class="n">transform</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
                             <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                             <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                             <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">facet_quadrature_2d</span><span class="p">(</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">get_local_facet_mapping_fns</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">),</span> 
                <span class="n">order</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span></div>


<div class="viewcode-block" id="Quadrilateral.get_facet_type">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_facet_type">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span> <span class="nf">get_facet_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">Line</span></div>

    
<div class="viewcode-block" id="Quadrilateral.get_coutour">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Quadrilateral.get_coutour">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_coutour</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">order</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">facet</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="c1"># [n_facet, n_basis_per_facet]</span>
            <span class="n">facet</span> <span class="o">=</span> <span class="n">facet</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span> <span class="c1"># facet without boundaries</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
                <span class="n">facet</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">facet</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">3</span><span class="p">]),</span>
                <span class="n">facet</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">flip</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">]),</span>
                <span class="n">facet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">flip</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
            <span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid order </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="Tetrahedron">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron">[docs]</a>
<span class="k">class</span> <span class="nc">Tetrahedron</span><span class="p">(</span><span class="n">Element</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span> <span class="c1"># 4x3</span>
    <span class="n">vertex</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span> <span class="c1"># 4x1</span>
    <span class="n">edge</span>   <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span> <span class="c1"># 6x2</span>
    <span class="n">face</span>   <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="c1"># 4x3</span>
    <span class="n">cell</span>   <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span> <span class="c1"># 1x4</span>
    <span class="n">dim</span>    <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n_vertex</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_edge</span>   <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_face</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
    <span class="n">n_cell</span>   <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<div class="viewcode-block" id="Tetrahedron.get_basis">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.get_basis">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">Element</span><span class="o">.</span><span class="n">get_basis</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_basis</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                  <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                  <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                  <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                  <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tet_basis</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> 
                         <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">),</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">cell</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                         <span class="n">order</span><span class="p">)</span></div>


<div class="viewcode-block" id="Tetrahedron.get_polynomial">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.get_polynomial">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span> 
    <span class="k">def</span> <span class="nf">get_polynomial</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                        <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                        <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                        <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Polynomial</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">poly_exp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Tetrahedron.get_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.get_quadrature">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span> 
    <span class="k">def</span> <span class="nf">get_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                        <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                        <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                        <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>

       
<div class="viewcode-block" id="Tetrahedron.get_facet">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.get_facet">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_facet</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensorx1</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">tet_facet_basis_index</span><span class="p">(</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> 
            <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> 
            <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">),</span> 
            <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">index</span></div>

    
<div class="viewcode-block" id="Tetrahedron.get_facet_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.get_facet_quadrature">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_facet_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                                <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                                <span class="n">transform</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
                                <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>  
                                <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                             <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tet_facet_quadrature</span><span class="p">(</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">get_local_facet_mapping_fns</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">),</span> 
                    <span class="n">order</span><span class="p">,</span> 
                    <span class="n">transform</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Tetrahedron.get_facet_type">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Tetrahedron.get_facet_type">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span> <span class="nf">get_facet_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">Triangle</span></div>
</div>


<div class="viewcode-block" id="Hexahedron">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron">[docs]</a>
<span class="k">class</span> <span class="nc">Hexahedron</span><span class="p">(</span><span class="n">Element</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span> <span class="c1"># 8x3</span>
    <span class="n">vertex</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">]])</span> <span class="c1"># 8x1</span>
    <span class="n">edge</span>   <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span> <span class="c1"># 12x2</span>
    <span class="n">face</span>   <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span> <span class="c1"># 6x4</span>
    <span class="n">cell</span>   <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span> <span class="c1"># 1x8</span>
    <span class="n">dim</span>    <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n_vertex</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_edge</span>   <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_face</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
    <span class="n">n_cell</span>   <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<div class="viewcode-block" id="Hexahedron.get_basis">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.get_basis">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_basis</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                  <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                  <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                  <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                  <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hex_basis</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span>
                         <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">),</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">cell</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                         <span class="n">order</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Hexahedron.get_polynomial">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.get_polynomial">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span> 
    <span class="k">def</span> <span class="nf">get_polynomial</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Polynomial</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">tens_exp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="Hexahedron.get_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.get_quadrature">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                        <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                        <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                        <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hex_quadrature</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span> </div>

       
<div class="viewcode-block" id="Hexahedron.get_facet">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.get_facet">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_facet</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx1</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">hex_facet_basis_index</span><span class="p">(</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> 
                    <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> 
                    <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">),</span> 
                    <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">index</span></div>


<div class="viewcode-block" id="Hexahedron.get_facet_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.get_facet_quadrature">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_facet_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                             <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                             <span class="n">transform</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                             <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                             <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                             <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hex_facet_quadrature</span><span class="p">(</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">get_local_facet_mapping_fns</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">),</span> 
            <span class="n">order</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="Hexahedron.get_facet_type">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Hexahedron.get_facet_type">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span> <span class="nf">get_facet_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">Quadrilateral</span></div>
</div>


<div class="viewcode-block" id="Pyramid">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid">[docs]</a>
<span class="k">class</span> <span class="nc">Pyramid</span><span class="p">(</span><span class="n">Element</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span> <span class="c1"># 5x3</span>
    <span class="n">vertex</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]])</span> <span class="c1"># 5x1</span>
    <span class="n">edge</span>   <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span> <span class="c1"># 8x2</span>
    <span class="n">face</span>   <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="c1"># 5x4</span>
    <span class="n">cell</span>   <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span> <span class="c1"># 1x5</span>
    <span class="n">dim</span>    <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n_vertex</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_edge</span>   <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_face</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
    <span class="n">n_cell</span>   <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">is_mix_facet</span> <span class="o">=</span> <span class="kc">True</span>
   
<div class="viewcode-block" id="Pyramid.get_basis">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.get_basis">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_basis</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                  <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                  <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                  <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                  <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pyr_basis</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">,</span> <span class="c1"># type: ignore</span>
                         <span class="bp">cls</span><span class="o">.</span><span class="n">cell</span><span class="p">,</span> <span class="c1"># type: ignore</span>
                         <span class="n">order</span><span class="p">)</span> </div>


<div class="viewcode-block" id="Pyramid.get_polynomial">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.get_polynomial">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_polynomial</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>  
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Polynomial</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">pyr_exp</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pyramid.get_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.get_quadrature">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                        <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                        <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> 
                        <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pyr_quadrature</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>

       
<div class="viewcode-block" id="Pyramid.get_facet">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.get_facet">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span> 
    <span class="k">def</span> <span class="nf">get_facet</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">tri_facet</span><span class="p">,</span> <span class="n">quad_facet</span> <span class="o">=</span> <span class="n">mix_facet_basis_index</span><span class="p">(</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> 
                    <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> 
                    <span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">,</span> 
                    <span class="n">order</span><span class="p">)</span> <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="n">tri_facet</span><span class="p">,</span> <span class="n">quad_facet</span></div>


<div class="viewcode-block" id="Pyramid.get_facet_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.get_facet_quadrature">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_facet_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                             <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                             <span class="n">transform</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                             <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                             <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                             <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx4</span><span class="p">:</span>
        <span class="n">tri_w</span><span class="p">,</span> <span class="n">tri_q</span><span class="p">,</span>\
        <span class="n">quad_w</span><span class="p">,</span><span class="n">quad_q</span> <span class="o">=</span> <span class="n">mix_facet_quadrature_3d</span><span class="p">(</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">get_local_facet_mapping_fns</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">),</span> 
                    <span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">tri_w</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">),</span> 
                <span class="n">tri_q</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">),</span> 
                <span class="n">quad_w</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">),</span> 
                <span class="n">quad_q</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">))</span></div>


<div class="viewcode-block" id="Pyramid.get_facet_type">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Pyramid.get_facet_type">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span> <span class="nf">get_facet_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">],</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span></div>
</div>


<div class="viewcode-block" id="Prism">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Prism">[docs]</a>
<span class="k">class</span> <span class="nc">Prism</span><span class="p">(</span><span class="n">Element</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span> <span class="c1"># 5x3</span>
    <span class="n">vertex</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">]])</span> <span class="c1"># 6x1</span>
    <span class="n">edge</span>   <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span> <span class="c1"># 9x2</span>
    <span class="n">face</span>   <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># 4x4</span>
    <span class="n">cell</span>   <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span> <span class="c1"># 1x5</span>
    <span class="n">dim</span>    <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n_vertex</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_edge</span>   <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_face</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
    <span class="n">n_cell</span>   <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">is_mix_facet</span> <span class="o">=</span> <span class="kc">True</span>
 
<div class="viewcode-block" id="Prism.get_basis">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Prism.get_basis">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_basis</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                  <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                  <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> 
                  <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                  <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pri_basis</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> 
                         <span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                         <span class="bp">cls</span><span class="o">.</span><span class="n">cell</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                         <span class="n">order</span><span class="p">)</span></div>


<div class="viewcode-block" id="Prism.get_polynomial">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Prism.get_polynomial">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span> 
    <span class="k">def</span> <span class="nf">get_polynomial</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>  
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Polynomial</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">pri_exp</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>

   
<div class="viewcode-block" id="Prism.get_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Prism.get_quadrature">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                       <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                       <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                       <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                       <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pri_quadrature</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></div>

       
<div class="viewcode-block" id="Prism.get_facet">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Prism.get_facet">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_facet</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx2</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">tri_facet</span><span class="p">,</span> <span class="n">quad_facet</span> <span class="o">=</span> <span class="n">mix_facet_basis_index</span><span class="p">(</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> 
                    <span class="bp">cls</span><span class="o">.</span><span class="n">edge</span><span class="p">,</span> 
                    <span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">,</span> 
                    <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tri_facet</span><span class="p">,</span> <span class="n">quad_facet</span></div>


<div class="viewcode-block" id="Prism.get_facet_quadrature">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Prism.get_facet_quadrature">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="nd">@lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_facet_quadrature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                             <span class="n">order</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                             <span class="n">transform</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                             <span class="n">dtype</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                             <span class="n">device</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
                             <span class="p">)</span><span class="o">-&gt;</span><span class="n">Tensorx4</span><span class="p">:</span>
        <span class="n">tri_w</span><span class="p">,</span> <span class="n">tri_q</span><span class="p">,</span>\
        <span class="n">quad_w</span><span class="p">,</span><span class="n">quad_q</span> <span class="o">=</span> <span class="n">mix_facet_quadrature_3d</span><span class="p">(</span>
                            <span class="bp">cls</span><span class="o">.</span><span class="n">get_local_facet_mapping_fns</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="p">),</span> 
                            <span class="bp">cls</span><span class="o">.</span><span class="n">face</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">tri_w</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">),</span> 
                <span class="n">tri_q</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">),</span> 
                <span class="n">quad_w</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">),</span> 
                <span class="n">quad_q</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">dtype</span><span class="p">))</span></div>

    
<div class="viewcode-block" id="Prism.get_facet_type">
<a class="viewcode-back" href="../../../api_reference/element.html#tensormesh.element.element.Prism.get_facet_type">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span> <span class="nf">get_facet_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">],</span><span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span></div>
</div>





</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, walkerchi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>