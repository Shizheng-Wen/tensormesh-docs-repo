<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tensormesh.element &mdash; tensormesh  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/mytheme.css?v=e73ece32" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css" />

  
    <link rel="shortcut icon" href="https://raw.githubusercontent.com/walkerchi/tensormesh_sphinx_theme/master/tensormesh_sphinx_theme/static/img/tensormesh_logo.webp"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9bcbadda"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tensormesh.assemble" href="assemble.html" />
    <link rel="prev" title="tensormesh.mesh" href="mesh.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="https://raw.githubusercontent.com/walkerchi/tensormesh_sphinx_theme/master/tensormesh_sphinx_theme/static/img/tensormesh_logo.webp" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_started/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../get_started/installation.html#installatoion-via-pypi">Installatoion via PyPi</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/benchmark.html">Benchmark</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../get_started/benchmark.html#m2-pro-cpu">M2 Pro CPU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/benchmark.html#assemble-speed">Assemble Speed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/benchmark.html#pipeline-speed">Pipeline Speed</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/element.html">Basis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../get_started/element.html#line">Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/element.html#triangle">Triangle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/element.html#quadrilateral">Quadrilateral</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/element.html#tetrahedron">Tetrahedron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/element.html#hexahedron">Hexahedron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/element.html#pyramid">Pyramid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started/element.html#prism">Prism</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/mesh_gen.html">Mesh Generation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/mesh_gen.html#d-high-order-mesh">2D high order mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/mesh_gen.html#d-high-circle-mesh">2D high circle mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/mesh_gen.html#d-hybrid-mesh">2D hybrid mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/mesh_gen.html#id1">3D high order mesh</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/adjacency.html">Adjacency</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/adjacency.html#d-node-adjacency">2D Node Adjacency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/adjacency.html#d-element-adjacency">2D Element Adjacency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/adjacency.html#id1">3D Node Adjacency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/adjacency.html#id2">3D Element Adjacency</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/basis.html">Basis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/basis.html#d-line-basis">1D Line Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/basis.html#d-triangle-basis">2D Triangle Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/basis.html#d-quadrilateral-basis">2D Quadrilateral Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/basis.html#d-tetrahedron-basis">3D Tetrahedron Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/basis.html#d-hexahedron-basis">3D Hexahedron Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/basis.html#d-pyramid-basis">3D Pyramid Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/basis.html#d-prism-basis">3D Prism Basis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/values.html">Plot values</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/values.html#d-point-value">2D Point Value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/values.html#d-element-value">2D Element Value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/values.html#id1">3D Point Value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/values.html#id2">3D Element Value</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/poisson.html">Poisson Equation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/poisson.html#adaptive-mesh-refinement">Adaptive Mesh Refinement</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/wave.html">Wave Equation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/wave.html#multi-frequency-dataset">multi frequency dataset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/linear_elasticity.html">Linear Elasticity</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/linear_elasticity.html#pressed-hollow-rectangle">Pressed Hollow Rectangle</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dataset.html">tensormesh.dataset</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dataset.html#mesh">Mesh</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dataset.html#tensormesh.dataset.mesh.MeshGen"><code class="docutils literal notranslate"><span class="pre">MeshGen</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.mesh.MeshGen.__init__"><code class="docutils literal notranslate"><span class="pre">MeshGen.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.mesh.MeshGen.add_rectangle"><code class="docutils literal notranslate"><span class="pre">MeshGen.add_rectangle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.mesh.MeshGen.remove_rectangle"><code class="docutils literal notranslate"><span class="pre">MeshGen.remove_rectangle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.mesh.MeshGen.add_circle"><code class="docutils literal notranslate"><span class="pre">MeshGen.add_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.mesh.MeshGen.remove_circle"><code class="docutils literal notranslate"><span class="pre">MeshGen.remove_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.mesh.MeshGen.add_cube"><code class="docutils literal notranslate"><span class="pre">MeshGen.add_cube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.mesh.MeshGen.remove_cube"><code class="docutils literal notranslate"><span class="pre">MeshGen.remove_cube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.mesh.MeshGen.add_sphere"><code class="docutils literal notranslate"><span class="pre">MeshGen.add_sphere()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.mesh.MeshGen.remove_sphere"><code class="docutils literal notranslate"><span class="pre">MeshGen.remove_sphere()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.mesh.MeshGen.gen"><code class="docutils literal notranslate"><span class="pre">MeshGen.gen()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dataset.html#equation">Equation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dataset.html#tensormesh.dataset.equation.PoissonMultiFrequency"><code class="docutils literal notranslate"><span class="pre">PoissonMultiFrequency</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.equation.PoissonMultiFrequency.__init__"><code class="docutils literal notranslate"><span class="pre">PoissonMultiFrequency.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.equation.PoissonMultiFrequency.source_term"><code class="docutils literal notranslate"><span class="pre">PoissonMultiFrequency.source_term()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.equation.PoissonMultiFrequency.solution"><code class="docutils literal notranslate"><span class="pre">PoissonMultiFrequency.solution()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dataset.html#tensormesh.dataset.equation.HeatMultiFrequency"><code class="docutils literal notranslate"><span class="pre">HeatMultiFrequency</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.equation.HeatMultiFrequency.__init__"><code class="docutils literal notranslate"><span class="pre">HeatMultiFrequency.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.equation.HeatMultiFrequency.initial_condition"><code class="docutils literal notranslate"><span class="pre">HeatMultiFrequency.initial_condition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.equation.HeatMultiFrequency.solution"><code class="docutils literal notranslate"><span class="pre">HeatMultiFrequency.solution()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dataset.html#tensormesh.dataset.equation.WaveMultiFrequency"><code class="docutils literal notranslate"><span class="pre">WaveMultiFrequency</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.equation.WaveMultiFrequency.__init__"><code class="docutils literal notranslate"><span class="pre">WaveMultiFrequency.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.equation.WaveMultiFrequency.initial_condition"><code class="docutils literal notranslate"><span class="pre">WaveMultiFrequency.initial_condition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="dataset.html#tensormesh.dataset.equation.WaveMultiFrequency.solution"><code class="docutils literal notranslate"><span class="pre">WaveMultiFrequency.solution()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mesh.html">tensormesh.mesh</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mesh.html#mesh">Mesh</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh"><code class="docutils literal notranslate"><span class="pre">Mesh</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.points"><code class="docutils literal notranslate"><span class="pre">Mesh.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.cells"><code class="docutils literal notranslate"><span class="pre">Mesh.cells</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.point_data"><code class="docutils literal notranslate"><span class="pre">Mesh.point_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.cell_data"><code class="docutils literal notranslate"><span class="pre">Mesh.cell_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.field_data"><code class="docutils literal notranslate"><span class="pre">Mesh.field_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.cell_sets"><code class="docutils literal notranslate"><span class="pre">Mesh.cell_sets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.dim2eletyp"><code class="docutils literal notranslate"><span class="pre">Mesh.dim2eletyp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.default_eletyp"><code class="docutils literal notranslate"><span class="pre">Mesh.default_eletyp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.default_element_type"><code class="docutils literal notranslate"><span class="pre">Mesh.default_element_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#id0"><code class="docutils literal notranslate"><span class="pre">Mesh.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.__init__"><code class="docutils literal notranslate"><span class="pre">Mesh.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#id1"><code class="docutils literal notranslate"><span class="pre">Mesh.cells</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#id2"><code class="docutils literal notranslate"><span class="pre">Mesh.point_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#id3"><code class="docutils literal notranslate"><span class="pre">Mesh.cell_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#id4"><code class="docutils literal notranslate"><span class="pre">Mesh.field_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#id5"><code class="docutils literal notranslate"><span class="pre">Mesh.cell_sets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#id6"><code class="docutils literal notranslate"><span class="pre">Mesh.dim2eletyp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#id7"><code class="docutils literal notranslate"><span class="pre">Mesh.default_eletyp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.register_point_data"><code class="docutils literal notranslate"><span class="pre">Mesh.register_point_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.register_element_data"><code class="docutils literal notranslate"><span class="pre">Mesh.register_element_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.to_meshio"><code class="docutils literal notranslate"><span class="pre">Mesh.to_meshio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.dim"><code class="docutils literal notranslate"><span class="pre">Mesh.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.save"><code class="docutils literal notranslate"><span class="pre">Mesh.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.to_file"><code class="docutils literal notranslate"><span class="pre">Mesh.to_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.node_adjacency"><code class="docutils literal notranslate"><span class="pre">Mesh.node_adjacency()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.element_adjacency"><code class="docutils literal notranslate"><span class="pre">Mesh.element_adjacency()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.elements"><code class="docutils literal notranslate"><span class="pre">Mesh.elements()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.clone"><code class="docutils literal notranslate"><span class="pre">Mesh.clone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.plot"><code class="docutils literal notranslate"><span class="pre">Mesh.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.n_points"><code class="docutils literal notranslate"><span class="pre">Mesh.n_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.n_elements"><code class="docutils literal notranslate"><span class="pre">Mesh.n_elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.boundary_mask"><code class="docutils literal notranslate"><span class="pre">Mesh.boundary_mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#id8"><code class="docutils literal notranslate"><span class="pre">Mesh.default_element_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.dtype"><code class="docutils literal notranslate"><span class="pre">Mesh.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.device"><code class="docutils literal notranslate"><span class="pre">Mesh.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.from_meshio"><code class="docutils literal notranslate"><span class="pre">Mesh.from_meshio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.read"><code class="docutils literal notranslate"><span class="pre">Mesh.read()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.from_file"><code class="docutils literal notranslate"><span class="pre">Mesh.from_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.gen_rectangle"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_rectangle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.gen_hollow_rectangle"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_hollow_rectangle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.gen_circle"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.gen_hollow_circle"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_hollow_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.gen_L"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_L()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.gen_cube"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_cube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.gen_hollow_cube"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_hollow_cube()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.gen_sphere"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_sphere()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mesh.html#tensormesh.mesh.Mesh.gen_hollow_sphere"><code class="docutils literal notranslate"><span class="pre">Mesh.gen_hollow_sphere()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">tensormesh.element</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#elements">Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.element.Element"><code class="docutils literal notranslate"><span class="pre">Element</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.points"><code class="docutils literal notranslate"><span class="pre">Element.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.vertex"><code class="docutils literal notranslate"><span class="pre">Element.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.edge"><code class="docutils literal notranslate"><span class="pre">Element.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.face"><code class="docutils literal notranslate"><span class="pre">Element.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.cell"><code class="docutils literal notranslate"><span class="pre">Element.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.dim"><code class="docutils literal notranslate"><span class="pre">Element.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.n_vertex"><code class="docutils literal notranslate"><span class="pre">Element.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.n_edge"><code class="docutils literal notranslate"><span class="pre">Element.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.n_face"><code class="docutils literal notranslate"><span class="pre">Element.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.n_cell"><code class="docutils literal notranslate"><span class="pre">Element.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.is_mix_facet"><code class="docutils literal notranslate"><span class="pre">Element.is_mix_facet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Element.get_facet_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_basis"><code class="docutils literal notranslate"><span class="pre">Element.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_facet"><code class="docutils literal notranslate"><span class="pre">Element.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_edge"><code class="docutils literal notranslate"><span class="pre">Element.get_edge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Element.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Element.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Element.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_basis_fns"><code class="docutils literal notranslate"><span class="pre">Element.get_basis_fns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_basis_grad_fns"><code class="docutils literal notranslate"><span class="pre">Element.get_basis_grad_fns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.eval_cell_jacobian"><code class="docutils literal notranslate"><span class="pre">Element.eval_cell_jacobian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.eval_shape_val"><code class="docutils literal notranslate"><span class="pre">Element.eval_shape_val()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.eval_shape_grad"><code class="docutils literal notranslate"><span class="pre">Element.eval_shape_grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_local_facet_mapping_fns"><code class="docutils literal notranslate"><span class="pre">Element.get_local_facet_mapping_fns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_local_facet_mapping_grad_fns"><code class="docutils literal notranslate"><span class="pre">Element.get_local_facet_mapping_grad_fns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_outwards_facet_normal"><code class="docutils literal notranslate"><span class="pre">Element.get_outwards_facet_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_n_facet"><code class="docutils literal notranslate"><span class="pre">Element.get_n_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_n_basis"><code class="docutils literal notranslate"><span class="pre">Element.get_n_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.eval_facet_cell_jacobian"><code class="docutils literal notranslate"><span class="pre">Element.eval_facet_cell_jacobian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.eval_facet_jacobian"><code class="docutils literal notranslate"><span class="pre">Element.eval_facet_jacobian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.element_to_facet"><code class="docutils literal notranslate"><span class="pre">Element.element_to_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.element_to_edge"><code class="docutils literal notranslate"><span class="pre">Element.element_to_edge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_tri_mask"><code class="docutils literal notranslate"><span class="pre">Element.get_tri_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_quad_mask"><code class="docutils literal notranslate"><span class="pre">Element.get_quad_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Element.get_contour"><code class="docutils literal notranslate"><span class="pre">Element.get_contour()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.element.Line"><code class="docutils literal notranslate"><span class="pre">Line</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Line.points"><code class="docutils literal notranslate"><span class="pre">Line.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Line.vertex"><code class="docutils literal notranslate"><span class="pre">Line.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Line.edge"><code class="docutils literal notranslate"><span class="pre">Line.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Line.dim"><code class="docutils literal notranslate"><span class="pre">Line.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Line.n_vertex"><code class="docutils literal notranslate"><span class="pre">Line.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Line.n_edge"><code class="docutils literal notranslate"><span class="pre">Line.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Line.n_face"><code class="docutils literal notranslate"><span class="pre">Line.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Line.n_cell"><code class="docutils literal notranslate"><span class="pre">Line.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Line.get_basis"><code class="docutils literal notranslate"><span class="pre">Line.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Line.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Line.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Line.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Line.get_quadrature()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.element.Triangle"><code class="docutils literal notranslate"><span class="pre">Triangle</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.points"><code class="docutils literal notranslate"><span class="pre">Triangle.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.vertex"><code class="docutils literal notranslate"><span class="pre">Triangle.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.edge"><code class="docutils literal notranslate"><span class="pre">Triangle.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.face"><code class="docutils literal notranslate"><span class="pre">Triangle.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.dim"><code class="docutils literal notranslate"><span class="pre">Triangle.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.n_vertex"><code class="docutils literal notranslate"><span class="pre">Triangle.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.n_edge"><code class="docutils literal notranslate"><span class="pre">Triangle.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.n_face"><code class="docutils literal notranslate"><span class="pre">Triangle.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.n_cell"><code class="docutils literal notranslate"><span class="pre">Triangle.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.get_basis"><code class="docutils literal notranslate"><span class="pre">Triangle.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Triangle.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.get_facet"><code class="docutils literal notranslate"><span class="pre">Triangle.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Triangle.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Triangle.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Triangle.get_facet_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Triangle.get_contour"><code class="docutils literal notranslate"><span class="pre">Triangle.get_contour()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron"><code class="docutils literal notranslate"><span class="pre">Tetrahedron</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.points"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.vertex"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.edge"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.face"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.cell"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.dim"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.n_vertex"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.n_edge"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.n_face"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.n_cell"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.get_basis"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.get_facet"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Tetrahedron.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Tetrahedron.get_facet_type()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral"><code class="docutils literal notranslate"><span class="pre">Quadrilateral</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.points"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.vertex"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.edge"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.face"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.dim"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.n_vertex"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.n_edge"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.n_face"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.n_cell"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.get_basis"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.get_facet"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_facet_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Quadrilateral.get_coutour"><code class="docutils literal notranslate"><span class="pre">Quadrilateral.get_coutour()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.element.Hexahedron"><code class="docutils literal notranslate"><span class="pre">Hexahedron</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.points"><code class="docutils literal notranslate"><span class="pre">Hexahedron.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.vertex"><code class="docutils literal notranslate"><span class="pre">Hexahedron.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.edge"><code class="docutils literal notranslate"><span class="pre">Hexahedron.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.face"><code class="docutils literal notranslate"><span class="pre">Hexahedron.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.cell"><code class="docutils literal notranslate"><span class="pre">Hexahedron.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.dim"><code class="docutils literal notranslate"><span class="pre">Hexahedron.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.n_vertex"><code class="docutils literal notranslate"><span class="pre">Hexahedron.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.n_edge"><code class="docutils literal notranslate"><span class="pre">Hexahedron.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.n_face"><code class="docutils literal notranslate"><span class="pre">Hexahedron.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.n_cell"><code class="docutils literal notranslate"><span class="pre">Hexahedron.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.get_basis"><code class="docutils literal notranslate"><span class="pre">Hexahedron.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Hexahedron.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Hexahedron.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.get_facet"><code class="docutils literal notranslate"><span class="pre">Hexahedron.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Hexahedron.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Hexahedron.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Hexahedron.get_facet_type()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.element.Prism"><code class="docutils literal notranslate"><span class="pre">Prism</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.points"><code class="docutils literal notranslate"><span class="pre">Prism.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.vertex"><code class="docutils literal notranslate"><span class="pre">Prism.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.edge"><code class="docutils literal notranslate"><span class="pre">Prism.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.face"><code class="docutils literal notranslate"><span class="pre">Prism.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.cell"><code class="docutils literal notranslate"><span class="pre">Prism.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.dim"><code class="docutils literal notranslate"><span class="pre">Prism.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.n_vertex"><code class="docutils literal notranslate"><span class="pre">Prism.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.n_edge"><code class="docutils literal notranslate"><span class="pre">Prism.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.n_face"><code class="docutils literal notranslate"><span class="pre">Prism.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.n_cell"><code class="docutils literal notranslate"><span class="pre">Prism.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.is_mix_facet"><code class="docutils literal notranslate"><span class="pre">Prism.is_mix_facet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.get_basis"><code class="docutils literal notranslate"><span class="pre">Prism.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Prism.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Prism.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.get_facet"><code class="docutils literal notranslate"><span class="pre">Prism.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Prism.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Prism.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Prism.get_facet_type()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.element.Pyramid"><code class="docutils literal notranslate"><span class="pre">Pyramid</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.points"><code class="docutils literal notranslate"><span class="pre">Pyramid.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.vertex"><code class="docutils literal notranslate"><span class="pre">Pyramid.vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.edge"><code class="docutils literal notranslate"><span class="pre">Pyramid.edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.face"><code class="docutils literal notranslate"><span class="pre">Pyramid.face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.cell"><code class="docutils literal notranslate"><span class="pre">Pyramid.cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.dim"><code class="docutils literal notranslate"><span class="pre">Pyramid.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.n_vertex"><code class="docutils literal notranslate"><span class="pre">Pyramid.n_vertex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.n_edge"><code class="docutils literal notranslate"><span class="pre">Pyramid.n_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.n_face"><code class="docutils literal notranslate"><span class="pre">Pyramid.n_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.n_cell"><code class="docutils literal notranslate"><span class="pre">Pyramid.n_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.is_mix_facet"><code class="docutils literal notranslate"><span class="pre">Pyramid.is_mix_facet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.get_basis"><code class="docutils literal notranslate"><span class="pre">Pyramid.get_basis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.get_polynomial"><code class="docutils literal notranslate"><span class="pre">Pyramid.get_polynomial()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.get_quadrature"><code class="docutils literal notranslate"><span class="pre">Pyramid.get_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.get_facet"><code class="docutils literal notranslate"><span class="pre">Pyramid.get_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.get_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Pyramid.get_facet_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.element.Pyramid.get_facet_type"><code class="docutils literal notranslate"><span class="pre">Pyramid.get_facet_type()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#transformation">Transformation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.transformation.Transformation"><code class="docutils literal notranslate"><span class="pre">Transformation</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.elements"><code class="docutils literal notranslate"><span class="pre">Transformation.elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.points"><code class="docutils literal notranslate"><span class="pre">Transformation.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.element"><code class="docutils literal notranslate"><span class="pre">Transformation.element</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.basis_order"><code class="docutils literal notranslate"><span class="pre">Transformation.basis_order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.quadrature_order"><code class="docutils literal notranslate"><span class="pre">Transformation.quadrature_order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">Transformation.elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">Transformation.points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.__init__"><code class="docutils literal notranslate"><span class="pre">Transformation.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">Transformation.element</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">Transformation.basis_order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">Transformation.quadrature_order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.update_points"><code class="docutils literal notranslate"><span class="pre">Transformation.update_points()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.dim"><code class="docutils literal notranslate"><span class="pre">Transformation.dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.device"><code class="docutils literal notranslate"><span class="pre">Transformation.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.dtype"><code class="docutils literal notranslate"><span class="pre">Transformation.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.element_coords"><code class="docutils literal notranslate"><span class="pre">Transformation.element_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.n_elements"><code class="docutils literal notranslate"><span class="pre">Transformation.n_elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.basis"><code class="docutils literal notranslate"><span class="pre">Transformation.basis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.n_basis"><code class="docutils literal notranslate"><span class="pre">Transformation.n_basis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.quadrature"><code class="docutils literal notranslate"><span class="pre">Transformation.quadrature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.n_quadrature"><code class="docutils literal notranslate"><span class="pre">Transformation.n_quadrature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.shape_val"><code class="docutils literal notranslate"><span class="pre">Transformation.shape_val</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.shape_grad"><code class="docutils literal notranslate"><span class="pre">Transformation.shape_grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.jacobian"><code class="docutils literal notranslate"><span class="pre">Transformation.jacobian</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.facets"><code class="docutils literal notranslate"><span class="pre">Transformation.facets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.facet_quadrature"><code class="docutils literal notranslate"><span class="pre">Transformation.facet_quadrature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.facet_shape_val"><code class="docutils literal notranslate"><span class="pre">Transformation.facet_shape_val</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.facet_shape_grad"><code class="docutils literal notranslate"><span class="pre">Transformation.facet_shape_grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.facet_jacobian"><code class="docutils literal notranslate"><span class="pre">Transformation.facet_jacobian</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.nanson_scale"><code class="docutils literal notranslate"><span class="pre">Transformation.nanson_scale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.phi"><code class="docutils literal notranslate"><span class="pre">Transformation.phi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.gradphi"><code class="docutils literal notranslate"><span class="pre">Transformation.gradphi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.J"><code class="docutils literal notranslate"><span class="pre">Transformation.J</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.detJ"><code class="docutils literal notranslate"><span class="pre">Transformation.detJ</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.JxW"><code class="docutils literal notranslate"><span class="pre">Transformation.JxW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.G"><code class="docutils literal notranslate"><span class="pre">Transformation.G</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.detG"><code class="docutils literal notranslate"><span class="pre">Transformation.detG</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.GxW"><code class="docutils literal notranslate"><span class="pre">Transformation.GxW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.F"><code class="docutils literal notranslate"><span class="pre">Transformation.F</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.detF"><code class="docutils literal notranslate"><span class="pre">Transformation.detF</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.FxW"><code class="docutils literal notranslate"><span class="pre">Transformation.FxW</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.n"><code class="docutils literal notranslate"><span class="pre">Transformation.n</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.batch_quadrature"><code class="docutils literal notranslate"><span class="pre">Transformation.batch_quadrature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.batch_elements_coords"><code class="docutils literal notranslate"><span class="pre">Transformation.batch_elements_coords()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.batch_shape_val"><code class="docutils literal notranslate"><span class="pre">Transformation.batch_shape_val()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.transformation.Transformation.batch_shape_grad_jxw"><code class="docutils literal notranslate"><span class="pre">Transformation.batch_shape_grad_jxw()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#polynomial">Polynomial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial"><code class="docutils literal notranslate"><span class="pre">Polynomial</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.__init__"><code class="docutils literal notranslate"><span class="pre">Polynomial.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.n_vars"><code class="docutils literal notranslate"><span class="pre">Polynomial.n_vars</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.n_terms"><code class="docutils literal notranslate"><span class="pre">Polynomial.n_terms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.forward"><code class="docutils literal notranslate"><span class="pre">Polynomial.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.get_exp_terms"><code class="docutils literal notranslate"><span class="pre">Polynomial.get_exp_terms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.deriv"><code class="docutils literal notranslate"><span class="pre">Polynomial.deriv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.grad"><code class="docutils literal notranslate"><span class="pre">Polynomial.grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.reset_coef"><code class="docutils literal notranslate"><span class="pre">Polynomial.reset_coef()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.repeat"><code class="docutils literal notranslate"><span class="pre">Polynomial.repeat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.lin_exp"><code class="docutils literal notranslate"><span class="pre">Polynomial.lin_exp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.poly_exp"><code class="docutils literal notranslate"><span class="pre">Polynomial.poly_exp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.tens_exp"><code class="docutils literal notranslate"><span class="pre">Polynomial.tens_exp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.pyr_exp"><code class="docutils literal notranslate"><span class="pre">Polynomial.pyr_exp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial.pri_exp"><code class="docutils literal notranslate"><span class="pre">Polynomial.pri_exp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials"><code class="docutils literal notranslate"><span class="pre">Polynomials</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials._coef"><code class="docutils literal notranslate"><span class="pre">Polynomials._coef</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials._exp"><code class="docutils literal notranslate"><span class="pre">Polynomials._exp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.n_polys"><code class="docutils literal notranslate"><span class="pre">Polynomials.n_polys</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.n_vars"><code class="docutils literal notranslate"><span class="pre">Polynomials.n_vars</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.n_terms"><code class="docutils literal notranslate"><span class="pre">Polynomials.n_terms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.device"><code class="docutils literal notranslate"><span class="pre">Polynomials.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.dtype"><code class="docutils literal notranslate"><span class="pre">Polynomials.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.shape"><code class="docutils literal notranslate"><span class="pre">Polynomials.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.__init__"><code class="docutils literal notranslate"><span class="pre">Polynomials.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">Polynomials.n_polys</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">Polynomials.n_vars</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">Polynomials.n_terms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.numel"><code class="docutils literal notranslate"><span class="pre">Polynomials.numel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">Polynomials.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.ndim"><code class="docutils literal notranslate"><span class="pre">Polynomials.ndim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">Polynomials.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">Polynomials.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.dim"><code class="docutils literal notranslate"><span class="pre">Polynomials.dim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.forward"><code class="docutils literal notranslate"><span class="pre">Polynomials.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.get_exp_terms"><code class="docutils literal notranslate"><span class="pre">Polynomials.get_exp_terms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.apply_coefficient"><code class="docutils literal notranslate"><span class="pre">Polynomials.apply_coefficient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.map"><code class="docutils literal notranslate"><span class="pre">Polynomials.map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.map_exp_terms"><code class="docutils literal notranslate"><span class="pre">Polynomials.map_exp_terms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.reshape"><code class="docutils literal notranslate"><span class="pre">Polynomials.reshape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.transpose"><code class="docutils literal notranslate"><span class="pre">Polynomials.transpose()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.deriv"><code class="docutils literal notranslate"><span class="pre">Polynomials.deriv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.grad"><code class="docutils literal notranslate"><span class="pre">Polynomials.grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.reset_coef"><code class="docutils literal notranslate"><span class="pre">Polynomials.reset_coef()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.repeat"><code class="docutils literal notranslate"><span class="pre">Polynomials.repeat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials.stack"><code class="docutils literal notranslate"><span class="pre">Polynomials.stack()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-tensormesh.element.basis">Basis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.lin_linspace"><code class="docutils literal notranslate"><span class="pre">lin_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.quad_linspace"><code class="docutils literal notranslate"><span class="pre">quad_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.tri_linspace"><code class="docutils literal notranslate"><span class="pre">tri_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.hex_linspace"><code class="docutils literal notranslate"><span class="pre">hex_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.tet_linspace"><code class="docutils literal notranslate"><span class="pre">tet_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.pyr_linspace"><code class="docutils literal notranslate"><span class="pre">pyr_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.pri_linspace"><code class="docutils literal notranslate"><span class="pre">pri_linspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.lin_basis"><code class="docutils literal notranslate"><span class="pre">lin_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.tri_basis"><code class="docutils literal notranslate"><span class="pre">tri_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.quad_basis"><code class="docutils literal notranslate"><span class="pre">quad_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.tet_basis"><code class="docutils literal notranslate"><span class="pre">tet_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.hex_basis"><code class="docutils literal notranslate"><span class="pre">hex_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.pyr_basis"><code class="docutils literal notranslate"><span class="pre">pyr_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.pri_basis"><code class="docutils literal notranslate"><span class="pre">pri_basis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.accumulate_range"><code class="docutils literal notranslate"><span class="pre">accumulate_range()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.index_reverse_mapping"><code class="docutils literal notranslate"><span class="pre">index_reverse_mapping()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.facet_basis_index_2d"><code class="docutils literal notranslate"><span class="pre">facet_basis_index_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.tet_facet_basis_index"><code class="docutils literal notranslate"><span class="pre">tet_facet_basis_index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.hex_facet_basis_index"><code class="docutils literal notranslate"><span class="pre">hex_facet_basis_index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.mix_facet_basis_index"><code class="docutils literal notranslate"><span class="pre">mix_facet_basis_index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.basis.edge_index"><code class="docutils literal notranslate"><span class="pre">edge_index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-tensormesh.element.quadrature">Quadrature</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.quadrature.lin_quadrature"><code class="docutils literal notranslate"><span class="pre">lin_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.quadrature.tri_quadrature"><code class="docutils literal notranslate"><span class="pre">tri_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.quadrature.tet_quadrature"><code class="docutils literal notranslate"><span class="pre">tet_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.quadrature.quad_quadrature"><code class="docutils literal notranslate"><span class="pre">quad_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.quadrature.hex_quadrature"><code class="docutils literal notranslate"><span class="pre">hex_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.quadrature.pyr_quadrature"><code class="docutils literal notranslate"><span class="pre">pyr_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.quadrature.pri_quadrature"><code class="docutils literal notranslate"><span class="pre">pri_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.quadrature.facet_quadrature_2d"><code class="docutils literal notranslate"><span class="pre">facet_quadrature_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.quadrature.tet_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">tet_facet_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.quadrature.hex_facet_quadrature"><code class="docutils literal notranslate"><span class="pre">hex_facet_quadrature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.quadrature.mix_facet_quadrature_3d"><code class="docutils literal notranslate"><span class="pre">mix_facet_quadrature_3d()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-tensormesh.element.normal">Normal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.normal.outwards_normal_2d"><code class="docutils literal notranslate"><span class="pre">outwards_normal_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensormesh.element.normal.outwards_normal_3d"><code class="docutils literal notranslate"><span class="pre">outwards_normal_3d()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="assemble.html">tensormesh.assemble</a><ul>
<li class="toctree-l2"><a class="reference internal" href="assemble.html#element-assembler">Element Assembler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler"><code class="docutils literal notranslate"><span class="pre">ElementAssembler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.quadrature_weights"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.quadrature_weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.quadrature_points"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.quadrature_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.shape_val"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.shape_val</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.projector"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.projector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.elements"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.edges"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.edges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.n_points"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.n_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.dimension"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.dimension</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.element_types"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.element_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#id0"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.edges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.__init__"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#id1"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.projector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.transformation"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.transformation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#id2"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#id3"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.dimension</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#id4"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.element_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#id5"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.n_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.device"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.dtype"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.type"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.forward"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.from_assembler"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.from_assembler()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.element_assembler.ElementAssembler.from_mesh"><code class="docutils literal notranslate"><span class="pre">ElementAssembler.from_mesh()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="assemble.html#facet-assembler">Facet Assembler</a></li>
<li class="toctree-l2"><a class="reference internal" href="assemble.html#node-assembler">Node Assembler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler"><code class="docutils literal notranslate"><span class="pre">NodeAssembler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.quadrature_weights"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.quadrature_weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.quadrature_points"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.quadrature_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.shape_val"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.shape_val</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.projector"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.projector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.elements"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.n_points"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.n_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.dimension"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.dimension</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.element_types"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.element_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.__init__"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#id6"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.projector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.transformation"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.transformation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#id7"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.elements</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#id8"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.dimension</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#id9"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.element_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#id10"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.n_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.device"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.dtype"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.type"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.forward"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.from_assembler"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.from_assembler()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.from_elements"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.from_elements()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.node_assembler.NodeAssembler.from_mesh"><code class="docutils literal notranslate"><span class="pre">NodeAssembler.from_mesh()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="assemble.html#built-in-assemblers">Built-in Assemblers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="assemble.html#tensormesh.assemble.builtin.LaplaceElementAssembler"><code class="docutils literal notranslate"><span class="pre">LaplaceElementAssembler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.builtin.LaplaceElementAssembler.forward"><code class="docutils literal notranslate"><span class="pre">LaplaceElementAssembler.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="assemble.html#tensormesh.assemble.builtin.MassElementAssembler"><code class="docutils literal notranslate"><span class="pre">MassElementAssembler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="assemble.html#tensormesh.assemble.builtin.MassElementAssembler.forward"><code class="docutils literal notranslate"><span class="pre">MassElementAssembler.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sparse.html">tensormesh.sparse</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sparse.html#sparsematirx">SparseMatirx</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix"><code class="docutils literal notranslate"><span class="pre">SparseMatrix</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.edata"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.edata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.row"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.row</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.col"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.shape"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.hash_layout"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.hash_layout</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#id0"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.edata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#id1"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.row</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#id2"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.__init__"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#id3"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.layout_hash"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.layout_hash</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.edges"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.edges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.elementwise_operation"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.elementwise_operation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.solve"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.solve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.requires_grad_"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.requires_grad_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.transpose"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.transpose()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.sqrt"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.sqrt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.reciprocal"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.reciprocal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.degree"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.degree()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.sum"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.sum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.clone"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.clone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.T"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.requires_grad"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.requires_grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.dtype"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.device"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.grad"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.grad_fn"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.grad_fn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.nnz"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.nnz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.layout_mask"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.layout_mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.type"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.detach"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.detach()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.to_scipy_coo"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.to_scipy_coo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.to_sparse_coo"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.to_sparse_coo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.to_dense"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.to_dense()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.has_same_layout"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.has_same_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.from_scipy_coo"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.from_scipy_coo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.from_sparse_coo"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.from_sparse_coo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.from_block_coo"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.from_block_coo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.from_dense"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.from_dense()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.random"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.random()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.random_layout"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.random_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.random_from_layout"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.random_from_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.eye"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.eye()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.full"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.full()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.combine_vector"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.combine_vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.combine_matrix"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.combine_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="sparse.html#tensormesh.sparse.SparseMatrix.combine"><code class="docutils literal notranslate"><span class="pre">SparseMatrix.combine()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="operator.html">tensormesh.operator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="operator.html#condenser">Condenser</a><ul>
<li class="toctree-l3"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser"><code class="docutils literal notranslate"><span class="pre">Condenser</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.dirichlet_mask"><code class="docutils literal notranslate"><span class="pre">Condenser.dirichlet_mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.dirichlet_value"><code class="docutils literal notranslate"><span class="pre">Condenser.dirichlet_value</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.__init__"><code class="docutils literal notranslate"><span class="pre">Condenser.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#id0"><code class="docutils literal notranslate"><span class="pre">Condenser.dirichlet_mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#id1"><code class="docutils literal notranslate"><span class="pre">Condenser.dirichlet_value</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.inner_row"><code class="docutils literal notranslate"><span class="pre">Condenser.inner_row</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.inner_col"><code class="docutils literal notranslate"><span class="pre">Condenser.inner_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.ou2in_row"><code class="docutils literal notranslate"><span class="pre">Condenser.ou2in_row</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.ou2in_col"><code class="docutils literal notranslate"><span class="pre">Condenser.ou2in_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.is_inner_edge"><code class="docutils literal notranslate"><span class="pre">Condenser.is_inner_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.is_ou2in_edge"><code class="docutils literal notranslate"><span class="pre">Condenser.is_ou2in_edge</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.layout_hash"><code class="docutils literal notranslate"><span class="pre">Condenser.layout_hash</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.K_ou2in"><code class="docutils literal notranslate"><span class="pre">Condenser.K_ou2in</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.condense_rhs"><code class="docutils literal notranslate"><span class="pre">Condenser.condense_rhs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="operator.html#tensormesh.operator.Condenser.recover"><code class="docutils literal notranslate"><span class="pre">Condenser.recover()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ode.html">tensormesh.ode</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ode.html#runge-kutta-methods">Runge-Kutta methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="ode.html#built-in-methods">Built-in Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ode.html#tensormesh.ode.ExplicitRungeKutta"><code class="docutils literal notranslate"><span class="pre">ExplicitRungeKutta</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.ExplicitRungeKutta.__init__"><code class="docutils literal notranslate"><span class="pre">ExplicitRungeKutta.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.ExplicitRungeKutta.forward"><code class="docutils literal notranslate"><span class="pre">ExplicitRungeKutta.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.ExplicitRungeKutta.step"><code class="docutils literal notranslate"><span class="pre">ExplicitRungeKutta.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ode.html#tensormesh.ode.ImplicitLinearRungeKutta"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.ImplicitLinearRungeKutta.__init__"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.ImplicitLinearRungeKutta.forward_M"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.forward_M()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.ImplicitLinearRungeKutta.forward_A"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.forward_A()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.ImplicitLinearRungeKutta.forward_B"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.forward_B()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.ImplicitLinearRungeKutta.pre_solve_lhs"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.pre_solve_lhs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.ImplicitLinearRungeKutta.pre_solve_rhs"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.pre_solve_rhs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.ImplicitLinearRungeKutta.post_solve"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.post_solve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.ImplicitLinearRungeKutta.step"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearRungeKutta.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ode.html#tensormesh.ode.builtin.ExplicitEuler"><code class="docutils literal notranslate"><span class="pre">ExplicitEuler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.builtin.ExplicitEuler.__init__"><code class="docutils literal notranslate"><span class="pre">ExplicitEuler.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ode.html#tensormesh.ode.builtin.ImplicitLinearEuler"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearEuler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.builtin.ImplicitLinearEuler.__init__"><code class="docutils literal notranslate"><span class="pre">ImplicitLinearEuler.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ode.html#tensormesh.ode.builtin.MidPointLinearEuler"><code class="docutils literal notranslate"><span class="pre">MidPointLinearEuler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ode.html#tensormesh.ode.builtin.MidPointLinearEuler.__init__"><code class="docutils literal notranslate"><span class="pre">MidPointLinearEuler.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="functional.html">tensormesh.functional</a><ul>
<li class="toctree-l2"><a class="reference internal" href="functional.html#module-tensormesh.functional.ops">ops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.ops.sym"><code class="docutils literal notranslate"><span class="pre">sym()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.ops.skew"><code class="docutils literal notranslate"><span class="pre">skew()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.ops.sqrt"><code class="docutils literal notranslate"><span class="pre">sqrt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.ops.divide"><code class="docutils literal notranslate"><span class="pre">divide()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#module-tensormesh.functional.elasticity">elasticity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.elasticity.strain"><code class="docutils literal notranslate"><span class="pre">strain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.elasticity.isotropic_stress"><code class="docutils literal notranslate"><span class="pre">isotropic_stress()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.elasticity.deviatoric_stress"><code class="docutils literal notranslate"><span class="pre">deviatoric_stress()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.elasticity.deviatoric_stress_norm"><code class="docutils literal notranslate"><span class="pre">deviatoric_stress_norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.elasticity.voigt_shape_grad"><code class="docutils literal notranslate"><span class="pre">voigt_shape_grad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.elasticity.voigt_stiffness"><code class="docutils literal notranslate"><span class="pre">voigt_stiffness()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.elasticity.voigt_shape_val"><code class="docutils literal notranslate"><span class="pre">voigt_shape_val()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.elasticity.voigt_C"><code class="docutils literal notranslate"><span class="pre">voigt_C()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.elasticity.voigt_B"><code class="docutils literal notranslate"><span class="pre">voigt_B()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.elasticity.voigt_N"><code class="docutils literal notranslate"><span class="pre">voigt_N()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#module-tensormesh.functional.plastic">plastic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="functional.html#tensormesh.functional.plastic.update_plastic_stress"><code class="docutils literal notranslate"><span class="pre">update_plastic_stress()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nn.html">NN</a><ul>
<li class="toctree-l2"><a class="reference internal" href="nn.html#bufferutils">BufferUtils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict"><code class="docutils literal notranslate"><span class="pre">BufferDict</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict.__init__"><code class="docutils literal notranslate"><span class="pre">BufferDict.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict.as_parameter"><code class="docutils literal notranslate"><span class="pre">BufferDict.as_parameter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict.as_buffer"><code class="docutils literal notranslate"><span class="pre">BufferDict.as_buffer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict.keys"><code class="docutils literal notranslate"><span class="pre">BufferDict.keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict.items"><code class="docutils literal notranslate"><span class="pre">BufferDict.items()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict.values"><code class="docutils literal notranslate"><span class="pre">BufferDict.values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict.is_floating_point"><code class="docutils literal notranslate"><span class="pre">BufferDict.is_floating_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict.is_complex"><code class="docutils literal notranslate"><span class="pre">BufferDict.is_complex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict.dtype"><code class="docutils literal notranslate"><span class="pre">BufferDict.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict.device"><code class="docutils literal notranslate"><span class="pre">BufferDict.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict.to_dict"><code class="docutils literal notranslate"><span class="pre">BufferDict.to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferDict.clone"><code class="docutils literal notranslate"><span class="pre">BufferDict.clone()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList"><code class="docutils literal notranslate"><span class="pre">BufferList</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.__init__"><code class="docutils literal notranslate"><span class="pre">BufferList.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.as_parameter"><code class="docutils literal notranslate"><span class="pre">BufferList.as_parameter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.as_buffer"><code class="docutils literal notranslate"><span class="pre">BufferList.as_buffer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.append"><code class="docutils literal notranslate"><span class="pre">BufferList.append()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.insert"><code class="docutils literal notranslate"><span class="pre">BufferList.insert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.pop"><code class="docutils literal notranslate"><span class="pre">BufferList.pop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.item"><code class="docutils literal notranslate"><span class="pre">BufferList.item()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.is_floating_point"><code class="docutils literal notranslate"><span class="pre">BufferList.is_floating_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.is_complex"><code class="docutils literal notranslate"><span class="pre">BufferList.is_complex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.dtype"><code class="docutils literal notranslate"><span class="pre">BufferList.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.device"><code class="docutils literal notranslate"><span class="pre">BufferList.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.to_list"><code class="docutils literal notranslate"><span class="pre">BufferList.to_list()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="nn.html#tensormesh.nn.BufferList.clone"><code class="docutils literal notranslate"><span class="pre">BufferList.clone()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">visualization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="visualization.html#module-tensormesh.visualization.draw_graph">Draw Facet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_graph.draw_graph"><code class="docutils literal notranslate"><span class="pre">draw_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_mesh.draw_mesh"><code class="docutils literal notranslate"><span class="pre">draw_mesh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_facet.draw_facet_2d"><code class="docutils literal notranslate"><span class="pre">draw_facet_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_facet.draw_face"><code class="docutils literal notranslate"><span class="pre">draw_face()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_element_value.draw_element_value_2d_tri"><code class="docutils literal notranslate"><span class="pre">draw_element_value_2d_tri()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_element_value.draw_element_value_2d"><code class="docutils literal notranslate"><span class="pre">draw_element_value_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_element_value.update_element_value_2d_tri"><code class="docutils literal notranslate"><span class="pre">update_element_value_2d_tri()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_element_value.update_element_value_2d"><code class="docutils literal notranslate"><span class="pre">update_element_value_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_element_value.draw_element_value_3d"><code class="docutils literal notranslate"><span class="pre">draw_element_value_3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_element_value.update_element_value_3d"><code class="docutils literal notranslate"><span class="pre">update_element_value_3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_element_value.draw_element_value"><code class="docutils literal notranslate"><span class="pre">draw_element_value()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_element_value.update_element_value"><code class="docutils literal notranslate"><span class="pre">update_element_value()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_point_value.draw_point_value_2d_tri_gouraud"><code class="docutils literal notranslate"><span class="pre">draw_point_value_2d_tri_gouraud()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_point_value.update_point_value_2d_tri_gouraud"><code class="docutils literal notranslate"><span class="pre">update_point_value_2d_tri_gouraud()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_point_value.draw_point_value_2d_interpolation"><code class="docutils literal notranslate"><span class="pre">draw_point_value_2d_interpolation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_point_value.update_point_value_2d_interpolation"><code class="docutils literal notranslate"><span class="pre">update_point_value_2d_interpolation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_point_value.draw_point_value_2d"><code class="docutils literal notranslate"><span class="pre">draw_point_value_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_point_value.update_point_value_2d"><code class="docutils literal notranslate"><span class="pre">update_point_value_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_point_value.draw_point_value_3d_interpolation"><code class="docutils literal notranslate"><span class="pre">draw_point_value_3d_interpolation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_point_value.update_point_value_3d_interpolation"><code class="docutils literal notranslate"><span class="pre">update_point_value_3d_interpolation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_point_value.draw_point_value"><code class="docutils literal notranslate"><span class="pre">draw_point_value()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.draw_point_value.update_point_value"><code class="docutils literal notranslate"><span class="pre">update_point_value()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.stream_plotter.StreamPlotter"><code class="docutils literal notranslate"><span class="pre">StreamPlotter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="visualization.html#tensormesh.visualization.stream_plotter.StreamPlotter.__init__"><code class="docutils literal notranslate"><span class="pre">StreamPlotter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="visualization.html#tensormesh.visualization.stream_plotter.StreamPlotter.grab_frame"><code class="docutils literal notranslate"><span class="pre">StreamPlotter.grab_frame()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="visualization.html#tensormesh.visualization.stream_plotter.StreamPlotter.update"><code class="docutils literal notranslate"><span class="pre">StreamPlotter.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="visualization.html#tensormesh.visualization.stream_plotter.StreamPlotter.draw_mesh_2d"><code class="docutils literal notranslate"><span class="pre">StreamPlotter.draw_mesh_2d()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.stream_plotter.draw_mesh_2d_static"><code class="docutils literal notranslate"><span class="pre">draw_mesh_2d_static()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#tensormesh.visualization.stream_plotter.draw_mesh_2d_stream"><code class="docutils literal notranslate"><span class="pre">draw_mesh_2d_stream()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="profile.html">Profile</a><ul>
<li class="toctree-l2"><a class="reference internal" href="profile.html#cpuprofiler">CPUProfiler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="profile.html#tensormesh.profile.CPUProfiler"><code class="docutils literal notranslate"><span class="pre">CPUProfiler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CPUProfiler.pid"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.pid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CPUProfiler.results"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.results</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CPUProfiler.times"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.times</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CPUProfiler.scopes"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.scopes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CPUProfiler.__init__"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CPUProfiler.max"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CPUProfiler.min"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CPUProfiler.mean"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CPUProfiler.std"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.std()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CPUProfiler.plot"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CPUProfiler.scope"><code class="docutils literal notranslate"><span class="pre">CPUProfiler.scope()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="profile.html#cudaprofiler">CUDAProfiler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="profile.html#tensormesh.profile.CUDAProfiler"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CUDAProfiler.__init__"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CUDAProfiler.max"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CUDAProfiler.min"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CUDAProfiler.mean"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CUDAProfiler.std"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.std()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CUDAProfiler.plot"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.CUDAProfiler.scope"><code class="docutils literal notranslate"><span class="pre">CUDAProfiler.scope()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="profile.html#timeprofiler">TimeProfiler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="profile.html#tensormesh.profile.TimeProfiler"><code class="docutils literal notranslate"><span class="pre">TimeProfiler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.TimeProfiler.time"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.TimeProfiler.start"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.start</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.TimeProfiler.scopes"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.scopes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.TimeProfiler.only_cpu"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.only_cpu</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.TimeProfiler.__init__"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.TimeProfiler.scope"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.scope()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="profile.html#tensormesh.profile.TimeProfiler.plot"><code class="docutils literal notranslate"><span class="pre">TimeProfiler.plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tensormesh</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">tensormesh.element</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api_reference/element.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tensormesh-element">
<h1>tensormesh.element<a class="headerlink" href="#tensormesh-element" title="Link to this heading"></a></h1>
<nav class="contents local" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#elements" id="id13">Elements</a></p></li>
<li><p><a class="reference internal" href="#transformation" id="id14">Transformation</a></p></li>
<li><p><a class="reference internal" href="#polynomial" id="id15">Polynomial</a></p></li>
<li><p><a class="reference internal" href="#module-tensormesh.element.basis" id="id16">Basis</a></p></li>
<li><p><a class="reference internal" href="#module-tensormesh.element.quadrature" id="id17">Quadrature</a></p></li>
<li><p><a class="reference internal" href="#module-tensormesh.element.normal" id="id18">Normal</a></p></li>
</ul>
</nav>
<section id="elements">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Elements</a><a class="headerlink" href="#elements" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tensormesh.element.element.Element">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Element</span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.points">
<span class="sig-name descname"><span class="pre">points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.element.Element.points" title="Link to this definition"></a></dt>
<dd><p>Coordinates of element vertices
Shape: <span class="math notranslate nohighlight">\([V, D]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.vertex">
<span class="sig-name descname"><span class="pre">vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.element.Element.vertex" title="Link to this definition"></a></dt>
<dd><p>Vertex indices for the element
Shape: <span class="math notranslate nohighlight">\([V, 1]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.edge">
<span class="sig-name descname"><span class="pre">edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.element.Element.edge" title="Link to this definition"></a></dt>
<dd><p>Edge connectivity defining pairs of vertex indices
Shape: <span class="math notranslate nohighlight">\([E, 2]\)</span> where <span class="math notranslate nohighlight">\(E\)</span> = number of edges</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.face">
<span class="sig-name descname"><span class="pre">face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#tensormesh.element.element.Element.face" title="Link to this definition"></a></dt>
<dd><p>Face connectivity defining vertex indices for each face.
Shape: Tuple of tuples, each inner tuple contains vertex indices
for one face.</p>
<dl class="simple">
<dt>Example:</dt><dd><p>((0,1,2), (1,2,3)) for two triangular faces</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.cell">
<span class="sig-name descname"><span class="pre">cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#tensormesh.element.element.Element.cell" title="Link to this definition"></a></dt>
<dd><p>Cell connectivity defining vertex indices for volumetric elements
Shape: <span class="math notranslate nohighlight">\([N_c, V_c]\)</span> where <span class="math notranslate nohighlight">\(N_c\)</span> = number of cells and <span class="math notranslate nohighlight">\(V_c\)</span> = vertices per cell</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tensormesh.element.element.Element.dim" title="Link to this definition"></a></dt>
<dd><p>Spatial dimension of the element (1D, 2D, or 3D)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.n_vertex">
<span class="sig-name descname"><span class="pre">n_vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tensormesh.element.element.Element.n_vertex" title="Link to this definition"></a></dt>
<dd><p>Number of vertices in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.n_edge">
<span class="sig-name descname"><span class="pre">n_edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tensormesh.element.element.Element.n_edge" title="Link to this definition"></a></dt>
<dd><p>Number of edges in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.n_face">
<span class="sig-name descname"><span class="pre">n_face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tensormesh.element.element.Element.n_face" title="Link to this definition"></a></dt>
<dd><p>Number of faces in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.n_cell">
<span class="sig-name descname"><span class="pre">n_cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tensormesh.element.element.Element.n_cell" title="Link to this definition"></a></dt>
<dd><p>Number of cells in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.is_mix_facet">
<span class="sig-name descname"><span class="pre">is_mix_facet</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#tensormesh.element.element.Element.is_mix_facet" title="Link to this definition"></a></dt>
<dd><p>Boolean indicating whether the element has mixed facet types.</p>
<p>False indicates uniform facets (e.g. all triangles or all quads).
True indicates mixed facets (e.g. prism or pyramid).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_facet_type">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><span class="pre">Type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><span class="pre">Type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><span class="pre">Type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_facet_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_facet_type" title="Link to this definition"></a></dt>
<dd><p>Get the element type(s) for the facets of this element.</p>
<p>This method returns the element type(s) that make up the facets (faces) of the current element.
For example, a triangle element has line segment facets, while a prism has both triangular and
quadrilateral facets.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Line</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span><span class="p">,</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">==</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Triangle</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The element type(s) for the facets. Returns either:</p>
<ul class="simple">
<li><p>A single Element type for elements with uniform facets (e.g. Line for Triangle)</p></li>
<li><p>A tuple of Element types for elements with mixed facets (e.g. (Triangle, Quadrilateral) for Prism)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[Type[‘Element’], Tuple[Type[‘Element’], Type[‘Element’]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_basis">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_basis" title="Link to this definition"></a></dt>
<dd><p>Get the basis node coordinates for the element.</p>
<p>This method returns the coordinates of the basis nodes that define the element’s shape functions.
The number and location of basis nodes depends on the polynomial order.</p>
<p>For example:
- For order=1 (linear), returns vertices of the element
- For order=2 (quadratic), returns vertices plus midpoints of edges
- For higher orders, returns additional nodes in the interior</p>
<p>The basis nodes are used to construct the element’s shape functions and define the geometric
mapping between reference and physical elements.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])  # 3 vertices in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0.],</span>
<span class="go">        [1., 0.],</span>
<span class="go">        [0., 1.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Quadratic basis has additional nodes at edge midpoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([6, 2])  # 3 vertices + 3 edge midpoints</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 3])  # 4 vertices in 3D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0., 0.],</span>
<span class="go">        [1., 0., 0.],</span>
<span class="go">        [0., 1., 0.],</span>
<span class="go">        [0., 0., 1.]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor of shape [B, D],
where B is the number of basis nodes and D is the dimension</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_facet">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_facet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_facet" title="Link to this definition"></a></dt>
<dd><p>Get the facet connectivity for the element.</p>
<p>For elements with uniform facets (e.g. Triangle, Quadrilateral), returns a single tensor
containing facet connectivity. For elements with mixed facets (e.g. Prism), returns a tuple
of tensors containing facet connectivity for each facet type.</p>
<p>The facet connectivity defines how the basis nodes are connected to form each facet of the element.
For example, for a triangle element with linear basis (order=1), the facet connectivity would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># First edge connects nodes 0 and 1</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># Second edge connects nodes 1 and 2</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<p>For a prism element which has both triangular and quadrilateral facets, would return:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span><span class="p">)</span>
</pre></div>
</div>
<p>Where tri_facets contains connectivity for the triangular faces and quad_facets contains
connectivity for the quadrilateral faces.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span>
<span class="go">tensor([[0, 1],  # First edge connects nodes 0 and 1</span>
<span class="go">        [1, 2],  # Second edge connects nodes 1 and 2</span>
<span class="go">        [2, 0]]) # Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher order elements have more nodes per facet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 3])  # 3 edges with 3 nodes each</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Two triangular faces</span>
<span class="go">torch.Size([2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Three quadrilateral faces</span>
<span class="go">torch.Size([3, 4])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>if cls.is_mix_facet</em> –</p>
<ul>
<li><dl class="simple">
<dt>tri_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_t\)</span>, <span class="math notranslate nohighlight">\(B_{ft}\)</span>] where <span class="math notranslate nohighlight">\(F_t\)</span> is number of triangular facets, <span class="math notranslate nohighlight">\(B_{ft}\)</span> is basis nodes per triangular facet</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>quad_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_q\)</span>, <span class="math notranslate nohighlight">\(B_{fq}\)</span>] where <span class="math notranslate nohighlight">\(F_q\)</span> is number of quadrilateral facets, <span class="math notranslate nohighlight">\(B_{fq}\)</span> is basis nodes per quadrilateral facet</p>
</dd>
</dl>
</li>
</ul>
</li>
<li><p><em>else</em> –</p>
<ul>
<li><dl class="simple">
<dt>facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F\)</span>, <span class="math notranslate nohighlight">\(B_f\)</span>] where <span class="math notranslate nohighlight">\(F\)</span> is number of facets, <span class="math notranslate nohighlight">\(B_f\)</span> is basis nodes per facet</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_edge">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_edge" title="Link to this definition"></a></dt>
<dd><p>Get the edge basis indices for the element.</p>
<p>Returns the connectivity array for the edges of the element. Each row represents an edge
and contains the indices of the basis nodes along that edge.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_edge</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span>
<span class="go">tensor([[0, 1],  # First edge connects nodes 0 and 1</span>
<span class="go">        [1, 2],  # Second edge connects nodes 1 and 2</span>
<span class="go">        [2, 0]]) # Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher order elements have more nodes per edge</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_edge</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 3])  # 3 edges with 3 nodes each</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>edge</strong> – 2D Tensor of shape [n_edge, 2] containing edge connectivity</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_polynomial">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_polynomial" title="Link to this definition"></a></dt>
<dd><p>Get the polynomial form for the element.</p>
<p>For a given order n, returns a polynomial with terms up to maximum total degree n.
The polynomial will have n_vars equal to the dimension of the element.</p>
<p>For example,</p>
<ul class="simple">
<li><p>For a 2D element with order=1:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y\)</span></p></li>
<li><p>For order=2:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y + a_3x^2 + a_4xy + a_5y^2\)</span></p></li>
</ul>
<p>The exact form and number of terms depends on the specific element type.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 2D element</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Quadratic terms: 1, x, y, x^2, xy, y^2</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 3D element</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y, z</span>
<span class="go">4</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong> – A polynomial object with number of variables equal to the element dimension,</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the element.</p>
<dl class="simple">
<dt>For elements with single type of facets (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of two tensors containing quadrature weights and points</p></li>
</ul>
</dd>
<dt>For elements with mixed facets (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of four tensors containing quadrature weights and points for each facet type</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Number of quadrature points</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_points, dimension]</span>
<span class="go">torch.Size([1, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># More quadrature points for higher order</span>
<span class="go">torch.Size([3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># 3D points</span>
<span class="go">torch.Size([1, 3])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – quadrature order</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>- quadrature_weights</strong> (<em>torch.Tensor</em>) – 1D Tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><strong>- quadrature_points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape <span class="math notranslate nohighlight">\([N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points and <span class="math notranslate nohighlight">\(D\)</span> = dimension of element (1, 2, or 3)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_facet_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_facet_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_facet_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the facets of the element.</p>
<p>This method returns quadrature rules for integrating over element facets. The return format depends on whether the element has uniform or mixed facet types.</p>
<dl class="simple">
<dt><strong>For elements with uniform facets</strong> (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (weights, points) tensors</p></li>
<li><p>weights: quadrature weights for each facet point</p></li>
<li><p>points: quadrature point coordinates</p></li>
</ul>
</dd>
<dt><strong>For elements with mixed facets</strong> (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (tri_weights, tri_points, quad_weights, quad_points)</p></li>
<li><p>tri_weights: quadrature weights for triangular facets</p></li>
<li><p>tri_points: quadrature points for triangular facets</p></li>
<li><p>quad_weights: quadrature weights for quadrilateral facets</p></li>
<li><p>quad_points: quadrature points for quadrilateral facets</p></li>
</ul>
</dd>
</dl>
<p>The quadrature points can be returned either in the reference element coordinates (transform=True) or in facet-local coordinates (transform=False).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for tetrahedron element with uniform triangular facets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1]</span>
<span class="go">torch.Size([4, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([4, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for prism element with mixed facets (triangular and quadrilateral)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="p">,</span> <span class="n">tri_p</span><span class="p">,</span> <span class="n">quad_w</span><span class="p">,</span> <span class="n">quad_p</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1]</span>
<span class="go">torch.Size([2, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_p</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([2, 1, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_w</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1]</span>
<span class="go">torch.Size([3, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_p</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([3, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with transform=False returns points in facet-local coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1]</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1, dim-1=1]</span>
<span class="go">torch.Size([1, 1])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Quadrature order. Default is 1.</p></li>
<li><p><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to return the transformed facet quadrature.
If True, returns points in reference element coordinates with shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span>, where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.
If False, returns points in facet-local coordinates with shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span>, where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>) – The float data type of the polynomial.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device of the polynomial.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><em>For elements with uniform facets</em> –</p>
<dl class="simple">
<dt>quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True,  2D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet</p>
</dd>
<dt>quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
<li><p><em>For elements with mixed facets</em> –</p>
<dl class="simple">
<dt>tri_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p>
</dd>
<dt>tri_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
<dt>quad_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p>
</dd>
<dt>quad_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_basis_fns">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_basis_fns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_basis_fns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_basis_fns" title="Link to this definition"></a></dt>
<dd><p>Get the basis functions for this element type.</p>
<p>Returns polynomial basis functions that interpolate values at the element nodes.
The basis functions have the Kronecker delta property, meaning each basis function
is 1 at its corresponding node and 0 at all other nodes.</p>
<p>For example, for a linear triangle element (order=1), returns 3 basis functions
corresponding to the 3 vertices. Each basis function is 1 at one vertex and 0
at the other vertices.</p>
<p>For higher orders, returns basis functions for both vertex and edge nodes.
The number and location of nodes depends on the specific element type.</p>
<p>The basis functions are returned as a Polynomials object containing the
polynomial coefficients and exponents. This allows efficient evaluation
and manipulation of the basis functions.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis_fns</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis_fns</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis_fns</span>
<span class="go">Polynomials([</span>
<span class="go">    1 - x - y,  # First basis function, 1 at vertex 0 (0,0)</span>
<span class="go">    x,          # Second basis function, 1 at vertex 1 (1,0)</span>
<span class="go">    y           # Third basis function, 1 at vertex 2 (0,1)</span>
<span class="go">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate basis functions at a point</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">basis_fns</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span>
<span class="go">tensor([[0.25, 0.50, 0.25]])  # Values sum to 1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher order basis functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis_fns</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis_fns</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis_fns</span>
<span class="go">Polynomials([</span>
<span class="go">    # Vertex basis functions</span>
<span class="go">    2*x^2 + 2*y^2 - 3*x - 3*y + 1,  # Node 0</span>
<span class="go">    2*x^2 - x,                       # Node 1</span>
<span class="go">    2*y^2 - y,                       # Node 2</span>
<span class="go">    # Edge basis functions</span>
<span class="go">    4*x*y,                           # Node 3</span>
<span class="go">    -4*x*y + 4*x,                    # Node 4</span>
<span class="go">    -4*x*y + 4*y                     # Node 5</span>
<span class="go">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis_fns</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_basis_fns</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis_fns</span>
<span class="go">Polynomials([</span>
<span class="go">    1 - x - y - z,  # First basis function</span>
<span class="go">    x,              # Second basis function</span>
<span class="go">    y,              # Third basis function</span>
<span class="go">    z               # Fourth basis function</span>
<span class="go">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The order of the basis functions.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – The float data type of the polynomial.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – The device to place the polynomial on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The basis functions of the element. Shape is <span class="math notranslate nohighlight">\([N_b]\)</span> where <span class="math notranslate nohighlight">\(N_b\)</span> is the number of basis functions, with <span class="math notranslate nohighlight">\(N_{vars}=D\)</span> variables and <span class="math notranslate nohighlight">\(N_{exp}=N_b\)</span> expansion terms.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials">Polynomials</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_basis_grad_fns">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_basis_grad_fns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_basis_grad_fns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_basis_grad_fns" title="Link to this definition"></a></dt>
<dd><p>Get the gradient of basis functions with respect to reference coordinates.</p>
<p>For a basis function <span class="math notranslate nohighlight">\(\phi(x_1,\ldots,x_n)\)</span>, computes the gradient:</p>
<div class="math notranslate nohighlight">
\[\nabla \phi = \left[\frac{\partial \phi}{\partial x_1}, \ldots, \frac{\partial \phi}{\partial x_n}\right]\]</div>
<p>The gradient is computed by taking the partial derivative of each basis function
with respect to each coordinate direction <span class="math notranslate nohighlight">\(x_i\)</span> in the reference element.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get gradients of linear basis functions for a triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grad_fns</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis_grad_fns</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grads</span> <span class="o">=</span> <span class="n">grad_fns</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>  <span class="c1"># [n_points=2, dim=2, n_basis=3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grads</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([2, 2, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get gradients of quadratic basis functions for a tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grad_fns</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_basis_grad_fns</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grads</span> <span class="o">=</span> <span class="n">grad_fns</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>  <span class="c1"># [n_points=1, dim=3, n_basis=10]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grads</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 3, 10])</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">element</span> <span class="o">=</span> <span class="n">Triangle</span>
<span class="n">grad_fns</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">get_basis_grad_fns</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">grads</span> <span class="o">=</span> <span class="n">grad_fns</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="c1"># [n_points, dim, n_basis]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grads</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># torch.Size([2, 2, 3])  # 2 points, 2D gradients, 3 basis functions</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The order of the basis functions</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – The float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – The device to place the polynomial on</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The gradient basis functions. Shape is <span class="math notranslate nohighlight">\([D, N_b]\)</span> where
- <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
- <span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions
- n_vars = <span class="math notranslate nohighlight">\(D\)</span>
- n_terms = <span class="math notranslate nohighlight">\(N_b\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials">Polynomials</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.eval_cell_jacobian">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_cell_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quadrature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.eval_cell_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.eval_cell_jacobian" title="Link to this definition"></a></dt>
<dd><p>Evaluate the Jacobian matrix at quadrature points for each element.</p>
<p>The Jacobian matrix represents the linear transformation from reference coordinates to physical coordinates.
It is computed by multiplying the element coordinates by the gradients of the basis functions.</p>
<p>For each quadrature point q and element e, computes:</p>
<div class="math notranslate nohighlight">
\[J_{e,q,i,j} = \sum_b \text{coords}_{e,b,j} \frac{\partial \phi_b}{\partial x_i}(q)\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{coords}_{e,b,j}\)</span> is the j-th coordinate of basis node b in element e</p></li>
<li><p><span class="math notranslate nohighlight">\(\phi_b\)</span> is basis function b</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{\partial \phi_b}{\partial x_i}\)</span> is the derivative of basis function b with respect to reference coordinate i</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">element</span> <span class="o">=</span> <span class="n">Triangle</span>
<span class="n">quadrature</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">element_coords</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">jacobian</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">eval_cell_jacobian</span><span class="p">(</span><span class="n">quadrature</span><span class="p">,</span> <span class="n">element_coords</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jacobian</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># torch.Size([1, 2, 2, 2])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quadrature</strong> (<em>torch.Tensor</em>) – <p>Shape <span class="math notranslate nohighlight">\([N_q, D]\)</span> or <span class="math notranslate nohighlight">\([N_e, N_q, D]\)</span> where:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
<p>Quadrature points for each element</p>
</p></li>
<li><p><strong>element_coords</strong> (<em>torch.Tensor</em>) – <p>Shape <span class="math notranslate nohighlight">\([N_e, N_b, D]\)</span> where:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis nodes</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
<p>Physical coordinates of element nodes</p>
</p></li>
<li><p><strong>basis_order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Order of basis functions, by default 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Shape <span class="math notranslate nohighlight">\([N_e, N_q, D, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
<p>Jacobian matrix evaluated at each quadrature point for each element</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.eval_shape_val">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_shape_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quadrature_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.eval_shape_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.eval_shape_val" title="Link to this definition"></a></dt>
<dd><p>Evaluates the shape functions at quadrature points.</p>
<p>For a given set of quadrature points, evaluates each basis function phi_i at those points.
Returns a matrix where entry (q,i) is the value of basis function i at quadrature point q.</p>
<p>The shape functions have two key properties:</p>
<ol class="arabic simple">
<li><p>Partition of unity: The functions sum to 1 at any point</p></li>
<li><p>Interpolation property: phi_i(x_j) = delta_ij at the nodes</p></li>
</ol>
<p>For example, for linear elements (order=1):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\phi_1(x) &amp;= 1-x \quad \text{(equals 1 at x=0, 0 at x=1)} \\
\phi_2(x) &amp;= x \quad \text{(equals 0 at x=0, 1 at x=1)}\end{split}\]</div>
<p>For quadratic elements (order=2), includes additional mid-node basis functions.</p>
<p>If quadrature_points are not provided, uses default quadrature rule of specified order.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Element</span>

<span class="c1"># Create quadrature points</span>
<span class="n">quad_points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]])</span>

<span class="c1"># Evaluate shape functions at quadrature points</span>
<span class="n">shape_vals</span> <span class="o">=</span> <span class="n">Element</span><span class="o">.</span><span class="n">eval_shape_val</span><span class="p">(</span><span class="n">quad_points</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">shape_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># [3, 2] for linear element</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quadrature_points</strong> (<em>Optional</em><em>[</em><em>torch.Tensor</em><em>]</em>) – Tensor of shape <span class="math notranslate nohighlight">\([N_q, D]\)</span> containing quadrature points, where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Order of the basis functions</p></li>
<li><p><strong>quadrature_order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The order for quadrature, if quadrature is not None, quadrature_order will be ignored</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – The float data type of the shape value, if quadrature_points is not None, the dtype will be ignored.
Default is torch.float32</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – The device of the shape value, if quadrature_points is not None, the device will be ignored.
Default is torch.device(‘cpu’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape <span class="math notranslate nohighlight">\([N_q, N_b]\)</span> containing shape function values, where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points and <span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.eval_shape_grad">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_shape_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element_coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.eval_shape_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.eval_shape_grad" title="Link to this definition"></a></dt>
<dd><p>Evaluates the shape function gradients and cell Jacobians at quadrature points.</p>
<p>For each element, computes:</p>
<ol class="arabic simple">
<li><p>Shape function gradients in reference coordinates</p></li>
<li><p>Cell Jacobian mapping from reference to physical coordinates</p></li>
<li><p>Transforms gradients to physical coordinates using inverse Jacobian</p></li>
</ol>
<p>The shape function gradients are used in weak form assembly:</p>
<div class="math notranslate nohighlight">
\[\nabla \phi_i = \sum_j J^{-1}_{jk} \frac{\partial \phi_i}{\partial \xi_k}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\phi_i\)</span> are the basis functions</p></li>
<li><p><span class="math notranslate nohighlight">\(J\)</span> is the Jacobian matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(\xi_k\)</span> are reference coordinates</p></li>
</ul>
<p>The cell Jacobian <span class="math notranslate nohighlight">\(J_{ij} = \frac{\partial x_i}{\partial \xi_j}\)</span> maps derivatives between reference and physical coordinates.</p>
<p>For linear elements (order=1), the Jacobian is constant within each element.
For higher order elements, the Jacobian varies spatially.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Element</span>

<span class="c1"># Create element coordinates</span>
<span class="n">element_coords</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]])</span>

<span class="c1"># Evaluate shape function gradients and Jacobian</span>
<span class="n">shape_grad</span><span class="p">,</span> <span class="n">cell_jacobian</span> <span class="o">=</span> <span class="n">Element</span><span class="o">.</span><span class="n">eval_shape_grad</span><span class="p">(</span><span class="n">element_coords</span><span class="p">,</span> <span class="n">basis_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">shape_grad</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>      <span class="c1"># [1, n_quad, 3, 2]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell_jacobian</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>   <span class="c1"># [1, n_quad, 2, 2]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element_coords</strong> (<em>torch.Tensor</em>) – Tensor of shape <span class="math notranslate nohighlight">\([N_e, N_b, D]\)</span> containing element vertex coordinates, where:
- <span class="math notranslate nohighlight">\(N_e\)</span> = number of elements
- <span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions
- <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
<li><p><strong>quadrature</strong> (<em>torch.Tensor</em>) – Tensor of shape <span class="math notranslate nohighlight">\([N_q, D]\)</span> containing quadrature points for each element, where:
- <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points
- <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
<li><p><strong>basis_order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Order for basis functions</p></li>
<li><p><strong>quadrature_order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Order for quadrature, if element_coords is not None, the quadrature_order will be ignored,
default is 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>shape_grad</strong> (<em>torch.Tensor</em>) – Tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q, N_b, D]\)</span> containing shape function gradients, where:
- <span class="math notranslate nohighlight">\(N_e\)</span> = number of elements
- <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points
- <span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions
- <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
<li><p><strong>cell_jacobian</strong> (<em>torch.Tensor</em>) – Tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q, D, D]\)</span> containing cell Jacobians, where:
- <span class="math notranslate nohighlight">\(N_e\)</span> = number of elements
- <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points
- <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_local_facet_mapping_fns">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_local_facet_mapping_fns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_local_facet_mapping_fns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_local_facet_mapping_fns" title="Link to this definition"></a></dt>
<dd><p>Maps points from the reference facet to the facet of the reference element.</p>
<p>For a facet <span class="math notranslate nohighlight">\(f\)</span>, defines a mapping <span class="math notranslate nohighlight">\(\gamma_f(r)\)</span> from reference facet coordinates <span class="math notranslate nohighlight">\(r\)</span>
to reference element coordinates <span class="math notranslate nohighlight">\(\xi\)</span>:</p>
<div class="math notranslate nohighlight">
\[\gamma_f: \hat{F} \rightarrow F\]</div>
<p>where:
- <span class="math notranslate nohighlight">\(\hat{F}\)</span> is the reference facet (e.g. line for 2D, triangle for 3D)
- <span class="math notranslate nohighlight">\(F\)</span> is the facet of the reference element
- <span class="math notranslate nohighlight">\(\gamma_f(r)\)</span> is a linear mapping</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>

<span class="c1"># Get mapping functions for triangle element facets</span>
<span class="n">facet_fns</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_local_facet_mapping_fns</span><span class="p">()</span>

<span class="c1"># Map points from reference facet to element facet</span>
<span class="n">ref_points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]])</span>  <span class="c1"># Points on reference line</span>
<span class="n">mapped_points</span> <span class="o">=</span> <span class="n">facet_fns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">ref_points</span><span class="p">)</span>  <span class="c1"># Points on triangle facet</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomials
default is torch.float32</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomials
default is torch.device(‘cpu’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>local_facet_fns</strong> – Polynomial functions mapping reference facet to element facet coordinates.
Shape is <span class="math notranslate nohighlight">\([N_f, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
<p>Each polynomial has:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D-1\)</span> variables (reference facet coordinates)</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> terms (affine transformation)</p></li>
</ul>
<p>The mapping takes the form:</p>
<div class="math notranslate nohighlight">
\[\gamma_f(r) = c + \sum_{i=1}^{D-1} \alpha_i r_i\]</div>
<p>where <span class="math notranslate nohighlight">\(c, \alpha_i \in \mathbb{R}^D\)</span> are the coefficients</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials">Polynomials</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_local_facet_mapping_grad_fns">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_local_facet_mapping_grad_fns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_local_facet_mapping_grad_fns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_local_facet_mapping_grad_fns" title="Link to this definition"></a></dt>
<dd><p>Computes the gradient of the facet mapping function with respect to the reference coordinates.</p>
<p>For a facet mapping function <span class="math notranslate nohighlight">\(\gamma_f(r)\)</span> that maps from reference coordinates <span class="math notranslate nohighlight">\(r\)</span> to global coordinates,
computes the Jacobian matrix:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \gamma_f (r)}{\partial r}\]</div>
<p>This gives the derivatives of each global coordinate with respect to each reference coordinate.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">element</span> <span class="o">=</span> <span class="n">Triangle</span><span class="p">()</span>
<span class="n">facet_mapping_grad</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">get_local_facet_mapping_grad_fns</span><span class="p">()</span>
<span class="c1"># Returns polynomial tensor with derivatives of mapping</span>
<span class="c1"># Shape: [1, 3, 2] for 2D triangle element (1 ref coord, 3 edges, 2 global coords)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomials
default is torch.float32</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomials
default is torch.device(‘cpu’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Tensor containing the Jacobian with shape <span class="math notranslate nohighlight">\([D-1, N_f, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D-1\)</span> = number of reference coordinates (gradient dimension)</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension (global coordinates)</p></li>
</ul>
<p>The polynomial has <span class="math notranslate nohighlight">\(n_{vars}=D-1\)</span> variables and <span class="math notranslate nohighlight">\(n_{terms}=D\)</span> terms.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PolynomialTensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_outwards_facet_normal">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_outwards_facet_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_outwards_facet_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_outwards_facet_normal" title="Link to this definition"></a></dt>
<dd><p>Computes the outward unit normal vectors for each facet of the element.</p>
<p>This returns the geometric normal vectors without the Nanson scale factor.
For 2D elements, returns normals for each edge.
For 3D elements, returns normals for each face.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">element</span> <span class="o">=</span> <span class="n">Triangle</span><span class="p">()</span>
<span class="n">normals</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">get_outwards_facet_normal</span><span class="p">()</span>
<span class="c1"># Returns tensor of shape [3, 2] containing outward normals</span>
<span class="c1"># for each edge of the triangle</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – The float data type for the output tensor
Default is torch.float32</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – The device to place the output tensor on
Default is torch.device(‘cpu’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>outward_facet_normal</strong> – Tensor of shape <span class="math notranslate nohighlight">\([N_f, D]\)</span> containing the outward unit normal vector for each facet, where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets (edges in 2D, faces in 3D)</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension (2 or 3)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_n_facet">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_n_facet</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_n_facet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_n_facet" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_n_basis">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_n_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_n_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_n_basis" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.eval_facet_cell_jacobian">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_facet_cell_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element_coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.eval_facet_cell_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.eval_facet_cell_jacobian" title="Link to this definition"></a></dt>
<dd><p>Evaluates the Jacobian matrix of the mapping from reference to physical coordinates at facet quadrature points.</p>
<p>For each element and facet, computes the Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{J} = \frac{\partial\mathbf{x}}{\partial\boldsymbol{\xi}}\)</span>
at the quadrature points on that facet. The Jacobian describes how the reference element coordinates
<span class="math notranslate nohighlight">\(\boldsymbol{\xi}\)</span> map to physical coordinates <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<p>For mixed elements with both triangular and quadrilateral facets (e.g. pyramids), returns separate Jacobians
for each facet type.</p>
<p>The Jacobian matrix components are:</p>
<div class="math notranslate nohighlight">
\[J_{ij} = \frac{\partial x_i}{\partial \xi_j}\]</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a triangle element</span>
<span class="n">element</span> <span class="o">=</span> <span class="n">Triangle</span><span class="p">()</span>
<span class="c1"># Element coordinates for a single triangle</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]])</span>
<span class="c1"># Evaluate facet Jacobians using linear basis and 2nd order quadrature</span>
<span class="n">jacobians</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">eval_facet_cell_jacobian</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">basis_order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">quadrature_order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># jacobians shape: [1, 3, 2, 2, 2] for 1 element, 3 edges, 2 quad points per edge</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element_coords</strong> (<em>torch.Tensor</em>) – 3D Tensor of shape <span class="math notranslate nohighlight">\([N_e, N_b, D]\)</span> containing the physical coordinates of element nodes,
where <span class="math notranslate nohighlight">\(N_e\)</span> = number of elements, <span class="math notranslate nohighlight">\(N_b\)</span> = number of basis nodes, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
<li><p><strong>basis_order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Order of the basis functions used for the mapping</p></li>
<li><p><strong>quadrature_order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Order of quadrature rule used for facet integration</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>facet_cell_jacobian</strong> (<em>torch.Tensor</em>) – For elements with uniform facet types,
5D Tensor of shape <span class="math notranslate nohighlight">\([N_e, N_f, N_q, D, D]\)</span> containing Jacobian matrices at facet quadrature points,
where</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</li>
<li><p><strong>(tri_facet_cell_jacobian, quad_facet_cell_jacobian)</strong> (<em>tuple of torch.Tensor</em>) – For mixed elements with both triangular and quadrilateral facets,</p>
<ul>
<li><p>tri_facet_cell_jacobian: <span class="math notranslate nohighlight">\([N_e, N_{tf}, N_{tq}, D, D]\)</span>, where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets,
<span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p></li>
<li><p>quad_facet_cell_jacobian: <span class="math notranslate nohighlight">\([N_e, N_{qf}, N_{qq}, D, D]\)</span>, where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets,
<span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Jacobian is used to:</p>
<ul>
<li><p>Transform integrals from reference to physical space:</p>
<div class="math notranslate nohighlight">
\[\int_K f(\mathbf{x}) \,d\mathbf{x} = \int_{\hat{K}} f(\mathbf{x}(\boldsymbol{\xi})) \vert\det(\mathbf{J})\vert \,d\boldsymbol{\xi}\]</div>
</li>
<li><p>Compute geometric quantities like normal vectors and surface measures</p></li>
<li><p>Map derivatives between reference and physical coordinates:</p>
<div class="math notranslate nohighlight">
\[\nabla_{\mathbf{x}} = \mathbf{J}^{-T} \nabla_{\boldsymbol{\xi}}\]</div>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.eval_facet_jacobian">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval_facet_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element_coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.eval_facet_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.eval_facet_jacobian" title="Link to this definition"></a></dt>
<dd><p>Evaluate the Jacobian mapping from reference facet coordinates to physical coordinates.</p>
<p>For each facet of the element, computes the Jacobian matrix that maps from local facet
coordinates to global physical coordinates.</p>
<p>The facet Jacobian is used to:</p>
<ul>
<li><p>Transform integrals over facets from reference to physical space:</p>
<div class="math notranslate nohighlight">
\[\int_F f(\mathbf{x}) \,ds = \int_{\hat{F}} f(\mathbf{x}(\boldsymbol{\xi})) \|\mathbf{J}\mathbf{t}\| \,d\boldsymbol{\xi}\]</div>
</li>
<li><p>Compute geometric quantities like normal vectors and surface measures</p></li>
<li><p>Map derivatives between reference facet and physical coordinates:</p>
<div class="math notranslate nohighlight">
\[\nabla_{\mathbf{x}} = \mathbf{J}^{-T} \nabla_{\boldsymbol{\xi}}\]</div>
</li>
</ul>
<p>where <span class="math notranslate nohighlight">\(\mathbf{t}\)</span> is a tangent vector to the facet.</p>
<p>For mixed elements like pyramids that have both triangular and quadrilateral facets,
returns separate Jacobians for each facet type.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a triangle element</span>
<span class="n">element_coords</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]])</span>
<span class="c1"># Evaluate facet Jacobian with linear basis and 2nd order quadrature</span>
<span class="n">facet_jacobian</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">eval_facet_jacobian</span><span class="p">(</span><span class="n">element_coords</span><span class="p">,</span>
                                            <span class="n">basis_order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                            <span class="n">quadrature_order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">facet_jacobian</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># torch.Size([1, 3, 2, 1, 2])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element_coords</strong> (torch.Tensor <span class="math notranslate nohighlight">\([N_e, N_b, D]\)</span>) – Boundary element coordinates, where <span class="math notranslate nohighlight">\(N_e\)</span> = number of elements, <span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
<li><p><strong>basis_order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The order of the basis</p></li>
<li><p><strong>quadrature_order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The order of quadrature rule to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>facet_jacobian</strong> (<em>torch.Tensor</em>) – 5D tensor of shape <span class="math notranslate nohighlight">\([N_e, N_f, N_q, D-1, D]\)</span>, where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</li>
<li><p><em>or</em></p></li>
<li><p><strong>tri_facet_jacobian, quad_facet_jacobian, tri_mask</strong> (<em>Tuple[torch.Tensor, torch.Tensor, torch.Tensor]</em>) – 5D tensor of shape <span class="math notranslate nohighlight">\([N_e, N_{tf}, N_{tq}, D-1, D]\)</span>,
D tensor of shape <span class="math notranslate nohighlight">\([N_e, N_{qf}, N_{qq}, D-1, D]\)</span>
, where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
<p>Boolean mask indicating which facets are triangular</p>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.element_to_facet">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">element_to_facet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.element_to_facet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.element_to_facet" title="Link to this definition"></a></dt>
<dd><p>Maps element basis functions to facet basis functions.</p>
<p>For each facet of an element, extracts the subset of element basis functions that are active on that facet.</p>
<p>For mixed elements with both triangular and quadrilateral facets, returns separate tensors for each facet type.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hexahedral element (order=1)</span>
<span class="n">hex_element</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># 8 basis functions</span>
<span class="n">hex_facets</span> <span class="o">=</span> <span class="n">element_to_facet</span><span class="p">(</span><span class="n">hex_element</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># [6, 4] tensor</span>

<span class="c1"># Tetrahedral element (order=2)</span>
<span class="n">tet_element</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># 10 basis functions</span>
<span class="n">tet_facets</span> <span class="o">=</span> <span class="n">element_to_facet</span><span class="p">(</span><span class="n">tet_element</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># [4, 6] tensor</span>

<span class="c1"># Wedge element (order=2)</span>
<span class="n">wedge_element</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>  <span class="c1"># 18 basis functions</span>
<span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span> <span class="o">=</span> <span class="n">element_to_facet</span><span class="p">(</span><span class="n">wedge_element</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># tri_facets: [2, 6] tensor for triangular faces</span>
<span class="c1"># quad_facets: [3, 9] tensor for quadrilateral faces</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elements</strong> (<em>torch.Tensor</em>) – <p>2D tensor of shape <span class="math notranslate nohighlight">\([N_e, N_b]\)</span> containing element basis function values
or 1D tensor of shape <span class="math notranslate nohighlight">\([N_b]\)</span> for a single element,
where:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions</p></li>
</ul>
</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Order of the basis functions</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>If is_mix_facet is True</p>
</dd>
</dl>
<dl class="simple">
<dt>tri_facet<span class="classifier">torch.Tensor</span></dt><dd><p>3D tensor of shape <span class="math notranslate nohighlight">\([N_e, N_{tf}, N_{tb}]\)</span> for multiple elements
or 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tb}]\)</span> for single element,
where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tb}\)</span> = number of basis functions per triangular facet</p></li>
</ul>
</dd>
<dt>quad_facet<span class="classifier">torch.Tensor</span></dt><dd><p>3D tensor of shape <span class="math notranslate nohighlight">\([N_e, N_{qf}, N_{qb}]\)</span> for multiple elements
or 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qb}]\)</span> for single element,
where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qb}\)</span> = number of basis functions per quadrilateral facet</p></li>
</ul>
</dd>
</dl>
<p>If is_mix_facet is False</p>
<dl class="simple">
<dt>facet<span class="classifier">torch.Tensor</span></dt><dd><p>3D tensor of shape <span class="math notranslate nohighlight">\([N_e, N_f, N_b]\)</span> for multiple elements
or 2D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_b]\)</span> for single element,
where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions per facet</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.element_to_edge">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">element_to_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.element_to_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.element_to_edge" title="Link to this definition"></a></dt>
<dd><p>Extract edge values from element values.</p>
<p>Maps element basis function values to edge basis function values using the edge connectivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elements</strong> (<em>torch.Tensor</em>) – ND tensor of shape […, N_b] containing basis function values,
where N_b is the number of basis functions. The leading dimensions
can be arbitrary (e.g., batch dimensions).</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Order of the basis functions</p></li>
<li><p><strong>unique</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, returns only unique edges after sorting edge values.
If False, returns all edges including duplicates.
Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>edge</strong> – (N+1)D tensor of shape […, N_ed, N_eb] containing edge basis function values,
where:</p>
<ul class="simple">
<li><p>[…] = input tensor’s leading dimensions</p></li>
<li><p>N_ed = number of edges</p></li>
<li><p>N_eb = number of basis functions per edge</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_tri_mask">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_tri_mask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_tri_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_tri_mask" title="Link to this definition"></a></dt>
<dd><p>Returns a boolean mask indicating which faces are triangular.</p>
<p>For elements with mixed face types (triangular and quadrilateral faces), returns a boolean tensor
marking which faces are triangular (True) vs quadrilateral (False).</p>
<p>The mask has length equal to the total number of faces and True values for each triangular face.</p>
<p class="rubric">Examples</p>
<p>For a prism element with 2 triangular faces and 3 quadrilateral faces:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Element</span><span class="o">.</span><span class="n">get_tri_mask</span><span class="p">()</span>
<span class="go">tensor([True, True, False, False, False])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tri_mask</strong> – 1D boolean Tensor of shape <span class="math notranslate nohighlight">\([N_f]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_quad_mask">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_quad_mask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_quad_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_quad_mask" title="Link to this definition"></a></dt>
<dd><p>Returns a boolean mask indicating which faces are quadrilateral.</p>
<p>For elements with mixed face types (triangular and quadrilateral faces), returns a boolean tensor
marking which faces are quadrilateral (True) vs triangular (False).</p>
<p>The mask has length equal to the total number of faces and True values for each quadrilateral face.</p>
<p class="rubric">Examples</p>
<p>For a prism element with 2 triangular faces and 3 quadrilateral faces:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Element</span><span class="o">.</span><span class="n">get_quad_mask</span><span class="p">()</span>
<span class="go">tensor([False, False, True, True, True])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>quad_mask</strong> – 1D boolean Tensor of shape <span class="math notranslate nohighlight">\([N_f]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Element.get_contour">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Element.get_contour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Element.get_contour" title="Link to this definition"></a></dt>
<dd><p>Returns the contour points for a 2D element at the specified order.</p>
<p>For a 2D element, returns points along the element boundary at the given polynomial order.
The points are ordered counterclockwise around the boundary.</p>
<p class="rubric">Examples</p>
<p>Get contour points for a quadrilateral at order 2:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">quad</span> <span class="o">=</span> <span class="n">Quadrilateral</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contour</span> <span class="o">=</span> <span class="n">quad</span><span class="o">.</span><span class="n">get_contour</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contour</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([8, 2])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The polynomial order. Must be &gt;= 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>contour</strong> – Tensor of shape <span class="math notranslate nohighlight">\([N_p, 2]\)</span> containing the <span class="math notranslate nohighlight">\((x,y)\)</span> coordinates of points
along the element boundary, ordered counterclockwise, where <span class="math notranslate nohighlight">\(N_p\)</span> = number of points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Only implemented for 2D elements (dim=2)</p></li>
<li><p>Points are distributed according to the polynomial order</p></li>
<li><p>Points are ordered counterclockwise starting from the first vertex</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tensormesh.element.element.Line">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Line</span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Line" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Line.points">
<span class="sig-name descname"><span class="pre">points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.]])</span></em><a class="headerlink" href="#tensormesh.element.element.Line.points" title="Link to this definition"></a></dt>
<dd><p>Coordinates of element vertices
Shape: <span class="math notranslate nohighlight">\([V, D]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Line.vertex">
<span class="sig-name descname"><span class="pre">vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1]])</span></em><a class="headerlink" href="#tensormesh.element.element.Line.vertex" title="Link to this definition"></a></dt>
<dd><p>Vertex indices for the element
Shape: <span class="math notranslate nohighlight">\([V, 1]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Line.edge">
<span class="sig-name descname"><span class="pre">edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0,</span> <span class="pre">1]])</span></em><a class="headerlink" href="#tensormesh.element.element.Line.edge" title="Link to this definition"></a></dt>
<dd><p>Edge connectivity defining pairs of vertex indices
Shape: <span class="math notranslate nohighlight">\([E, 2]\)</span> where <span class="math notranslate nohighlight">\(E\)</span> = number of edges</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Line.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#tensormesh.element.element.Line.dim" title="Link to this definition"></a></dt>
<dd><p>Spatial dimension of the element (1D, 2D, or 3D)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Line.n_vertex">
<span class="sig-name descname"><span class="pre">n_vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#tensormesh.element.element.Line.n_vertex" title="Link to this definition"></a></dt>
<dd><p>Number of vertices in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Line.n_edge">
<span class="sig-name descname"><span class="pre">n_edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#tensormesh.element.element.Line.n_edge" title="Link to this definition"></a></dt>
<dd><p>Number of edges in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Line.n_face">
<span class="sig-name descname"><span class="pre">n_face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#tensormesh.element.element.Line.n_face" title="Link to this definition"></a></dt>
<dd><p>Number of faces in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Line.n_cell">
<span class="sig-name descname"><span class="pre">n_cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#tensormesh.element.element.Line.n_cell" title="Link to this definition"></a></dt>
<dd><p>Number of cells in the element</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Line.get_basis">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Line.get_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Line.get_basis" title="Link to this definition"></a></dt>
<dd><p>Get the basis node coordinates for the element.</p>
<p>This method returns the coordinates of the basis nodes that define the element’s shape functions.
The number and location of basis nodes depends on the polynomial order.</p>
<p>For example:
- For order=1 (linear), returns vertices of the element
- For order=2 (quadratic), returns vertices plus midpoints of edges
- For higher orders, returns additional nodes in the interior</p>
<p>The basis nodes are used to construct the element’s shape functions and define the geometric
mapping between reference and physical elements.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])  # 3 vertices in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0.],</span>
<span class="go">        [1., 0.],</span>
<span class="go">        [0., 1.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Quadratic basis has additional nodes at edge midpoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([6, 2])  # 3 vertices + 3 edge midpoints</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 3])  # 4 vertices in 3D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0., 0.],</span>
<span class="go">        [1., 0., 0.],</span>
<span class="go">        [0., 1., 0.],</span>
<span class="go">        [0., 0., 1.]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor of shape [B, D],
where B is the number of basis nodes and D is the dimension</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Line.get_polynomial">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Line.get_polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Line.get_polynomial" title="Link to this definition"></a></dt>
<dd><p>Get the polynomial form for the element.</p>
<p>For a given order n, returns a polynomial with terms up to maximum total degree n.
The polynomial will have n_vars equal to the dimension of the element.</p>
<p>For example,</p>
<ul class="simple">
<li><p>For a 2D element with order=1:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y\)</span></p></li>
<li><p>For order=2:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y + a_3x^2 + a_4xy + a_5y^2\)</span></p></li>
</ul>
<p>The exact form and number of terms depends on the specific element type.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 2D element</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Quadratic terms: 1, x, y, x^2, xy, y^2</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 3D element</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y, z</span>
<span class="go">4</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong> – A polynomial object with number of variables equal to the element dimension,</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Line.get_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Line.get_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Line.get_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the element.</p>
<dl class="simple">
<dt>For elements with single type of facets (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of two tensors containing quadrature weights and points</p></li>
</ul>
</dd>
<dt>For elements with mixed facets (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of four tensors containing quadrature weights and points for each facet type</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Number of quadrature points</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_points, dimension]</span>
<span class="go">torch.Size([1, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># More quadrature points for higher order</span>
<span class="go">torch.Size([3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># 3D points</span>
<span class="go">torch.Size([1, 3])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – quadrature order</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>- quadrature_weights</strong> (<em>torch.Tensor</em>) – 1D Tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><strong>- quadrature_points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape <span class="math notranslate nohighlight">\([N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points and <span class="math notranslate nohighlight">\(D\)</span> = dimension of element (1, 2, or 3)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Triangle</span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Triangle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Triangle" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.points">
<span class="sig-name descname"><span class="pre">points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0.,</span> <span class="pre">1.]])</span></em><a class="headerlink" href="#tensormesh.element.element.Triangle.points" title="Link to this definition"></a></dt>
<dd><p>Coordinates of element vertices
Shape: <span class="math notranslate nohighlight">\([V, D]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.vertex">
<span class="sig-name descname"><span class="pre">vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[2]])</span></em><a class="headerlink" href="#tensormesh.element.element.Triangle.vertex" title="Link to this definition"></a></dt>
<dd><p>Vertex indices for the element
Shape: <span class="math notranslate nohighlight">\([V, 1]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.edge">
<span class="sig-name descname"><span class="pre">edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[1,</span> <span class="pre">2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0,</span> <span class="pre">2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0,</span> <span class="pre">1]])</span></em><a class="headerlink" href="#tensormesh.element.element.Triangle.edge" title="Link to this definition"></a></dt>
<dd><p>Edge connectivity defining pairs of vertex indices
Shape: <span class="math notranslate nohighlight">\([E, 2]\)</span> where <span class="math notranslate nohighlight">\(E\)</span> = number of edges</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.face">
<span class="sig-name descname"><span class="pre">face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">((0,</span> <span class="pre">1,</span> <span class="pre">2),)</span></em><a class="headerlink" href="#tensormesh.element.element.Triangle.face" title="Link to this definition"></a></dt>
<dd><p>Face connectivity defining vertex indices for each face.
Shape: Tuple of tuples, each inner tuple contains vertex indices
for one face.</p>
<dl class="simple">
<dt>Example:</dt><dd><p>((0,1,2), (1,2,3)) for two triangular faces</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#tensormesh.element.element.Triangle.dim" title="Link to this definition"></a></dt>
<dd><p>Spatial dimension of the element (1D, 2D, or 3D)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.n_vertex">
<span class="sig-name descname"><span class="pre">n_vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#tensormesh.element.element.Triangle.n_vertex" title="Link to this definition"></a></dt>
<dd><p>Number of vertices in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.n_edge">
<span class="sig-name descname"><span class="pre">n_edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#tensormesh.element.element.Triangle.n_edge" title="Link to this definition"></a></dt>
<dd><p>Number of edges in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.n_face">
<span class="sig-name descname"><span class="pre">n_face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#tensormesh.element.element.Triangle.n_face" title="Link to this definition"></a></dt>
<dd><p>Number of faces in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.n_cell">
<span class="sig-name descname"><span class="pre">n_cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#tensormesh.element.element.Triangle.n_cell" title="Link to this definition"></a></dt>
<dd><p>Number of cells in the element</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.get_basis">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Triangle.get_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Triangle.get_basis" title="Link to this definition"></a></dt>
<dd><p>Get the basis node coordinates for the element.</p>
<p>This method returns the coordinates of the basis nodes that define the element’s shape functions.
The number and location of basis nodes depends on the polynomial order.</p>
<p>For example:
- For order=1 (linear), returns vertices of the element
- For order=2 (quadratic), returns vertices plus midpoints of edges
- For higher orders, returns additional nodes in the interior</p>
<p>The basis nodes are used to construct the element’s shape functions and define the geometric
mapping between reference and physical elements.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])  # 3 vertices in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0.],</span>
<span class="go">        [1., 0.],</span>
<span class="go">        [0., 1.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Quadratic basis has additional nodes at edge midpoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([6, 2])  # 3 vertices + 3 edge midpoints</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 3])  # 4 vertices in 3D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0., 0.],</span>
<span class="go">        [1., 0., 0.],</span>
<span class="go">        [0., 1., 0.],</span>
<span class="go">        [0., 0., 1.]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor of shape [B, D],
where B is the number of basis nodes and D is the dimension</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.get_polynomial">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Triangle.get_polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Triangle.get_polynomial" title="Link to this definition"></a></dt>
<dd><p>Get the polynomial form for the element.</p>
<p>For a given order n, returns a polynomial with terms up to maximum total degree n.
The polynomial will have n_vars equal to the dimension of the element.</p>
<p>For example,</p>
<ul class="simple">
<li><p>For a 2D element with order=1:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y\)</span></p></li>
<li><p>For order=2:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y + a_3x^2 + a_4xy + a_5y^2\)</span></p></li>
</ul>
<p>The exact form and number of terms depends on the specific element type.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 2D element</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Quadratic terms: 1, x, y, x^2, xy, y^2</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 3D element</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y, z</span>
<span class="go">4</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong> – A polynomial object with number of variables equal to the element dimension,</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.get_facet">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Triangle.get_facet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Triangle.get_facet" title="Link to this definition"></a></dt>
<dd><p>Get the facet connectivity for the element.</p>
<p>For elements with uniform facets (e.g. Triangle, Quadrilateral), returns a single tensor
containing facet connectivity. For elements with mixed facets (e.g. Prism), returns a tuple
of tensors containing facet connectivity for each facet type.</p>
<p>The facet connectivity defines how the basis nodes are connected to form each facet of the element.
For example, for a triangle element with linear basis (order=1), the facet connectivity would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># First edge connects nodes 0 and 1</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># Second edge connects nodes 1 and 2</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<p>For a prism element which has both triangular and quadrilateral facets, would return:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span><span class="p">)</span>
</pre></div>
</div>
<p>Where tri_facets contains connectivity for the triangular faces and quad_facets contains
connectivity for the quadrilateral faces.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span>
<span class="go">tensor([[0, 1],  # First edge connects nodes 0 and 1</span>
<span class="go">        [1, 2],  # Second edge connects nodes 1 and 2</span>
<span class="go">        [2, 0]]) # Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher order elements have more nodes per facet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 3])  # 3 edges with 3 nodes each</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Two triangular faces</span>
<span class="go">torch.Size([2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Three quadrilateral faces</span>
<span class="go">torch.Size([3, 4])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>if cls.is_mix_facet</em> –</p>
<ul>
<li><dl class="simple">
<dt>tri_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_t\)</span>, <span class="math notranslate nohighlight">\(B_{ft}\)</span>] where <span class="math notranslate nohighlight">\(F_t\)</span> is number of triangular facets, <span class="math notranslate nohighlight">\(B_{ft}\)</span> is basis nodes per triangular facet</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>quad_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_q\)</span>, <span class="math notranslate nohighlight">\(B_{fq}\)</span>] where <span class="math notranslate nohighlight">\(F_q\)</span> is number of quadrilateral facets, <span class="math notranslate nohighlight">\(B_{fq}\)</span> is basis nodes per quadrilateral facet</p>
</dd>
</dl>
</li>
</ul>
</li>
<li><p><em>else</em> –</p>
<ul>
<li><dl class="simple">
<dt>facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F\)</span>, <span class="math notranslate nohighlight">\(B_f\)</span>] where <span class="math notranslate nohighlight">\(F\)</span> is number of facets, <span class="math notranslate nohighlight">\(B_f\)</span> is basis nodes per facet</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.get_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Triangle.get_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Triangle.get_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the element.</p>
<dl class="simple">
<dt>For elements with single type of facets (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of two tensors containing quadrature weights and points</p></li>
</ul>
</dd>
<dt>For elements with mixed facets (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of four tensors containing quadrature weights and points for each facet type</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Number of quadrature points</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_points, dimension]</span>
<span class="go">torch.Size([1, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># More quadrature points for higher order</span>
<span class="go">torch.Size([3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># 3D points</span>
<span class="go">torch.Size([1, 3])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – quadrature order</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>- quadrature_weights</strong> (<em>torch.Tensor</em>) – 1D Tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><strong>- quadrature_points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape <span class="math notranslate nohighlight">\([N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points and <span class="math notranslate nohighlight">\(D\)</span> = dimension of element (1, 2, or 3)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.get_facet_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Triangle.get_facet_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Triangle.get_facet_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the facets of the element.</p>
<p>This method returns quadrature rules for integrating over element facets. The return format depends on whether the element has uniform or mixed facet types.</p>
<dl class="simple">
<dt><strong>For elements with uniform facets</strong> (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (weights, points) tensors</p></li>
<li><p>weights: quadrature weights for each facet point</p></li>
<li><p>points: quadrature point coordinates</p></li>
</ul>
</dd>
<dt><strong>For elements with mixed facets</strong> (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (tri_weights, tri_points, quad_weights, quad_points)</p></li>
<li><p>tri_weights: quadrature weights for triangular facets</p></li>
<li><p>tri_points: quadrature points for triangular facets</p></li>
<li><p>quad_weights: quadrature weights for quadrilateral facets</p></li>
<li><p>quad_points: quadrature points for quadrilateral facets</p></li>
</ul>
</dd>
</dl>
<p>The quadrature points can be returned either in the reference element coordinates (transform=True) or in facet-local coordinates (transform=False).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for tetrahedron element with uniform triangular facets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1]</span>
<span class="go">torch.Size([4, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([4, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for prism element with mixed facets (triangular and quadrilateral)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="p">,</span> <span class="n">tri_p</span><span class="p">,</span> <span class="n">quad_w</span><span class="p">,</span> <span class="n">quad_p</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1]</span>
<span class="go">torch.Size([2, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_p</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([2, 1, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_w</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1]</span>
<span class="go">torch.Size([3, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_p</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([3, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with transform=False returns points in facet-local coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1]</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1, dim-1=1]</span>
<span class="go">torch.Size([1, 1])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Quadrature order. Default is 1.</p></li>
<li><p><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to return the transformed facet quadrature.
If True, returns points in reference element coordinates with shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span>, where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.
If False, returns points in facet-local coordinates with shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span>, where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>) – The float data type of the polynomial.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device of the polynomial.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><em>For elements with uniform facets</em> –</p>
<dl class="simple">
<dt>quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True,  2D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet</p>
</dd>
<dt>quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
<li><p><em>For elements with mixed facets</em> –</p>
<dl class="simple">
<dt>tri_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p>
</dd>
<dt>tri_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
<dt>quad_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p>
</dd>
<dt>quad_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.get_facet_type">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><span class="pre">Type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Triangle.get_facet_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Triangle.get_facet_type" title="Link to this definition"></a></dt>
<dd><p>Get the element type(s) for the facets of this element.</p>
<p>This method returns the element type(s) that make up the facets (faces) of the current element.
For example, a triangle element has line segment facets, while a prism has both triangular and
quadrilateral facets.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Line</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span><span class="p">,</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">==</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Triangle</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The element type(s) for the facets. Returns either:</p>
<ul class="simple">
<li><p>A single Element type for elements with uniform facets (e.g. Line for Triangle)</p></li>
<li><p>A tuple of Element types for elements with mixed facets (e.g. (Triangle, Quadrilateral) for Prism)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[Type[‘Element’], Tuple[Type[‘Element’], Type[‘Element’]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Triangle.get_contour">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Triangle.get_contour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Triangle.get_contour" title="Link to this definition"></a></dt>
<dd><p>Returns the contour points for a 2D element at the specified order.</p>
<p>For a 2D element, returns points along the element boundary at the given polynomial order.
The points are ordered counterclockwise around the boundary.</p>
<p class="rubric">Examples</p>
<p>Get contour points for a quadrilateral at order 2:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">quad</span> <span class="o">=</span> <span class="n">Quadrilateral</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contour</span> <span class="o">=</span> <span class="n">quad</span><span class="o">.</span><span class="n">get_contour</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contour</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([8, 2])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The polynomial order. Must be &gt;= 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>contour</strong> – Tensor of shape <span class="math notranslate nohighlight">\([N_p, 2]\)</span> containing the <span class="math notranslate nohighlight">\((x,y)\)</span> coordinates of points
along the element boundary, ordered counterclockwise, where <span class="math notranslate nohighlight">\(N_p\)</span> = number of points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Only implemented for 2D elements (dim=2)</p></li>
<li><p>Points are distributed according to the polynomial order</p></li>
<li><p>Points are ordered counterclockwise starting from the first vertex</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Tetrahedron</span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Tetrahedron"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Tetrahedron" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.points">
<span class="sig-name descname"><span class="pre">points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0.,</span> <span class="pre">1.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">1.]])</span></em><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.points" title="Link to this definition"></a></dt>
<dd><p>Coordinates of element vertices
Shape: <span class="math notranslate nohighlight">\([V, D]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.vertex">
<span class="sig-name descname"><span class="pre">vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[3]])</span></em><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.vertex" title="Link to this definition"></a></dt>
<dd><p>Vertex indices for the element
Shape: <span class="math notranslate nohighlight">\([V, 1]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.edge">
<span class="sig-name descname"><span class="pre">edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[2,</span> <span class="pre">3],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1,</span> <span class="pre">3],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1,</span> <span class="pre">2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0,</span> <span class="pre">3],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0,</span> <span class="pre">2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0,</span> <span class="pre">1]])</span></em><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.edge" title="Link to this definition"></a></dt>
<dd><p>Edge connectivity defining pairs of vertex indices
Shape: <span class="math notranslate nohighlight">\([E, 2]\)</span> where <span class="math notranslate nohighlight">\(E\)</span> = number of edges</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.face">
<span class="sig-name descname"><span class="pre">face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">((1,</span> <span class="pre">2,</span> <span class="pre">3),</span> <span class="pre">(0,</span> <span class="pre">2,</span> <span class="pre">3),</span> <span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">3),</span> <span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2))</span></em><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.face" title="Link to this definition"></a></dt>
<dd><p>Face connectivity defining vertex indices for each face.
Shape: Tuple of tuples, each inner tuple contains vertex indices
for one face.</p>
<dl class="simple">
<dt>Example:</dt><dd><p>((0,1,2), (1,2,3)) for two triangular faces</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.cell">
<span class="sig-name descname"><span class="pre">cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]])</span></em><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.cell" title="Link to this definition"></a></dt>
<dd><p>Cell connectivity defining vertex indices for volumetric elements
Shape: <span class="math notranslate nohighlight">\([N_c, V_c]\)</span> where <span class="math notranslate nohighlight">\(N_c\)</span> = number of cells and <span class="math notranslate nohighlight">\(V_c\)</span> = vertices per cell</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.dim" title="Link to this definition"></a></dt>
<dd><p>Spatial dimension of the element (1D, 2D, or 3D)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.n_vertex">
<span class="sig-name descname"><span class="pre">n_vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.n_vertex" title="Link to this definition"></a></dt>
<dd><p>Number of vertices in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.n_edge">
<span class="sig-name descname"><span class="pre">n_edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6</span></em><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.n_edge" title="Link to this definition"></a></dt>
<dd><p>Number of edges in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.n_face">
<span class="sig-name descname"><span class="pre">n_face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.n_face" title="Link to this definition"></a></dt>
<dd><p>Number of faces in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.n_cell">
<span class="sig-name descname"><span class="pre">n_cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.n_cell" title="Link to this definition"></a></dt>
<dd><p>Number of cells in the element</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.get_basis">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Tetrahedron.get_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.get_basis" title="Link to this definition"></a></dt>
<dd><p>Get the basis node coordinates for the element.</p>
<p>This method returns the coordinates of the basis nodes that define the element’s shape functions.
The number and location of basis nodes depends on the polynomial order.</p>
<p>For example:
- For order=1 (linear), returns vertices of the element
- For order=2 (quadratic), returns vertices plus midpoints of edges
- For higher orders, returns additional nodes in the interior</p>
<p>The basis nodes are used to construct the element’s shape functions and define the geometric
mapping between reference and physical elements.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])  # 3 vertices in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0.],</span>
<span class="go">        [1., 0.],</span>
<span class="go">        [0., 1.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Quadratic basis has additional nodes at edge midpoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([6, 2])  # 3 vertices + 3 edge midpoints</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 3])  # 4 vertices in 3D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0., 0.],</span>
<span class="go">        [1., 0., 0.],</span>
<span class="go">        [0., 1., 0.],</span>
<span class="go">        [0., 0., 1.]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor of shape [B, D],
where B is the number of basis nodes and D is the dimension</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.get_polynomial">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Tetrahedron.get_polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.get_polynomial" title="Link to this definition"></a></dt>
<dd><p>Get the polynomial form for the element.</p>
<p>For a given order n, returns a polynomial with terms up to maximum total degree n.
The polynomial will have n_vars equal to the dimension of the element.</p>
<p>For example,</p>
<ul class="simple">
<li><p>For a 2D element with order=1:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y\)</span></p></li>
<li><p>For order=2:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y + a_3x^2 + a_4xy + a_5y^2\)</span></p></li>
</ul>
<p>The exact form and number of terms depends on the specific element type.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 2D element</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Quadratic terms: 1, x, y, x^2, xy, y^2</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 3D element</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y, z</span>
<span class="go">4</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong> – A polynomial object with number of variables equal to the element dimension,</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.get_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Tetrahedron.get_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.get_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the element.</p>
<dl class="simple">
<dt>For elements with single type of facets (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of two tensors containing quadrature weights and points</p></li>
</ul>
</dd>
<dt>For elements with mixed facets (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of four tensors containing quadrature weights and points for each facet type</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Number of quadrature points</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_points, dimension]</span>
<span class="go">torch.Size([1, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># More quadrature points for higher order</span>
<span class="go">torch.Size([3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># 3D points</span>
<span class="go">torch.Size([1, 3])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – quadrature order</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>- quadrature_weights</strong> (<em>torch.Tensor</em>) – 1D Tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><strong>- quadrature_points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape <span class="math notranslate nohighlight">\([N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points and <span class="math notranslate nohighlight">\(D\)</span> = dimension of element (1, 2, or 3)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.get_facet">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Tetrahedron.get_facet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.get_facet" title="Link to this definition"></a></dt>
<dd><p>Get the facet connectivity for the element.</p>
<p>For elements with uniform facets (e.g. Triangle, Quadrilateral), returns a single tensor
containing facet connectivity. For elements with mixed facets (e.g. Prism), returns a tuple
of tensors containing facet connectivity for each facet type.</p>
<p>The facet connectivity defines how the basis nodes are connected to form each facet of the element.
For example, for a triangle element with linear basis (order=1), the facet connectivity would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># First edge connects nodes 0 and 1</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># Second edge connects nodes 1 and 2</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<p>For a prism element which has both triangular and quadrilateral facets, would return:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span><span class="p">)</span>
</pre></div>
</div>
<p>Where tri_facets contains connectivity for the triangular faces and quad_facets contains
connectivity for the quadrilateral faces.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span>
<span class="go">tensor([[0, 1],  # First edge connects nodes 0 and 1</span>
<span class="go">        [1, 2],  # Second edge connects nodes 1 and 2</span>
<span class="go">        [2, 0]]) # Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher order elements have more nodes per facet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 3])  # 3 edges with 3 nodes each</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Two triangular faces</span>
<span class="go">torch.Size([2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Three quadrilateral faces</span>
<span class="go">torch.Size([3, 4])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>if cls.is_mix_facet</em> –</p>
<ul>
<li><dl class="simple">
<dt>tri_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_t\)</span>, <span class="math notranslate nohighlight">\(B_{ft}\)</span>] where <span class="math notranslate nohighlight">\(F_t\)</span> is number of triangular facets, <span class="math notranslate nohighlight">\(B_{ft}\)</span> is basis nodes per triangular facet</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>quad_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_q\)</span>, <span class="math notranslate nohighlight">\(B_{fq}\)</span>] where <span class="math notranslate nohighlight">\(F_q\)</span> is number of quadrilateral facets, <span class="math notranslate nohighlight">\(B_{fq}\)</span> is basis nodes per quadrilateral facet</p>
</dd>
</dl>
</li>
</ul>
</li>
<li><p><em>else</em> –</p>
<ul>
<li><dl class="simple">
<dt>facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F\)</span>, <span class="math notranslate nohighlight">\(B_f\)</span>] where <span class="math notranslate nohighlight">\(F\)</span> is number of facets, <span class="math notranslate nohighlight">\(B_f\)</span> is basis nodes per facet</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.get_facet_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Tetrahedron.get_facet_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.get_facet_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the facets of the element.</p>
<p>This method returns quadrature rules for integrating over element facets. The return format depends on whether the element has uniform or mixed facet types.</p>
<dl class="simple">
<dt><strong>For elements with uniform facets</strong> (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (weights, points) tensors</p></li>
<li><p>weights: quadrature weights for each facet point</p></li>
<li><p>points: quadrature point coordinates</p></li>
</ul>
</dd>
<dt><strong>For elements with mixed facets</strong> (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (tri_weights, tri_points, quad_weights, quad_points)</p></li>
<li><p>tri_weights: quadrature weights for triangular facets</p></li>
<li><p>tri_points: quadrature points for triangular facets</p></li>
<li><p>quad_weights: quadrature weights for quadrilateral facets</p></li>
<li><p>quad_points: quadrature points for quadrilateral facets</p></li>
</ul>
</dd>
</dl>
<p>The quadrature points can be returned either in the reference element coordinates (transform=True) or in facet-local coordinates (transform=False).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for tetrahedron element with uniform triangular facets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1]</span>
<span class="go">torch.Size([4, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([4, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for prism element with mixed facets (triangular and quadrilateral)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="p">,</span> <span class="n">tri_p</span><span class="p">,</span> <span class="n">quad_w</span><span class="p">,</span> <span class="n">quad_p</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1]</span>
<span class="go">torch.Size([2, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_p</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([2, 1, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_w</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1]</span>
<span class="go">torch.Size([3, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_p</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([3, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with transform=False returns points in facet-local coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1]</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1, dim-1=1]</span>
<span class="go">torch.Size([1, 1])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Quadrature order. Default is 1.</p></li>
<li><p><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to return the transformed facet quadrature.
If True, returns points in reference element coordinates with shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span>, where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.
If False, returns points in facet-local coordinates with shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span>, where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>) – The float data type of the polynomial.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device of the polynomial.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><em>For elements with uniform facets</em> –</p>
<dl class="simple">
<dt>quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True,  2D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet</p>
</dd>
<dt>quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
<li><p><em>For elements with mixed facets</em> –</p>
<dl class="simple">
<dt>tri_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p>
</dd>
<dt>tri_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
<dt>quad_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p>
</dd>
<dt>quad_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Tetrahedron.get_facet_type">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><span class="pre">Type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Tetrahedron.get_facet_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Tetrahedron.get_facet_type" title="Link to this definition"></a></dt>
<dd><p>Get the element type(s) for the facets of this element.</p>
<p>This method returns the element type(s) that make up the facets (faces) of the current element.
For example, a triangle element has line segment facets, while a prism has both triangular and
quadrilateral facets.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Line</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span><span class="p">,</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">==</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Triangle</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The element type(s) for the facets. Returns either:</p>
<ul class="simple">
<li><p>A single Element type for elements with uniform facets (e.g. Line for Triangle)</p></li>
<li><p>A tuple of Element types for elements with mixed facets (e.g. (Triangle, Quadrilateral) for Prism)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[Type[‘Element’], Tuple[Type[‘Element’], Type[‘Element’]]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Quadrilateral</span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Quadrilateral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Quadrilateral" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.points">
<span class="sig-name descname"><span class="pre">points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0.,</span> <span class="pre">1.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.,</span> <span class="pre">1.]])</span></em><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.points" title="Link to this definition"></a></dt>
<dd><p>Coordinates of element vertices
Shape: <span class="math notranslate nohighlight">\([V, D]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.vertex">
<span class="sig-name descname"><span class="pre">vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[3]])</span></em><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.vertex" title="Link to this definition"></a></dt>
<dd><p>Vertex indices for the element
Shape: <span class="math notranslate nohighlight">\([V, 1]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.edge">
<span class="sig-name descname"><span class="pre">edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0,</span> <span class="pre">1],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0,</span> <span class="pre">2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1,</span> <span class="pre">3],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[2,</span> <span class="pre">3]])</span></em><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.edge" title="Link to this definition"></a></dt>
<dd><p>Edge connectivity defining pairs of vertex indices
Shape: <span class="math notranslate nohighlight">\([E, 2]\)</span> where <span class="math notranslate nohighlight">\(E\)</span> = number of edges</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.face">
<span class="sig-name descname"><span class="pre">face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">((0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3),)</span></em><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.face" title="Link to this definition"></a></dt>
<dd><p>Face connectivity defining vertex indices for each face.
Shape: Tuple of tuples, each inner tuple contains vertex indices
for one face.</p>
<dl class="simple">
<dt>Example:</dt><dd><p>((0,1,2), (1,2,3)) for two triangular faces</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.dim" title="Link to this definition"></a></dt>
<dd><p>Spatial dimension of the element (1D, 2D, or 3D)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.n_vertex">
<span class="sig-name descname"><span class="pre">n_vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.n_vertex" title="Link to this definition"></a></dt>
<dd><p>Number of vertices in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.n_edge">
<span class="sig-name descname"><span class="pre">n_edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.n_edge" title="Link to this definition"></a></dt>
<dd><p>Number of edges in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.n_face">
<span class="sig-name descname"><span class="pre">n_face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.n_face" title="Link to this definition"></a></dt>
<dd><p>Number of faces in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.n_cell">
<span class="sig-name descname"><span class="pre">n_cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.n_cell" title="Link to this definition"></a></dt>
<dd><p>Number of cells in the element</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.get_basis">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Quadrilateral.get_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.get_basis" title="Link to this definition"></a></dt>
<dd><p>Get the basis node coordinates for the element.</p>
<p>This method returns the coordinates of the basis nodes that define the element’s shape functions.
The number and location of basis nodes depends on the polynomial order.</p>
<p>For example:
- For order=1 (linear), returns vertices of the element
- For order=2 (quadratic), returns vertices plus midpoints of edges
- For higher orders, returns additional nodes in the interior</p>
<p>The basis nodes are used to construct the element’s shape functions and define the geometric
mapping between reference and physical elements.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])  # 3 vertices in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0.],</span>
<span class="go">        [1., 0.],</span>
<span class="go">        [0., 1.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Quadratic basis has additional nodes at edge midpoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([6, 2])  # 3 vertices + 3 edge midpoints</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 3])  # 4 vertices in 3D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0., 0.],</span>
<span class="go">        [1., 0., 0.],</span>
<span class="go">        [0., 1., 0.],</span>
<span class="go">        [0., 0., 1.]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor of shape [B, D],
where B is the number of basis nodes and D is the dimension</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.get_polynomial">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Quadrilateral.get_polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.get_polynomial" title="Link to this definition"></a></dt>
<dd><p>Get the polynomial form for the element.</p>
<p>For a given order n, returns a polynomial with terms up to maximum total degree n.
The polynomial will have n_vars equal to the dimension of the element.</p>
<p>For example,</p>
<ul class="simple">
<li><p>For a 2D element with order=1:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y\)</span></p></li>
<li><p>For order=2:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y + a_3x^2 + a_4xy + a_5y^2\)</span></p></li>
</ul>
<p>The exact form and number of terms depends on the specific element type.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 2D element</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Quadratic terms: 1, x, y, x^2, xy, y^2</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 3D element</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y, z</span>
<span class="go">4</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong> – A polynomial object with number of variables equal to the element dimension,</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.get_facet">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Quadrilateral.get_facet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.get_facet" title="Link to this definition"></a></dt>
<dd><p>Get the facet connectivity for the element.</p>
<p>For elements with uniform facets (e.g. Triangle, Quadrilateral), returns a single tensor
containing facet connectivity. For elements with mixed facets (e.g. Prism), returns a tuple
of tensors containing facet connectivity for each facet type.</p>
<p>The facet connectivity defines how the basis nodes are connected to form each facet of the element.
For example, for a triangle element with linear basis (order=1), the facet connectivity would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># First edge connects nodes 0 and 1</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># Second edge connects nodes 1 and 2</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<p>For a prism element which has both triangular and quadrilateral facets, would return:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span><span class="p">)</span>
</pre></div>
</div>
<p>Where tri_facets contains connectivity for the triangular faces and quad_facets contains
connectivity for the quadrilateral faces.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span>
<span class="go">tensor([[0, 1],  # First edge connects nodes 0 and 1</span>
<span class="go">        [1, 2],  # Second edge connects nodes 1 and 2</span>
<span class="go">        [2, 0]]) # Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher order elements have more nodes per facet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 3])  # 3 edges with 3 nodes each</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Two triangular faces</span>
<span class="go">torch.Size([2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Three quadrilateral faces</span>
<span class="go">torch.Size([3, 4])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>if cls.is_mix_facet</em> –</p>
<ul>
<li><dl class="simple">
<dt>tri_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_t\)</span>, <span class="math notranslate nohighlight">\(B_{ft}\)</span>] where <span class="math notranslate nohighlight">\(F_t\)</span> is number of triangular facets, <span class="math notranslate nohighlight">\(B_{ft}\)</span> is basis nodes per triangular facet</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>quad_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_q\)</span>, <span class="math notranslate nohighlight">\(B_{fq}\)</span>] where <span class="math notranslate nohighlight">\(F_q\)</span> is number of quadrilateral facets, <span class="math notranslate nohighlight">\(B_{fq}\)</span> is basis nodes per quadrilateral facet</p>
</dd>
</dl>
</li>
</ul>
</li>
<li><p><em>else</em> –</p>
<ul>
<li><dl class="simple">
<dt>facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F\)</span>, <span class="math notranslate nohighlight">\(B_f\)</span>] where <span class="math notranslate nohighlight">\(F\)</span> is number of facets, <span class="math notranslate nohighlight">\(B_f\)</span> is basis nodes per facet</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.get_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Quadrilateral.get_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.get_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the element.</p>
<dl class="simple">
<dt>For elements with single type of facets (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of two tensors containing quadrature weights and points</p></li>
</ul>
</dd>
<dt>For elements with mixed facets (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of four tensors containing quadrature weights and points for each facet type</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Number of quadrature points</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_points, dimension]</span>
<span class="go">torch.Size([1, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># More quadrature points for higher order</span>
<span class="go">torch.Size([3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># 3D points</span>
<span class="go">torch.Size([1, 3])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – quadrature order</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>- quadrature_weights</strong> (<em>torch.Tensor</em>) – 1D Tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><strong>- quadrature_points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape <span class="math notranslate nohighlight">\([N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points and <span class="math notranslate nohighlight">\(D\)</span> = dimension of element (1, 2, or 3)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.get_facet_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Quadrilateral.get_facet_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.get_facet_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the facets of the element.</p>
<p>This method returns quadrature rules for integrating over element facets. The return format depends on whether the element has uniform or mixed facet types.</p>
<dl class="simple">
<dt><strong>For elements with uniform facets</strong> (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (weights, points) tensors</p></li>
<li><p>weights: quadrature weights for each facet point</p></li>
<li><p>points: quadrature point coordinates</p></li>
</ul>
</dd>
<dt><strong>For elements with mixed facets</strong> (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (tri_weights, tri_points, quad_weights, quad_points)</p></li>
<li><p>tri_weights: quadrature weights for triangular facets</p></li>
<li><p>tri_points: quadrature points for triangular facets</p></li>
<li><p>quad_weights: quadrature weights for quadrilateral facets</p></li>
<li><p>quad_points: quadrature points for quadrilateral facets</p></li>
</ul>
</dd>
</dl>
<p>The quadrature points can be returned either in the reference element coordinates (transform=True) or in facet-local coordinates (transform=False).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for tetrahedron element with uniform triangular facets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1]</span>
<span class="go">torch.Size([4, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([4, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for prism element with mixed facets (triangular and quadrilateral)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="p">,</span> <span class="n">tri_p</span><span class="p">,</span> <span class="n">quad_w</span><span class="p">,</span> <span class="n">quad_p</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1]</span>
<span class="go">torch.Size([2, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_p</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([2, 1, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_w</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1]</span>
<span class="go">torch.Size([3, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_p</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([3, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with transform=False returns points in facet-local coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1]</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1, dim-1=1]</span>
<span class="go">torch.Size([1, 1])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Quadrature order. Default is 1.</p></li>
<li><p><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to return the transformed facet quadrature.
If True, returns points in reference element coordinates with shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span>, where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.
If False, returns points in facet-local coordinates with shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span>, where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>) – The float data type of the polynomial.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device of the polynomial.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><em>For elements with uniform facets</em> –</p>
<dl class="simple">
<dt>quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True,  2D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet</p>
</dd>
<dt>quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
<li><p><em>For elements with mixed facets</em> –</p>
<dl class="simple">
<dt>tri_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p>
</dd>
<dt>tri_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
<dt>quad_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p>
</dd>
<dt>quad_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.get_facet_type">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><span class="pre">Type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Quadrilateral.get_facet_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.get_facet_type" title="Link to this definition"></a></dt>
<dd><p>Get the element type(s) for the facets of this element.</p>
<p>This method returns the element type(s) that make up the facets (faces) of the current element.
For example, a triangle element has line segment facets, while a prism has both triangular and
quadrilateral facets.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Line</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span><span class="p">,</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">==</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Triangle</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The element type(s) for the facets. Returns either:</p>
<ul class="simple">
<li><p>A single Element type for elements with uniform facets (e.g. Line for Triangle)</p></li>
<li><p>A tuple of Element types for elements with mixed facets (e.g. (Triangle, Quadrilateral) for Prism)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[Type[‘Element’], Tuple[Type[‘Element’], Type[‘Element’]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Quadrilateral.get_coutour">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_coutour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Quadrilateral.get_coutour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Quadrilateral.get_coutour" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Hexahedron</span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Hexahedron"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Hexahedron" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.points">
<span class="sig-name descname"><span class="pre">points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0.,</span> <span class="pre">1.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.,</span> <span class="pre">1.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">1.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.,</span> <span class="pre">0.,</span> <span class="pre">1.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0.,</span> <span class="pre">1.,</span> <span class="pre">1.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.,</span> <span class="pre">1.,</span> <span class="pre">1.]])</span></em><a class="headerlink" href="#tensormesh.element.element.Hexahedron.points" title="Link to this definition"></a></dt>
<dd><p>Coordinates of element vertices
Shape: <span class="math notranslate nohighlight">\([V, D]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.vertex">
<span class="sig-name descname"><span class="pre">vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[3],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[4],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[5],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[6],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[7]])</span></em><a class="headerlink" href="#tensormesh.element.element.Hexahedron.vertex" title="Link to this definition"></a></dt>
<dd><p>Vertex indices for the element
Shape: <span class="math notranslate nohighlight">\([V, 1]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.edge">
<span class="sig-name descname"><span class="pre">edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0,</span> <span class="pre">1],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0,</span> <span class="pre">2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0,</span> <span class="pre">4],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1,</span> <span class="pre">3],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1,</span> <span class="pre">5],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[2,</span> <span class="pre">3],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[2,</span> <span class="pre">6],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[3,</span> <span class="pre">7],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[4,</span> <span class="pre">5],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[4,</span> <span class="pre">6],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[5,</span> <span class="pre">7],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[6,</span> <span class="pre">7]])</span></em><a class="headerlink" href="#tensormesh.element.element.Hexahedron.edge" title="Link to this definition"></a></dt>
<dd><p>Edge connectivity defining pairs of vertex indices
Shape: <span class="math notranslate nohighlight">\([E, 2]\)</span> where <span class="math notranslate nohighlight">\(E\)</span> = number of edges</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.face">
<span class="sig-name descname"><span class="pre">face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">((0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3),</span> <span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">4,</span> <span class="pre">5),</span> <span class="pre">(0,</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">6),</span> <span class="pre">(1,</span> <span class="pre">3,</span> <span class="pre">5,</span> <span class="pre">7),</span> <span class="pre">(2,</span> <span class="pre">3,</span> <span class="pre">6,</span> <span class="pre">7),</span> <span class="pre">(4,</span> <span class="pre">5,</span> <span class="pre">6,</span> <span class="pre">7))</span></em><a class="headerlink" href="#tensormesh.element.element.Hexahedron.face" title="Link to this definition"></a></dt>
<dd><p>Face connectivity defining vertex indices for each face.
Shape: Tuple of tuples, each inner tuple contains vertex indices
for one face.</p>
<dl class="simple">
<dt>Example:</dt><dd><p>((0,1,2), (1,2,3)) for two triangular faces</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.cell">
<span class="sig-name descname"><span class="pre">cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">6,</span> <span class="pre">7]])</span></em><a class="headerlink" href="#tensormesh.element.element.Hexahedron.cell" title="Link to this definition"></a></dt>
<dd><p>Cell connectivity defining vertex indices for volumetric elements
Shape: <span class="math notranslate nohighlight">\([N_c, V_c]\)</span> where <span class="math notranslate nohighlight">\(N_c\)</span> = number of cells and <span class="math notranslate nohighlight">\(V_c\)</span> = vertices per cell</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#tensormesh.element.element.Hexahedron.dim" title="Link to this definition"></a></dt>
<dd><p>Spatial dimension of the element (1D, 2D, or 3D)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.n_vertex">
<span class="sig-name descname"><span class="pre">n_vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#tensormesh.element.element.Hexahedron.n_vertex" title="Link to this definition"></a></dt>
<dd><p>Number of vertices in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.n_edge">
<span class="sig-name descname"><span class="pre">n_edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">12</span></em><a class="headerlink" href="#tensormesh.element.element.Hexahedron.n_edge" title="Link to this definition"></a></dt>
<dd><p>Number of edges in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.n_face">
<span class="sig-name descname"><span class="pre">n_face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6</span></em><a class="headerlink" href="#tensormesh.element.element.Hexahedron.n_face" title="Link to this definition"></a></dt>
<dd><p>Number of faces in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.n_cell">
<span class="sig-name descname"><span class="pre">n_cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#tensormesh.element.element.Hexahedron.n_cell" title="Link to this definition"></a></dt>
<dd><p>Number of cells in the element</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.get_basis">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Hexahedron.get_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Hexahedron.get_basis" title="Link to this definition"></a></dt>
<dd><p>Get the basis node coordinates for the element.</p>
<p>This method returns the coordinates of the basis nodes that define the element’s shape functions.
The number and location of basis nodes depends on the polynomial order.</p>
<p>For example:
- For order=1 (linear), returns vertices of the element
- For order=2 (quadratic), returns vertices plus midpoints of edges
- For higher orders, returns additional nodes in the interior</p>
<p>The basis nodes are used to construct the element’s shape functions and define the geometric
mapping between reference and physical elements.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])  # 3 vertices in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0.],</span>
<span class="go">        [1., 0.],</span>
<span class="go">        [0., 1.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Quadratic basis has additional nodes at edge midpoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([6, 2])  # 3 vertices + 3 edge midpoints</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 3])  # 4 vertices in 3D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0., 0.],</span>
<span class="go">        [1., 0., 0.],</span>
<span class="go">        [0., 1., 0.],</span>
<span class="go">        [0., 0., 1.]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor of shape [B, D],
where B is the number of basis nodes and D is the dimension</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.get_polynomial">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Hexahedron.get_polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Hexahedron.get_polynomial" title="Link to this definition"></a></dt>
<dd><p>Get the polynomial form for the element.</p>
<p>For a given order n, returns a polynomial with terms up to maximum total degree n.
The polynomial will have n_vars equal to the dimension of the element.</p>
<p>For example,</p>
<ul class="simple">
<li><p>For a 2D element with order=1:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y\)</span></p></li>
<li><p>For order=2:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y + a_3x^2 + a_4xy + a_5y^2\)</span></p></li>
</ul>
<p>The exact form and number of terms depends on the specific element type.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 2D element</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Quadratic terms: 1, x, y, x^2, xy, y^2</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 3D element</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y, z</span>
<span class="go">4</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong> – A polynomial object with number of variables equal to the element dimension,</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.get_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Hexahedron.get_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Hexahedron.get_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the element.</p>
<dl class="simple">
<dt>For elements with single type of facets (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of two tensors containing quadrature weights and points</p></li>
</ul>
</dd>
<dt>For elements with mixed facets (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of four tensors containing quadrature weights and points for each facet type</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Number of quadrature points</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_points, dimension]</span>
<span class="go">torch.Size([1, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># More quadrature points for higher order</span>
<span class="go">torch.Size([3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># 3D points</span>
<span class="go">torch.Size([1, 3])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – quadrature order</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>- quadrature_weights</strong> (<em>torch.Tensor</em>) – 1D Tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><strong>- quadrature_points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape <span class="math notranslate nohighlight">\([N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points and <span class="math notranslate nohighlight">\(D\)</span> = dimension of element (1, 2, or 3)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.get_facet">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Hexahedron.get_facet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Hexahedron.get_facet" title="Link to this definition"></a></dt>
<dd><p>Get the facet connectivity for the element.</p>
<p>For elements with uniform facets (e.g. Triangle, Quadrilateral), returns a single tensor
containing facet connectivity. For elements with mixed facets (e.g. Prism), returns a tuple
of tensors containing facet connectivity for each facet type.</p>
<p>The facet connectivity defines how the basis nodes are connected to form each facet of the element.
For example, for a triangle element with linear basis (order=1), the facet connectivity would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># First edge connects nodes 0 and 1</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># Second edge connects nodes 1 and 2</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<p>For a prism element which has both triangular and quadrilateral facets, would return:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span><span class="p">)</span>
</pre></div>
</div>
<p>Where tri_facets contains connectivity for the triangular faces and quad_facets contains
connectivity for the quadrilateral faces.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span>
<span class="go">tensor([[0, 1],  # First edge connects nodes 0 and 1</span>
<span class="go">        [1, 2],  # Second edge connects nodes 1 and 2</span>
<span class="go">        [2, 0]]) # Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher order elements have more nodes per facet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 3])  # 3 edges with 3 nodes each</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Two triangular faces</span>
<span class="go">torch.Size([2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Three quadrilateral faces</span>
<span class="go">torch.Size([3, 4])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>if cls.is_mix_facet</em> –</p>
<ul>
<li><dl class="simple">
<dt>tri_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_t\)</span>, <span class="math notranslate nohighlight">\(B_{ft}\)</span>] where <span class="math notranslate nohighlight">\(F_t\)</span> is number of triangular facets, <span class="math notranslate nohighlight">\(B_{ft}\)</span> is basis nodes per triangular facet</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>quad_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_q\)</span>, <span class="math notranslate nohighlight">\(B_{fq}\)</span>] where <span class="math notranslate nohighlight">\(F_q\)</span> is number of quadrilateral facets, <span class="math notranslate nohighlight">\(B_{fq}\)</span> is basis nodes per quadrilateral facet</p>
</dd>
</dl>
</li>
</ul>
</li>
<li><p><em>else</em> –</p>
<ul>
<li><dl class="simple">
<dt>facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F\)</span>, <span class="math notranslate nohighlight">\(B_f\)</span>] where <span class="math notranslate nohighlight">\(F\)</span> is number of facets, <span class="math notranslate nohighlight">\(B_f\)</span> is basis nodes per facet</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.get_facet_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Hexahedron.get_facet_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Hexahedron.get_facet_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the facets of the element.</p>
<p>This method returns quadrature rules for integrating over element facets. The return format depends on whether the element has uniform or mixed facet types.</p>
<dl class="simple">
<dt><strong>For elements with uniform facets</strong> (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (weights, points) tensors</p></li>
<li><p>weights: quadrature weights for each facet point</p></li>
<li><p>points: quadrature point coordinates</p></li>
</ul>
</dd>
<dt><strong>For elements with mixed facets</strong> (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (tri_weights, tri_points, quad_weights, quad_points)</p></li>
<li><p>tri_weights: quadrature weights for triangular facets</p></li>
<li><p>tri_points: quadrature points for triangular facets</p></li>
<li><p>quad_weights: quadrature weights for quadrilateral facets</p></li>
<li><p>quad_points: quadrature points for quadrilateral facets</p></li>
</ul>
</dd>
</dl>
<p>The quadrature points can be returned either in the reference element coordinates (transform=True) or in facet-local coordinates (transform=False).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for tetrahedron element with uniform triangular facets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1]</span>
<span class="go">torch.Size([4, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([4, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for prism element with mixed facets (triangular and quadrilateral)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="p">,</span> <span class="n">tri_p</span><span class="p">,</span> <span class="n">quad_w</span><span class="p">,</span> <span class="n">quad_p</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1]</span>
<span class="go">torch.Size([2, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_p</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([2, 1, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_w</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1]</span>
<span class="go">torch.Size([3, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_p</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([3, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with transform=False returns points in facet-local coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1]</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1, dim-1=1]</span>
<span class="go">torch.Size([1, 1])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Quadrature order. Default is 1.</p></li>
<li><p><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to return the transformed facet quadrature.
If True, returns points in reference element coordinates with shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span>, where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.
If False, returns points in facet-local coordinates with shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span>, where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>) – The float data type of the polynomial.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device of the polynomial.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><em>For elements with uniform facets</em> –</p>
<dl class="simple">
<dt>quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True,  2D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet</p>
</dd>
<dt>quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
<li><p><em>For elements with mixed facets</em> –</p>
<dl class="simple">
<dt>tri_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p>
</dd>
<dt>tri_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
<dt>quad_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p>
</dd>
<dt>quad_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Hexahedron.get_facet_type">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><span class="pre">Type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Hexahedron.get_facet_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Hexahedron.get_facet_type" title="Link to this definition"></a></dt>
<dd><p>Get the element type(s) for the facets of this element.</p>
<p>This method returns the element type(s) that make up the facets (faces) of the current element.
For example, a triangle element has line segment facets, while a prism has both triangular and
quadrilateral facets.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Line</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span><span class="p">,</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">==</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Triangle</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The element type(s) for the facets. Returns either:</p>
<ul class="simple">
<li><p>A single Element type for elements with uniform facets (e.g. Line for Triangle)</p></li>
<li><p>A tuple of Element types for elements with mixed facets (e.g. (Triangle, Quadrilateral) for Prism)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[Type[‘Element’], Tuple[Type[‘Element’], Type[‘Element’]]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Prism</span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Prism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Prism" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.points">
<span class="sig-name descname"><span class="pre">points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0.,</span> <span class="pre">1.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">1.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.,</span> <span class="pre">0.,</span> <span class="pre">1.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0.,</span> <span class="pre">1.,</span> <span class="pre">1.]])</span></em><a class="headerlink" href="#tensormesh.element.element.Prism.points" title="Link to this definition"></a></dt>
<dd><p>Coordinates of element vertices
Shape: <span class="math notranslate nohighlight">\([V, D]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.vertex">
<span class="sig-name descname"><span class="pre">vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[3],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[4],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[5]])</span></em><a class="headerlink" href="#tensormesh.element.element.Prism.vertex" title="Link to this definition"></a></dt>
<dd><p>Vertex indices for the element
Shape: <span class="math notranslate nohighlight">\([V, 1]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.edge">
<span class="sig-name descname"><span class="pre">edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0,</span> <span class="pre">1],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0,</span> <span class="pre">2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0,</span> <span class="pre">3],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1,</span> <span class="pre">2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1,</span> <span class="pre">4],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[2,</span> <span class="pre">5],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[3,</span> <span class="pre">4],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[3,</span> <span class="pre">5],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[4,</span> <span class="pre">5]])</span></em><a class="headerlink" href="#tensormesh.element.element.Prism.edge" title="Link to this definition"></a></dt>
<dd><p>Edge connectivity defining pairs of vertex indices
Shape: <span class="math notranslate nohighlight">\([E, 2]\)</span> where <span class="math notranslate nohighlight">\(E\)</span> = number of edges</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.face">
<span class="sig-name descname"><span class="pre">face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">((0,</span> <span class="pre">1,</span> <span class="pre">2),</span> <span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">3,</span> <span class="pre">4),</span> <span class="pre">(0,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">5),</span> <span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">5),</span> <span class="pre">(3,</span> <span class="pre">4,</span> <span class="pre">5))</span></em><a class="headerlink" href="#tensormesh.element.element.Prism.face" title="Link to this definition"></a></dt>
<dd><p>Face connectivity defining vertex indices for each face.
Shape: Tuple of tuples, each inner tuple contains vertex indices
for one face.</p>
<dl class="simple">
<dt>Example:</dt><dd><p>((0,1,2), (1,2,3)) for two triangular faces</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.cell">
<span class="sig-name descname"><span class="pre">cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5]])</span></em><a class="headerlink" href="#tensormesh.element.element.Prism.cell" title="Link to this definition"></a></dt>
<dd><p>Cell connectivity defining vertex indices for volumetric elements
Shape: <span class="math notranslate nohighlight">\([N_c, V_c]\)</span> where <span class="math notranslate nohighlight">\(N_c\)</span> = number of cells and <span class="math notranslate nohighlight">\(V_c\)</span> = vertices per cell</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#tensormesh.element.element.Prism.dim" title="Link to this definition"></a></dt>
<dd><p>Spatial dimension of the element (1D, 2D, or 3D)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.n_vertex">
<span class="sig-name descname"><span class="pre">n_vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6</span></em><a class="headerlink" href="#tensormesh.element.element.Prism.n_vertex" title="Link to this definition"></a></dt>
<dd><p>Number of vertices in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.n_edge">
<span class="sig-name descname"><span class="pre">n_edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">9</span></em><a class="headerlink" href="#tensormesh.element.element.Prism.n_edge" title="Link to this definition"></a></dt>
<dd><p>Number of edges in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.n_face">
<span class="sig-name descname"><span class="pre">n_face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#tensormesh.element.element.Prism.n_face" title="Link to this definition"></a></dt>
<dd><p>Number of faces in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.n_cell">
<span class="sig-name descname"><span class="pre">n_cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#tensormesh.element.element.Prism.n_cell" title="Link to this definition"></a></dt>
<dd><p>Number of cells in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.is_mix_facet">
<span class="sig-name descname"><span class="pre">is_mix_facet</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#tensormesh.element.element.Prism.is_mix_facet" title="Link to this definition"></a></dt>
<dd><p>Boolean indicating whether the element has mixed facet types.</p>
<p>False indicates uniform facets (e.g. all triangles or all quads).
True indicates mixed facets (e.g. prism or pyramid).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.get_basis">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Prism.get_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Prism.get_basis" title="Link to this definition"></a></dt>
<dd><p>Get the basis node coordinates for the element.</p>
<p>This method returns the coordinates of the basis nodes that define the element’s shape functions.
The number and location of basis nodes depends on the polynomial order.</p>
<p>For example:
- For order=1 (linear), returns vertices of the element
- For order=2 (quadratic), returns vertices plus midpoints of edges
- For higher orders, returns additional nodes in the interior</p>
<p>The basis nodes are used to construct the element’s shape functions and define the geometric
mapping between reference and physical elements.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])  # 3 vertices in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0.],</span>
<span class="go">        [1., 0.],</span>
<span class="go">        [0., 1.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Quadratic basis has additional nodes at edge midpoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([6, 2])  # 3 vertices + 3 edge midpoints</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 3])  # 4 vertices in 3D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0., 0.],</span>
<span class="go">        [1., 0., 0.],</span>
<span class="go">        [0., 1., 0.],</span>
<span class="go">        [0., 0., 1.]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor of shape [B, D],
where B is the number of basis nodes and D is the dimension</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.get_polynomial">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Prism.get_polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Prism.get_polynomial" title="Link to this definition"></a></dt>
<dd><p>Get the polynomial form for the element.</p>
<p>For a given order n, returns a polynomial with terms up to maximum total degree n.
The polynomial will have n_vars equal to the dimension of the element.</p>
<p>For example,</p>
<ul class="simple">
<li><p>For a 2D element with order=1:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y\)</span></p></li>
<li><p>For order=2:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y + a_3x^2 + a_4xy + a_5y^2\)</span></p></li>
</ul>
<p>The exact form and number of terms depends on the specific element type.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 2D element</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Quadratic terms: 1, x, y, x^2, xy, y^2</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 3D element</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y, z</span>
<span class="go">4</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong> – A polynomial object with number of variables equal to the element dimension,</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.get_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Prism.get_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Prism.get_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the element.</p>
<dl class="simple">
<dt>For elements with single type of facets (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of two tensors containing quadrature weights and points</p></li>
</ul>
</dd>
<dt>For elements with mixed facets (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of four tensors containing quadrature weights and points for each facet type</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Number of quadrature points</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_points, dimension]</span>
<span class="go">torch.Size([1, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># More quadrature points for higher order</span>
<span class="go">torch.Size([3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># 3D points</span>
<span class="go">torch.Size([1, 3])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – quadrature order</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>- quadrature_weights</strong> (<em>torch.Tensor</em>) – 1D Tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><strong>- quadrature_points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape <span class="math notranslate nohighlight">\([N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points and <span class="math notranslate nohighlight">\(D\)</span> = dimension of element (1, 2, or 3)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.get_facet">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Prism.get_facet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Prism.get_facet" title="Link to this definition"></a></dt>
<dd><p>Get the facet connectivity for the element.</p>
<p>For elements with uniform facets (e.g. Triangle, Quadrilateral), returns a single tensor
containing facet connectivity. For elements with mixed facets (e.g. Prism), returns a tuple
of tensors containing facet connectivity for each facet type.</p>
<p>The facet connectivity defines how the basis nodes are connected to form each facet of the element.
For example, for a triangle element with linear basis (order=1), the facet connectivity would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># First edge connects nodes 0 and 1</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># Second edge connects nodes 1 and 2</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<p>For a prism element which has both triangular and quadrilateral facets, would return:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span><span class="p">)</span>
</pre></div>
</div>
<p>Where tri_facets contains connectivity for the triangular faces and quad_facets contains
connectivity for the quadrilateral faces.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span>
<span class="go">tensor([[0, 1],  # First edge connects nodes 0 and 1</span>
<span class="go">        [1, 2],  # Second edge connects nodes 1 and 2</span>
<span class="go">        [2, 0]]) # Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher order elements have more nodes per facet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 3])  # 3 edges with 3 nodes each</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Two triangular faces</span>
<span class="go">torch.Size([2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Three quadrilateral faces</span>
<span class="go">torch.Size([3, 4])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>if cls.is_mix_facet</em> –</p>
<ul>
<li><dl class="simple">
<dt>tri_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_t\)</span>, <span class="math notranslate nohighlight">\(B_{ft}\)</span>] where <span class="math notranslate nohighlight">\(F_t\)</span> is number of triangular facets, <span class="math notranslate nohighlight">\(B_{ft}\)</span> is basis nodes per triangular facet</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>quad_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_q\)</span>, <span class="math notranslate nohighlight">\(B_{fq}\)</span>] where <span class="math notranslate nohighlight">\(F_q\)</span> is number of quadrilateral facets, <span class="math notranslate nohighlight">\(B_{fq}\)</span> is basis nodes per quadrilateral facet</p>
</dd>
</dl>
</li>
</ul>
</li>
<li><p><em>else</em> –</p>
<ul>
<li><dl class="simple">
<dt>facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F\)</span>, <span class="math notranslate nohighlight">\(B_f\)</span>] where <span class="math notranslate nohighlight">\(F\)</span> is number of facets, <span class="math notranslate nohighlight">\(B_f\)</span> is basis nodes per facet</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.get_facet_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Prism.get_facet_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Prism.get_facet_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the facets of the element.</p>
<p>This method returns quadrature rules for integrating over element facets. The return format depends on whether the element has uniform or mixed facet types.</p>
<dl class="simple">
<dt><strong>For elements with uniform facets</strong> (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (weights, points) tensors</p></li>
<li><p>weights: quadrature weights for each facet point</p></li>
<li><p>points: quadrature point coordinates</p></li>
</ul>
</dd>
<dt><strong>For elements with mixed facets</strong> (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (tri_weights, tri_points, quad_weights, quad_points)</p></li>
<li><p>tri_weights: quadrature weights for triangular facets</p></li>
<li><p>tri_points: quadrature points for triangular facets</p></li>
<li><p>quad_weights: quadrature weights for quadrilateral facets</p></li>
<li><p>quad_points: quadrature points for quadrilateral facets</p></li>
</ul>
</dd>
</dl>
<p>The quadrature points can be returned either in the reference element coordinates (transform=True) or in facet-local coordinates (transform=False).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for tetrahedron element with uniform triangular facets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1]</span>
<span class="go">torch.Size([4, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([4, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for prism element with mixed facets (triangular and quadrilateral)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="p">,</span> <span class="n">tri_p</span><span class="p">,</span> <span class="n">quad_w</span><span class="p">,</span> <span class="n">quad_p</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1]</span>
<span class="go">torch.Size([2, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_p</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([2, 1, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_w</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1]</span>
<span class="go">torch.Size([3, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_p</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([3, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with transform=False returns points in facet-local coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1]</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1, dim-1=1]</span>
<span class="go">torch.Size([1, 1])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Quadrature order. Default is 1.</p></li>
<li><p><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to return the transformed facet quadrature.
If True, returns points in reference element coordinates with shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span>, where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.
If False, returns points in facet-local coordinates with shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span>, where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>) – The float data type of the polynomial.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device of the polynomial.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><em>For elements with uniform facets</em> –</p>
<dl class="simple">
<dt>quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True,  2D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet</p>
</dd>
<dt>quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
<li><p><em>For elements with mixed facets</em> –</p>
<dl class="simple">
<dt>tri_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p>
</dd>
<dt>tri_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
<dt>quad_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p>
</dd>
<dt>quad_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Prism.get_facet_type">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><span class="pre">Type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><span class="pre">Type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Prism.get_facet_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Prism.get_facet_type" title="Link to this definition"></a></dt>
<dd><p>Get the element type(s) for the facets of this element.</p>
<p>This method returns the element type(s) that make up the facets (faces) of the current element.
For example, a triangle element has line segment facets, while a prism has both triangular and
quadrilateral facets.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Line</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span><span class="p">,</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">==</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Triangle</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The element type(s) for the facets. Returns either:</p>
<ul class="simple">
<li><p>A single Element type for elements with uniform facets (e.g. Line for Triangle)</p></li>
<li><p>A tuple of Element types for elements with mixed facets (e.g. (Triangle, Quadrilateral) for Prism)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[Type[‘Element’], Tuple[Type[‘Element’], Type[‘Element’]]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Pyramid</span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Pyramid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Pyramid" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.points">
<span class="sig-name descname"><span class="pre">points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0.,</span> <span class="pre">1.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1.,</span> <span class="pre">1.,</span> <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">1.]])</span></em><a class="headerlink" href="#tensormesh.element.element.Pyramid.points" title="Link to this definition"></a></dt>
<dd><p>Coordinates of element vertices
Shape: <span class="math notranslate nohighlight">\([V, D]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.vertex">
<span class="sig-name descname"><span class="pre">vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[3],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[4]])</span></em><a class="headerlink" href="#tensormesh.element.element.Pyramid.vertex" title="Link to this definition"></a></dt>
<dd><p>Vertex indices for the element
Shape: <span class="math notranslate nohighlight">\([V, 1]\)</span> where <span class="math notranslate nohighlight">\(V\)</span> = number of vertices</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.edge">
<span class="sig-name descname"><span class="pre">edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0,</span> <span class="pre">1],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0,</span> <span class="pre">2],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[0,</span> <span class="pre">4],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1,</span> <span class="pre">3],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[1,</span> <span class="pre">4],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[2,</span> <span class="pre">3],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[2,</span> <span class="pre">4],</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[3,</span> <span class="pre">4]])</span></em><a class="headerlink" href="#tensormesh.element.element.Pyramid.edge" title="Link to this definition"></a></dt>
<dd><p>Edge connectivity defining pairs of vertex indices
Shape: <span class="math notranslate nohighlight">\([E, 2]\)</span> where <span class="math notranslate nohighlight">\(E\)</span> = number of edges</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.face">
<span class="sig-name descname"><span class="pre">face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">((0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3),</span> <span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">4),</span> <span class="pre">(0,</span> <span class="pre">2,</span> <span class="pre">4),</span> <span class="pre">(1,</span> <span class="pre">3,</span> <span class="pre">4),</span> <span class="pre">(2,</span> <span class="pre">3,</span> <span class="pre">4))</span></em><a class="headerlink" href="#tensormesh.element.element.Pyramid.face" title="Link to this definition"></a></dt>
<dd><p>Face connectivity defining vertex indices for each face.
Shape: Tuple of tuples, each inner tuple contains vertex indices
for one face.</p>
<dl class="simple">
<dt>Example:</dt><dd><p>((0,1,2), (1,2,3)) for two triangular faces</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.cell">
<span class="sig-name descname"><span class="pre">cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">tensor([[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4]])</span></em><a class="headerlink" href="#tensormesh.element.element.Pyramid.cell" title="Link to this definition"></a></dt>
<dd><p>Cell connectivity defining vertex indices for volumetric elements
Shape: <span class="math notranslate nohighlight">\([N_c, V_c]\)</span> where <span class="math notranslate nohighlight">\(N_c\)</span> = number of cells and <span class="math notranslate nohighlight">\(V_c\)</span> = vertices per cell</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#tensormesh.element.element.Pyramid.dim" title="Link to this definition"></a></dt>
<dd><p>Spatial dimension of the element (1D, 2D, or 3D)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.n_vertex">
<span class="sig-name descname"><span class="pre">n_vertex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#tensormesh.element.element.Pyramid.n_vertex" title="Link to this definition"></a></dt>
<dd><p>Number of vertices in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.n_edge">
<span class="sig-name descname"><span class="pre">n_edge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#tensormesh.element.element.Pyramid.n_edge" title="Link to this definition"></a></dt>
<dd><p>Number of edges in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.n_face">
<span class="sig-name descname"><span class="pre">n_face</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#tensormesh.element.element.Pyramid.n_face" title="Link to this definition"></a></dt>
<dd><p>Number of faces in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.n_cell">
<span class="sig-name descname"><span class="pre">n_cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#tensormesh.element.element.Pyramid.n_cell" title="Link to this definition"></a></dt>
<dd><p>Number of cells in the element</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.is_mix_facet">
<span class="sig-name descname"><span class="pre">is_mix_facet</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#tensormesh.element.element.Pyramid.is_mix_facet" title="Link to this definition"></a></dt>
<dd><p>Boolean indicating whether the element has mixed facet types.</p>
<p>False indicates uniform facets (e.g. all triangles or all quads).
True indicates mixed facets (e.g. prism or pyramid).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.get_basis">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Pyramid.get_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Pyramid.get_basis" title="Link to this definition"></a></dt>
<dd><p>Get the basis node coordinates for the element.</p>
<p>This method returns the coordinates of the basis nodes that define the element’s shape functions.
The number and location of basis nodes depends on the polynomial order.</p>
<p>For example:
- For order=1 (linear), returns vertices of the element
- For order=2 (quadratic), returns vertices plus midpoints of edges
- For higher orders, returns additional nodes in the interior</p>
<p>The basis nodes are used to construct the element’s shape functions and define the geometric
mapping between reference and physical elements.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])  # 3 vertices in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0.],</span>
<span class="go">        [1., 0.],</span>
<span class="go">        [0., 1.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Quadratic basis has additional nodes at edge midpoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([6, 2])  # 3 vertices + 3 edge midpoints</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_basis</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 3])  # 4 vertices in 3D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span>
<span class="go">tensor([[0., 0., 0.],</span>
<span class="go">        [1., 0., 0.],</span>
<span class="go">        [0., 1., 0.],</span>
<span class="go">        [0., 0., 1.]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor of shape [B, D],
where B is the number of basis nodes and D is the dimension</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.get_polynomial">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Pyramid.get_polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Pyramid.get_polynomial" title="Link to this definition"></a></dt>
<dd><p>Get the polynomial form for the element.</p>
<p>For a given order n, returns a polynomial with terms up to maximum total degree n.
The polynomial will have n_vars equal to the dimension of the element.</p>
<p>For example,</p>
<ul class="simple">
<li><p>For a 2D element with order=1:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y\)</span></p></li>
<li><p>For order=2:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y + a_3x^2 + a_4xy + a_5y^2\)</span></p></li>
</ul>
<p>The exact form and number of terms depends on the specific element type.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 2D element</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Quadratic terms: 1, x, y, x^2, xy, y^2</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_polynomial</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_vars</span>  <span class="c1"># 3D element</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span><span class="o">.</span><span class="n">n_terms</span>  <span class="c1"># Linear terms: 1, x, y, z</span>
<span class="go">4</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong> – A polynomial object with number of variables equal to the element dimension,</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.get_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Pyramid.get_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Pyramid.get_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the element.</p>
<dl class="simple">
<dt>For elements with single type of facets (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of two tensors containing quadrature weights and points</p></li>
</ul>
</dd>
<dt>For elements with mixed facets (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of four tensors containing quadrature weights and points for each facet type</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Number of quadrature points</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_points, dimension]</span>
<span class="go">torch.Size([1, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># More quadrature points for higher order</span>
<span class="go">torch.Size([3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># 3D points</span>
<span class="go">torch.Size([1, 3])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – quadrature order</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the float data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>- quadrature_weights</strong> (<em>torch.Tensor</em>) – 1D Tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><strong>- quadrature_points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape <span class="math notranslate nohighlight">\([N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points and <span class="math notranslate nohighlight">\(D\)</span> = dimension of element (1, 2, or 3)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.get_facet">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Pyramid.get_facet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Pyramid.get_facet" title="Link to this definition"></a></dt>
<dd><p>Get the facet connectivity for the element.</p>
<p>For elements with uniform facets (e.g. Triangle, Quadrilateral), returns a single tensor
containing facet connectivity. For elements with mixed facets (e.g. Prism), returns a tuple
of tensors containing facet connectivity for each facet type.</p>
<p>The facet connectivity defines how the basis nodes are connected to form each facet of the element.
For example, for a triangle element with linear basis (order=1), the facet connectivity would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># First edge connects nodes 0 and 1</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># Second edge connects nodes 1 and 2</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<p>For a prism element which has both triangular and quadrilateral facets, would return:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span><span class="p">)</span>
</pre></div>
</div>
<p>Where tri_facets contains connectivity for the triangular faces and quad_facets contains
connectivity for the quadrilateral faces.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span>
<span class="go">tensor([[0, 1],  # First edge connects nodes 0 and 1</span>
<span class="go">        [1, 2],  # Second edge connects nodes 1 and 2</span>
<span class="go">        [2, 0]]) # Third edge connects nodes 2 and 0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher order elements have more nodes per facet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facets</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([3, 3])  # 3 edges with 3 nodes each</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Two triangular faces</span>
<span class="go">torch.Size([2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_facets</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Three quadrilateral faces</span>
<span class="go">torch.Size([3, 4])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>if cls.is_mix_facet</em> –</p>
<ul>
<li><dl class="simple">
<dt>tri_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_t\)</span>, <span class="math notranslate nohighlight">\(B_{ft}\)</span>] where <span class="math notranslate nohighlight">\(F_t\)</span> is number of triangular facets, <span class="math notranslate nohighlight">\(B_{ft}\)</span> is basis nodes per triangular facet</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>quad_facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F_q\)</span>, <span class="math notranslate nohighlight">\(B_{fq}\)</span>] where <span class="math notranslate nohighlight">\(F_q\)</span> is number of quadrilateral facets, <span class="math notranslate nohighlight">\(B_{fq}\)</span> is basis nodes per quadrilateral facet</p>
</dd>
</dl>
</li>
</ul>
</li>
<li><p><em>else</em> –</p>
<ul>
<li><dl class="simple">
<dt>facet: torch.Tensor</dt><dd><p>2D Tensor of shape [<span class="math notranslate nohighlight">\(F\)</span>, <span class="math notranslate nohighlight">\(B_f\)</span>] where <span class="math notranslate nohighlight">\(F\)</span> is number of facets, <span class="math notranslate nohighlight">\(B_f\)</span> is basis nodes per facet</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.get_facet_quadrature">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Pyramid.get_facet_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Pyramid.get_facet_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the quadrature points and weights for the facets of the element.</p>
<p>This method returns quadrature rules for integrating over element facets. The return format depends on whether the element has uniform or mixed facet types.</p>
<dl class="simple">
<dt><strong>For elements with uniform facets</strong> (e.g. Tetrahedron):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (weights, points) tensors</p></li>
<li><p>weights: quadrature weights for each facet point</p></li>
<li><p>points: quadrature point coordinates</p></li>
</ul>
</dd>
<dt><strong>For elements with mixed facets</strong> (e.g. Prism):</dt><dd><ul class="simple">
<li><p>Returns a tuple of (tri_weights, tri_points, quad_weights, quad_points)</p></li>
<li><p>tri_weights: quadrature weights for triangular facets</p></li>
<li><p>tri_points: quadrature points for triangular facets</p></li>
<li><p>quad_weights: quadrature weights for quadrilateral facets</p></li>
<li><p>quad_points: quadrature points for quadrilateral facets</p></li>
</ul>
</dd>
</dl>
<p>The quadrature points can be returned either in the reference element coordinates (transform=True) or in facet-local coordinates (transform=False).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for tetrahedron element with uniform triangular facets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1]</span>
<span class="go">torch.Size([4, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_facet=4, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([4, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example for prism element with mixed facets (triangular and quadrilateral)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="p">,</span> <span class="n">tri_p</span><span class="p">,</span> <span class="n">quad_w</span><span class="p">,</span> <span class="n">quad_p</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_w</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1]</span>
<span class="go">torch.Size([2, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri_p</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_tri_facet=2, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([2, 1, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_w</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1]</span>
<span class="go">torch.Size([3, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quad_p</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># [n_quad_facet=3, n_quad_points=1, dim=3]</span>
<span class="go">torch.Size([3, 1, 3])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with transform=False returns points in facet-local coordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_quadrature</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1]</span>
<span class="go">torch.Size([1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># [n_quad_points=1, dim-1=1]</span>
<span class="go">torch.Size([1, 1])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Quadrature order. Default is 1.</p></li>
<li><p><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to return the transformed facet quadrature.
If True, returns points in reference element coordinates with shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span>, where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.
If False, returns points in facet-local coordinates with shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span>, where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet and <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>) – The float data type of the polynomial.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device of the polynomial.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><em>For elements with uniform facets</em> –</p>
<dl class="simple">
<dt>quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True,  2D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet</p>
</dd>
<dt>quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span> where <span class="math notranslate nohighlight">\(N_f\)</span> = number of facets, <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_q, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_q\)</span> = quadrature points per facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
<li><p><em>For elements with mixed facets</em> –</p>
<dl class="simple">
<dt>tri_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p>
</dd>
<dt>tri_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets, <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{tq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
<dt>quad_quadrature_weights<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet
If transform=False, 1D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p>
</dd>
<dt>quad_quadrature_points<span class="classifier">torch.Tensor</span></dt><dd><p>If transform=True, 3D tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}, D]\)</span> where <span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets, <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension
If transform=False, 2D tensor of shape <span class="math notranslate nohighlight">\([N_{qq}, D-1]\)</span> where <span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet, <span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.element.Pyramid.get_facet_type">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_facet_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><span class="pre">Type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><span class="pre">Type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/element.html#Pyramid.get_facet_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.element.Pyramid.get_facet_type" title="Link to this definition"></a></dt>
<dd><p>Get the element type(s) for the facets of this element.</p>
<p>This method returns the element type(s) that make up the facets (faces) of the current element.
For example, a triangle element has line segment facets, while a prism has both triangular and
quadrilateral facets.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Triangle</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Line</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Prism</span><span class="p">,</span> <span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">=</span> <span class="n">Prism</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">facet_types</span> <span class="o">==</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">,</span> <span class="n">Quadrilateral</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensormesh.element</span> <span class="kn">import</span> <span class="n">Tetrahedron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tetrahedron</span><span class="o">.</span><span class="n">get_facet_type</span><span class="p">()</span>
<span class="go">Triangle</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The element type(s) for the facets. Returns either:</p>
<ul class="simple">
<li><p>A single Element type for elements with uniform facets (e.g. Line for Triangle)</p></li>
<li><p>A tuple of Element types for elements with mixed facets (e.g. (Triangle, Quadrilateral) for Prism)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[Type[‘Element’], Tuple[Type[‘Element’], Type[‘Element’]]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="transformation">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Transformation</a><a class="headerlink" href="#transformation" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/transformation.html#Transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.transformation.Transformation" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Transformation of finite elements.</p>
<p>This class handles coordinate transformations between reference and physical elements,
including computation of Jacobians, shape functions, and their derivatives.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a mesh and transformation</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">elements</span><span class="p">,</span> <span class="n">element_type</span><span class="o">=</span><span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">element_type</span><span class="p">,</span> <span class="n">quadrature_order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Access transformation properties</span>
<span class="n">jacobian</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">jacobian</span>          <span class="c1"># Element Jacobian matrices</span>
<span class="n">shape_vals</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">shape_val</span>       <span class="c1"># Shape function values</span>
<span class="n">shape_grads</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">shape_grad</span>     <span class="c1"># Shape function gradients</span>

<span class="c1"># Get quadrature info</span>
<span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">quadrature</span>

<span class="c1"># Compute element integrals using JxW</span>
<span class="n">jxw</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">JxW</span>                    <span class="c1"># Jacobian determinant * quadrature weights</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.elements">
<span class="sig-name descname"><span class="pre">elements</span></span><a class="headerlink" href="#tensormesh.element.transformation.Transformation.elements" title="Link to this definition"></a></dt>
<dd><p>Element connectivity tensor of shape <span class="math notranslate nohighlight">\([N_e, N_b]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions per element</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.points">
<span class="sig-name descname"><span class="pre">points</span></span><a class="headerlink" href="#tensormesh.element.transformation.Transformation.points" title="Link to this definition"></a></dt>
<dd><p>Point coordinates tensor of shape <span class="math notranslate nohighlight">\([N_p, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_p\)</span> = number of points</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.element">
<span class="sig-name descname"><span class="pre">element</span></span><a class="headerlink" href="#tensormesh.element.transformation.Transformation.element" title="Link to this definition"></a></dt>
<dd><p>Element type class (e.g. Triangle, Tetrahedron)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Type[<a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element">Element</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.basis_order">
<span class="sig-name descname"><span class="pre">basis_order</span></span><a class="headerlink" href="#tensormesh.element.transformation.Transformation.basis_order" title="Link to this definition"></a></dt>
<dd><p>Order of basis functions</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.quadrature_order">
<span class="sig-name descname"><span class="pre">quadrature_order</span></span><a class="headerlink" href="#tensormesh.element.transformation.Transformation.quadrature_order" title="Link to this definition"></a></dt>
<dd><p>Order of quadrature rule</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">elements</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Element connectivity tensor of shape <span class="math notranslate nohighlight">\([N_e, N_b]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions per element</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">No-index<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Point coordinates tensor of shape <span class="math notranslate nohighlight">\([N_p, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_p\)</span> = number of points</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">No-index<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/transformation.html#Transformation.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.transformation.Transformation.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize transformation.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create transformation for triangular mesh</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">,</span> <span class="n">quadrature_order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>torch.Tensor</em>) – Point coordinates tensor of shape <span class="math notranslate nohighlight">\([N_p, D]\)</span></p></li>
<li><p><strong>elements</strong> (<em>torch.Tensor</em>) – Element connectivity tensor of shape <span class="math notranslate nohighlight">\([N_e, N_b]\)</span></p></li>
<li><p><strong>element_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Type of finite element (e.g. “tri”, “tet”)</p></li>
<li><p><strong>quadrature_order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Order of quadrature rule, by default 2</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">element</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><span class="pre">Type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.element.Element" title="tensormesh.element.element.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Element type class (e.g. Triangle, Tetrahedron)</p>
<dl class="field-list simple">
<dt class="field-odd">No-index<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">basis_order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Order of basis functions</p>
<dl class="field-list simple">
<dt class="field-odd">No-index<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">quadrature_order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Order of quadrature rule</p>
<dl class="field-list simple">
<dt class="field-odd">No-index<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.update_points">
<span class="sig-name descname"><span class="pre">update_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/transformation.html#Transformation.update_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.transformation.Transformation.update_points" title="Link to this definition"></a></dt>
<dd><p>Update mesh point coordinates.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Update points after mesh deformation</span>
<span class="n">new_points</span> <span class="o">=</span> <span class="n">points</span> <span class="o">+</span> <span class="n">displacement</span>
<span class="n">transform</span><span class="o">.</span><span class="n">update_points</span><span class="p">(</span><span class="n">new_points</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>points</strong> (<em>torch.Tensor</em>) – <p>Point coordinates tensor of shape <span class="math notranslate nohighlight">\([N_p, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_p\)</span> = number of points</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.dim" title="Link to this definition"></a></dt>
<dd><p>Get the spatial dimension of the mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The spatial dimension <span class="math notranslate nohighlight">\(D\)</span> (1, 2, or 3)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.device" title="Link to this definition"></a></dt>
<dd><p>Get the device of the mesh tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The device (CPU/GPU) where the mesh tensors are stored</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.dtype" title="Link to this definition"></a></dt>
<dd><p>Get the data type of the mesh tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The data type (e.g. torch.float32) of the mesh tensors</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.element_coords">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">element_coords</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.element_coords" title="Link to this definition"></a></dt>
<dd><p>Get the physical coordinates of element nodes.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">element_coords</span>
<span class="c1"># For a triangular mesh:</span>
<span class="c1"># coords[0] gives coordinates of all nodes in first triangle</span>
<span class="c1"># coords[0,0] gives coordinates of first node in first triangle</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Element node coordinates tensor of shape <span class="math notranslate nohighlight">\([N_e, N_b, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions per element</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.n_elements">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_elements</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.n_elements" title="Link to this definition"></a></dt>
<dd><p>Get the number of elements in the mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of elements <span class="math notranslate nohighlight">\(N_e\)</span></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.basis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.basis" title="Link to this definition"></a></dt>
<dd><p>Get the basis function nodes in reference coordinates.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">,</span> <span class="n">basis_order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">basis</span>  <span class="c1"># Get quadratic basis nodes</span>
<span class="c1"># For triangles: 6 nodes (3 vertices + 3 edge midpoints)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Basis node coordinates tensor of shape <span class="math notranslate nohighlight">\([N_b, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.n_basis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_basis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.n_basis" title="Link to this definition"></a></dt>
<dd><p>Get the number of basis functions per element.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of basis functions <span class="math notranslate nohighlight">\(N_b\)</span></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.quadrature">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">quadrature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.quadrature" title="Link to this definition"></a></dt>
<dd><p>Get quadrature weights and points.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">,</span> <span class="n">quadrature_order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">quadrature</span>
<span class="c1"># weights: quadrature weights for numerical integration</span>
<span class="c1"># points: quadrature point coordinates in reference element</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>Quadrature weights tensor of shape <span class="math notranslate nohighlight">\([N_q]\)</span></p></li>
<li><p>Quadrature points tensor of shape <span class="math notranslate nohighlight">\([N_q, D]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.n_quadrature">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_quadrature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.n_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get the number of quadrature points per element.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of quadrature points <span class="math notranslate nohighlight">\(N_q\)</span></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.shape_val">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape_val</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.shape_val" title="Link to this definition"></a></dt>
<dd><p>Get shape function values at quadrature points.</p>
<p>The shape functions <span class="math notranslate nohighlight">\(N_i(\boldsymbol{\xi})\)</span> are evaluated at the quadrature points
in the reference element.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">shape_val</span>
<span class="c1"># N[i,j] is value of jth shape function at ith quadrature point</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Shape function values tensor of shape <span class="math notranslate nohighlight">\([N_q, N_b]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.shape_grad">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape_grad</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.shape_grad" title="Link to this definition"></a></dt>
<dd><p>Get shape function gradients at quadrature points.</p>
<p>The shape function gradients <span class="math notranslate nohighlight">\(\nabla N_i(\mathbf{x})\)</span> are evaluated at the quadrature points
in physical coordinates.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">dN</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">shape_grad</span>
<span class="c1"># dN[e,q,i,d] is derivative of ith shape function w.r.t.</span>
<span class="c1"># dth coordinate at qth quadrature point in eth element</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Shape function gradients tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q, N_b, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.jacobian">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">jacobian</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.jacobian" title="Link to this definition"></a></dt>
<dd><p>Get Jacobian matrices at basis points,</p>
<p>The Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{J} = \frac{\partial\mathbf{x}}{\partial\boldsymbol{\xi}}\)</span>
maps derivatives from reference to physical coordinates.</p>
<p>The Jacobian matrix maps derivatives between reference and physical coordinates:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial x_i} = \sum_{j=1}^D J^{-1}_{ij} \frac{\partial}{\partial \xi_j}\]</div>
<p>where <span class="math notranslate nohighlight">\(J_{ij} = \frac{\partial x_i}{\partial \xi_j}\)</span> and <span class="math notranslate nohighlight">\(D\)</span> is the spatial dimension.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">jacobian</span>
<span class="c1"># J[e,q,:,:] is Jacobian matrix at qth quadrature point</span>
<span class="c1"># in eth element</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Jacobian matrices tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q, D, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.facets">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">facets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.facets" title="Link to this definition"></a></dt>
<dd><p>Get element facet connectivity.</p>
<p>For elements with uniform facets (e.g. all triangles or all quads), returns a single tensor.
For elements with mixed facets (e.g. prism or pyramid), returns separate tensors for triangular
and quadrilateral facets.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For a tetrahedral mesh (uniform triangular facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tet&quot;</span><span class="p">)</span>
<span class="n">facets</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">facets</span>  <span class="c1"># Single tensor of triangular facets</span>

<span class="c1"># For a prism mesh (mixed tri/quad facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;prism&quot;</span><span class="p">)</span>
<span class="n">tri_facets</span><span class="p">,</span> <span class="n">quad_facets</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">facets</span>  <span class="c1"># Separate tensors</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><em>If element has uniform facets</em> –</p>
<dl class="simple">
<dt>torch.Tensor</dt><dd><p>Facet connectivity tensor of shape <span class="math notranslate nohighlight">\([N_f, N_b]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions per facet</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><em>If element has mixed facets</em> –</p>
<dl>
<dt>Tuple[torch.Tensor, torch.Tensor]</dt><dd><ul class="simple">
<li><p>Triangular facet tensor of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tb}]\)</span></p></li>
<li><p>Quadrilateral facet tensor of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qb}]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tb}\)</span> = number of basis functions per triangular facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qb}\)</span> = number of basis functions per quadrilateral facet</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.facet_quadrature">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">facet_quadrature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.facet_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get quadrature weights and points for element facets.</p>
<p>Provides quadrature rules for numerical integration over element facets.
For mixed facet elements, returns separate quadrature rules for triangular
and quadrilateral facets.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For tetrahedral mesh (triangular facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tet&quot;</span><span class="p">)</span>
<span class="n">weights</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">facet_quadrature</span>

<span class="c1"># For prism mesh (mixed facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;prism&quot;</span><span class="p">)</span>
<span class="n">tri_w</span><span class="p">,</span> <span class="n">tri_p</span><span class="p">,</span> <span class="n">quad_w</span><span class="p">,</span> <span class="n">quad_p</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">facet_quadrature</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><em>If element has uniform facets</em> –</p>
<dl>
<dt>Tuple[torch.Tensor, torch.Tensor]</dt><dd><ul class="simple">
<li><p>Weights tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q]\)</span></p></li>
<li><p>Points tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q, D]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points per facet</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><em>If element has mixed facets</em> –</p>
<dl>
<dt>Tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]</dt><dd><ul class="simple">
<li><p>Triangular facet weights of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}]\)</span></p></li>
<li><p>Triangular facet points of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}, D]\)</span></p></li>
<li><p>Quadrilateral facet weights of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}]\)</span></p></li>
<li><p>Quadrilateral facet points of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}, D]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.facet_shape_val">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">facet_shape_val</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.facet_shape_val" title="Link to this definition"></a></dt>
<dd><p>Get shape function values at facet quadrature points.</p>
<p>Evaluates the element shape functions at the quadrature points on each facet.
For mixed facet elements, returns separate evaluations for triangular and
quadrilateral facets.</p>
<p>The shape functions <span class="math notranslate nohighlight">\(\phi_i(\mathbf{x})\)</span> are evaluated at quadrature points on each facet:</p>
<div class="math notranslate nohighlight">
\[\phi_i(\mathbf{x}_q^f) = \phi_i(\mathbf{F}^f(\mathbf{r}_q))\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{x}_q^f\)</span> = physical coordinates of quadrature point <span class="math notranslate nohighlight">\(q\)</span> on facet <span class="math notranslate nohighlight">\(f\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{F}^f\)</span> = mapping from reference to physical facet</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{r}_q\)</span> = reference coordinates of quadrature point <span class="math notranslate nohighlight">\(q\)</span></p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For tetrahedral mesh (triangular facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tet&quot;</span><span class="p">)</span>
<span class="n">shape_vals</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">facet_shape_val</span>

<span class="c1"># For prism mesh (mixed facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;prism&quot;</span><span class="p">)</span>
<span class="n">tri_vals</span><span class="p">,</span> <span class="n">quad_vals</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">facet_shape_val</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><em>If element has uniform facets</em> –</p>
<dl class="simple">
<dt>torch.Tensor</dt><dd><p>Shape function values tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q, N_b]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points per facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><em>If element has mixed facets</em> –</p>
<dl>
<dt>Tuple[torch.Tensor, torch.Tensor]</dt><dd><ul class="simple">
<li><p>Triangular facet values of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}, N_b]\)</span></p></li>
<li><p>Quadrilateral facet values of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}, N_b]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.facet_shape_grad">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">facet_shape_grad</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.facet_shape_grad" title="Link to this definition"></a></dt>
<dd><p>Get shape function gradients at facet quadrature points.</p>
<p>Evaluates the gradients of element shape functions at quadrature points on each facet.
For mixed facet elements, returns separate gradient evaluations for triangular and
quadrilateral facets.</p>
<p>The shape function gradients <span class="math notranslate nohighlight">\(\nabla\phi_i\)</span> are evaluated at quadrature points on each facet.
For a facet <span class="math notranslate nohighlight">\(f\)</span>, the gradients are computed as:</p>
<div class="math notranslate nohighlight">
\[\nabla\phi_i(\mathbf{x}_q^f) = \mathbf{J}^{-T}(\mathbf{x}_q^f) \nabla\hat{\phi}_i(\boldsymbol{\xi}_q^f)\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{x}_q^f\)</span> is the physical coordinate of quadrature point <span class="math notranslate nohighlight">\(q\)</span> on facet <span class="math notranslate nohighlight">\(f\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{\xi}_q^f\)</span> is the reference coordinate of the quadrature point</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{J}\)</span> is the Jacobian matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{\phi}_i\)</span> is the reference element shape function</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For tetrahedral mesh (triangular facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tet&quot;</span><span class="p">)</span>
<span class="n">grads</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">facet_shape_grad</span>

<span class="c1"># For prism mesh (mixed facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;prism&quot;</span><span class="p">)</span>
<span class="n">tri_grads</span><span class="p">,</span> <span class="n">quad_grads</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">facet_shape_grad</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><em>If element has uniform facets</em> –</p>
<dl class="simple">
<dt>torch.Tensor</dt><dd><p>Shape function gradients tensor of shape <span class="math notranslate nohighlight">\([N_f, N_q, N_b, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points per facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><em>If element has mixed facets</em> –</p>
<dl>
<dt>Tuple[torch.Tensor, torch.Tensor]</dt><dd><ul class="simple">
<li><p>Triangular facet gradients of shape <span class="math notranslate nohighlight">\([N_{tf}, N_{tq}, N_b, D]\)</span></p></li>
<li><p>Quadrilateral facet gradients of shape <span class="math notranslate nohighlight">\([N_{qf}, N_{qq}, N_b, D]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.facet_jacobian">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">facet_jacobian</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.facet_jacobian" title="Link to this definition"></a></dt>
<dd><p>Get Jacobian matrices at facet quadrature points.</p>
<p>The facet Jacobian matrix maps derivatives from reference facet coordinates to physical coordinates.
For mixed facet elements, returns separate Jacobians for triangular and quadrilateral facets.</p>
<p>The Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{J}_f = \frac{\partial\mathbf{x}}{\partial\boldsymbol{\xi}_f}\)</span>
where <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> are physical coordinates and <span class="math notranslate nohighlight">\(\boldsymbol{\xi}_f\)</span> are reference facet coordinates.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For tetrahedral mesh (triangular facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tet&quot;</span><span class="p">)</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">facet_jacobian</span>
<span class="c1"># J[e,f,q] is Jacobian at qth quadrature point</span>
<span class="c1"># on fth facet of eth element</span>

<span class="c1"># For prism mesh (mixed facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;prism&quot;</span><span class="p">)</span>
<span class="n">J_tri</span><span class="p">,</span> <span class="n">J_quad</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">facet_jacobian</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><em>If element has uniform facets</em> –</p>
<dl class="simple">
<dt>torch.Tensor</dt><dd><p>Facet Jacobian tensor of shape <span class="math notranslate nohighlight">\([N_e, N_f, N_q, D-1, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points per facet</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><em>If element has mixed facets</em> –</p>
<dl>
<dt>Tuple[torch.Tensor, torch.Tensor]</dt><dd><ul class="simple">
<li><p>Triangular facet Jacobians of shape <span class="math notranslate nohighlight">\([N_e, N_{tf}, N_{tq}, D-1, D]\)</span></p></li>
<li><p>Quadrilateral facet Jacobians of shape <span class="math notranslate nohighlight">\([N_e, N_{qf}, N_{qq}, D-1, D]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.nanson_scale">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nanson_scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.nanson_scale" title="Link to this definition"></a></dt>
<dd><p>Get Nanson scale factors for element facets.</p>
<p>The Nanson scale factor <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> is used to transform area elements from reference to physical space:</p>
<div class="math notranslate nohighlight">
\[\mathbf{n} = \det(\mathbf{J}) \mathbf{J}^{-T} \mathbf{N} w\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{J}\)</span> is the facet-to-cell Jacobian matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{N}\)</span> is the outward unit normal in reference space</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> is the quadrature weight</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For elements with uniform facets (e.g. tetrahedra)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tet&quot;</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">nanson_scale</span>  <span class="c1"># Single tensor for all facets</span>

<span class="c1"># For elements with mixed facets (e.g. prisms)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;prism&quot;</span><span class="p">)</span>
<span class="n">n_tri</span><span class="p">,</span> <span class="n">n_quad</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">nanson_scale</span>  <span class="c1"># Separate tensors for tri/quad facets</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><em>If element has uniform facets</em> –</p>
<dl class="simple">
<dt>torch.Tensor</dt><dd><p>Nanson scale tensor of shape <span class="math notranslate nohighlight">\([N_e, N_f, N_q]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points per facet</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><em>If element has mixed facets</em> –</p>
<dl>
<dt>Tuple[torch.Tensor, torch.Tensor]</dt><dd><ul class="simple">
<li><p>Triangular facet scales of shape <span class="math notranslate nohighlight">\([N_e, N_{tf}, N_{tq}]\)</span></p></li>
<li><p>Quadrilateral facet scales of shape <span class="math notranslate nohighlight">\([N_e, N_{qf}, N_{qq}]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.phi">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">phi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.phi" title="Link to this definition"></a></dt>
<dd><p>Get shape function values at quadrature points.</p>
<p>The shape functions <span class="math notranslate nohighlight">\(N_i(\boldsymbol{\xi})\)</span> are evaluated at the quadrature points
in the reference element.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">shape_val</span>
<span class="c1"># N[i,j] is value of jth shape function at ith quadrature point</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Shape function values tensor of shape <span class="math notranslate nohighlight">\([N_q, N_b]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.gradphi">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gradphi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.gradphi" title="Link to this definition"></a></dt>
<dd><p>Get shape function gradients at quadrature points.</p>
<p>The shape function gradients <span class="math notranslate nohighlight">\(\nabla N_i(\mathbf{x})\)</span> are evaluated at the quadrature points
in physical coordinates.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">dN</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">shape_grad</span>
<span class="c1"># dN[e,q,i,d] is derivative of ith shape function w.r.t.</span>
<span class="c1"># dth coordinate at qth quadrature point in eth element</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Shape function gradients tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q, N_b, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = number of basis functions</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.J">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">J</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.J" title="Link to this definition"></a></dt>
<dd><p>Get Jacobian matrices at basis points,</p>
<p>The Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{J} = \frac{\partial\mathbf{x}}{\partial\boldsymbol{\xi}}\)</span>
maps derivatives from reference to physical coordinates.</p>
<p>The Jacobian matrix maps derivatives between reference and physical coordinates:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial x_i} = \sum_{j=1}^D J^{-1}_{ij} \frac{\partial}{\partial \xi_j}\]</div>
<p>where <span class="math notranslate nohighlight">\(J_{ij} = \frac{\partial x_i}{\partial \xi_j}\)</span> and <span class="math notranslate nohighlight">\(D\)</span> is the spatial dimension.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">jacobian</span>
<span class="c1"># J[e,q,:,:] is Jacobian matrix at qth quadrature point</span>
<span class="c1"># in eth element</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Jacobian matrices tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q, D, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.detJ">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">detJ</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.detJ" title="Link to this definition"></a></dt>
<dd><p>Get the determinant of the Jacobian matrix at quadrature points.</p>
<p>The determinant of the Jacobian <span class="math notranslate nohighlight">\(\vertJ\vert = \det(\frac{\partial\mathbf{x}}{\partial\boldsymbol{\xi}})\)</span>
represents the local scaling factor between reference and physical coordinates.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">detJ</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">detJ</span>
<span class="c1"># detJ[e,q] is Jacobian determinant at qth quadrature point</span>
<span class="c1"># in eth element</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Jacobian determinant tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.JxW">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">JxW</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.JxW" title="Link to this definition"></a></dt>
<dd><p>Get the Jacobian determinant times quadrature weights.</p>
<p>The JxW term <span class="math notranslate nohighlight">\(\vert J\vert w\)</span> combines the Jacobian determinant with quadrature weights
for numerical integration over physical elements:</p>
<div class="math notranslate nohighlight">
\[\int_\Omega f(\mathbf{x}) d\mathbf{x} = \sum_{e=1}^{N_e} \sum_{q=1}^{N_q} f(\mathbf{x}_q^e) \vert J_q^e \vert w_q\]</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">jxw</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">JxW</span>
<span class="c1"># Integrate function over mesh:</span>
<span class="n">integral</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">jxw</span><span class="p">)</span>  <span class="c1"># f evaluated at quadrature points</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>JxW tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.G">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">G</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.G" title="Link to this definition"></a></dt>
<dd><p>Get Jacobian matrices at basis points,</p>
<p>The Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{J} = \frac{\partial\mathbf{x}}{\partial\boldsymbol{\xi}}\)</span>
maps derivatives from reference to physical coordinates.</p>
<p>The Jacobian matrix maps derivatives between reference and physical coordinates:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial x_i} = \sum_{j=1}^D J^{-1}_{ij} \frac{\partial}{\partial \xi_j}\]</div>
<p>where <span class="math notranslate nohighlight">\(J_{ij} = \frac{\partial x_i}{\partial \xi_j}\)</span> and <span class="math notranslate nohighlight">\(D\)</span> is the spatial dimension.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">jacobian</span>
<span class="c1"># J[e,q,:,:] is Jacobian matrix at qth quadrature point</span>
<span class="c1"># in eth element</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Jacobian matrices tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q, D, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.detG">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">detG</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.detG" title="Link to this definition"></a></dt>
<dd><p>Get the determinant of the Jacobian matrix at quadrature points.</p>
<p>The determinant of the Jacobian <span class="math notranslate nohighlight">\(\vertJ\vert = \det(\frac{\partial\mathbf{x}}{\partial\boldsymbol{\xi}})\)</span>
represents the local scaling factor between reference and physical coordinates.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">detJ</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">detJ</span>
<span class="c1"># detJ[e,q] is Jacobian determinant at qth quadrature point</span>
<span class="c1"># in eth element</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Jacobian determinant tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.GxW">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GxW</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.GxW" title="Link to this definition"></a></dt>
<dd><p>Get the Jacobian determinant times quadrature weights.</p>
<p>The JxW term <span class="math notranslate nohighlight">\(\vert J\vert w\)</span> combines the Jacobian determinant with quadrature weights
for numerical integration over physical elements:</p>
<div class="math notranslate nohighlight">
\[\int_\Omega f(\mathbf{x}) d\mathbf{x} = \sum_{e=1}^{N_e} \sum_{q=1}^{N_q} f(\mathbf{x}_q^e) \vert J_q^e \vert w_q\]</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>
<span class="n">jxw</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">JxW</span>
<span class="c1"># Integrate function over mesh:</span>
<span class="n">integral</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">jxw</span><span class="p">)</span>  <span class="c1"># f evaluated at quadrature points</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>JxW tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.F">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">F</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.F" title="Link to this definition"></a></dt>
<dd><p>Get Jacobian matrices at facet quadrature points.</p>
<p>The facet Jacobian matrix maps derivatives from reference facet coordinates to physical coordinates.
For mixed facet elements, returns separate Jacobians for triangular and quadrilateral facets.</p>
<p>The Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{J}_f = \frac{\partial\mathbf{x}}{\partial\boldsymbol{\xi}_f}\)</span>
where <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> are physical coordinates and <span class="math notranslate nohighlight">\(\boldsymbol{\xi}_f\)</span> are reference facet coordinates.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For tetrahedral mesh (triangular facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tet&quot;</span><span class="p">)</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">facet_jacobian</span>
<span class="c1"># J[e,f,q] is Jacobian at qth quadrature point</span>
<span class="c1"># on fth facet of eth element</span>

<span class="c1"># For prism mesh (mixed facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;prism&quot;</span><span class="p">)</span>
<span class="n">J_tri</span><span class="p">,</span> <span class="n">J_quad</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">facet_jacobian</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><em>If element has uniform facets</em> –</p>
<dl class="simple">
<dt>torch.Tensor</dt><dd><p>Facet Jacobian tensor of shape <span class="math notranslate nohighlight">\([N_e, N_f, N_q, D-1, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points per facet</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><em>If element has mixed facets</em> –</p>
<dl>
<dt>Tuple[torch.Tensor, torch.Tensor]</dt><dd><ul class="simple">
<li><p>Triangular facet Jacobians of shape <span class="math notranslate nohighlight">\([N_e, N_{tf}, N_{tq}, D-1, D]\)</span></p></li>
<li><p>Quadrilateral facet Jacobians of shape <span class="math notranslate nohighlight">\([N_e, N_{qf}, N_{qq}, D-1, D]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.detF">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">detF</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.detF" title="Link to this definition"></a></dt>
<dd><p>Get determinant of facet Jacobian matrices.</p>
<p>For a facet with normal <span class="math notranslate nohighlight">\(\mathbf{n}\)</span>, the facet Jacobian determinant is:</p>
<div class="math notranslate nohighlight">
\[|F| = \sqrt{\det(F^T F)}\]</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is the facet Jacobian matrix mapping from reference to physical facets.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For tetrahedral mesh (triangular facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tet&quot;</span><span class="p">)</span>
<span class="n">detF</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">detF</span>  <span class="c1"># Single tensor for tri facets</span>

<span class="c1"># For prism mesh (mixed tri/quad facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;prism&quot;</span><span class="p">)</span>
<span class="n">tri_detF</span><span class="p">,</span> <span class="n">quad_detF</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">detF</span>  <span class="c1"># Separate tensors</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><em>If element has uniform facets</em> –</p>
<dl class="simple">
<dt>torch.Tensor</dt><dd><p>Facet Jacobian determinant tensor of shape <span class="math notranslate nohighlight">\([N_e, N_f, N_q]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points per facet</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><em>If element has mixed facets</em> –</p>
<dl>
<dt>Tuple[torch.Tensor, torch.Tensor]</dt><dd><ul class="simple">
<li><p>Triangular facet determinants of shape <span class="math notranslate nohighlight">\([N_e, N_{tf}, N_{tq}]\)</span></p></li>
<li><p>Quadrilateral facet determinants of shape <span class="math notranslate nohighlight">\([N_e, N_{qf}, N_{qq}]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tq}\)</span> = number of quadrature points per triangular facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qq}\)</span> = number of quadrature points per quadrilateral facet</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.FxW">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FxW</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.FxW" title="Link to this definition"></a></dt>
<dd><p>Get facet Jacobian determinant times quadrature weights.</p>
<p>The FxW term <span class="math notranslate nohighlight">\(|F|w\)</span> combines the facet Jacobian determinant with quadrature weights
for numerical integration over physical facets:</p>
<div class="math notranslate nohighlight">
\[\int_{\Gamma} f(\mathbf{x}) d\Gamma = \sum_{e=1}^{N_e} \sum_{f=1}^{N_f} \sum_{q=1}^{N_q} f(\mathbf{x}_q^{ef}) |F_q^{ef}| w_q\]</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For tetrahedral mesh (triangular facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tet&quot;</span><span class="p">)</span>
<span class="n">fxw</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">FxW</span>  <span class="c1"># Single tensor for tri facets</span>

<span class="c1"># For prism mesh (mixed tri/quad facets)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;prism&quot;</span><span class="p">)</span>
<span class="n">tri_fxw</span><span class="p">,</span> <span class="n">quad_fxw</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">FxW</span>  <span class="c1"># Separate tensors</span>

<span class="c1"># Integrate function over facets:</span>
<span class="n">integral</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">fxw</span><span class="p">)</span>  <span class="c1"># f evaluated at facet quadrature points</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><em>If element has uniform facets</em> –</p>
<dl class="simple">
<dt>torch.Tensor</dt><dd><p>FxW tensor of shape <span class="math notranslate nohighlight">\([N_e, N_f, N_q]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points per facet</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><em>If element has mixed facets</em> –</p>
<dl>
<dt>Tuple[torch.Tensor, torch.Tensor]</dt><dd><ul class="simple">
<li><p>Triangular facet FxW of shape <span class="math notranslate nohighlight">\([N_e, N_{tf}, N_{tq}]\)</span></p></li>
<li><p>Quadrilateral facet FxW of shape <span class="math notranslate nohighlight">\([N_e, N_{qf}, N_{qq}]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tq}\)</span> = number of quadrature points per triangular facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qq}\)</span> = number of quadrature points per quadrilateral facet</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.n">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#tensormesh.element.transformation.Transformation.n" title="Link to this definition"></a></dt>
<dd><p>Get Nanson scale factors for element facets.</p>
<p>The Nanson scale factor <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> is used to transform area elements from reference to physical space:</p>
<div class="math notranslate nohighlight">
\[\mathbf{n} = \det(\mathbf{J}) \mathbf{J}^{-T} \mathbf{N} w\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{J}\)</span> is the facet-to-cell Jacobian matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{N}\)</span> is the outward unit normal in reference space</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> is the quadrature weight</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For elements with uniform facets (e.g. tetrahedra)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tet&quot;</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">nanson_scale</span>  <span class="c1"># Single tensor for all facets</span>

<span class="c1"># For elements with mixed facets (e.g. prisms)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;prism&quot;</span><span class="p">)</span>
<span class="n">n_tri</span><span class="p">,</span> <span class="n">n_quad</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">nanson_scale</span>  <span class="c1"># Separate tensors for tri/quad facets</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><em>If element has uniform facets</em> –</p>
<dl class="simple">
<dt>torch.Tensor</dt><dd><p>Nanson scale tensor of shape <span class="math notranslate nohighlight">\([N_e, N_f, N_q]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> = number of facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points per facet</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><em>If element has mixed facets</em> –</p>
<dl>
<dt>Tuple[torch.Tensor, torch.Tensor]</dt><dd><ul class="simple">
<li><p>Triangular facet scales of shape <span class="math notranslate nohighlight">\([N_e, N_{tf}, N_{tq}]\)</span></p></li>
<li><p>Quadrilateral facet scales of shape <span class="math notranslate nohighlight">\([N_e, N_{qf}, N_{qq}]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tf}\)</span> = number of triangular facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{tq}\)</span> = quadrature points per triangular facet</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qf}\)</span> = number of quadrilateral facets per element</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{qq}\)</span> = quadrature points per quadrilateral facet</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.batch_quadrature">
<span class="sig-name descname"><span class="pre">batch_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/transformation.html#Transformation.batch_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.transformation.Transformation.batch_quadrature" title="Link to this definition"></a></dt>
<dd><p>Get a batch of quadrature points and weights.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>

<span class="c1"># Get first 10 quadrature points</span>
<span class="n">w</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch_quadrature</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Get all quadrature points after index 5</span>
<span class="n">w</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch_quadrature</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">batch</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The starting index of the batch</p></li>
<li><p><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of quadrature points in the batch.
If -1, returns all points starting from <cite>start</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Quadrature weights tensor of shape <span class="math notranslate nohighlight">\([N_b]\)</span></p></li>
<li><p>Quadrature points tensor of shape <span class="math notranslate nohighlight">\([N_b, D]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = batch size</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.batch_elements_coords">
<span class="sig-name descname"><span class="pre">batch_elements_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/transformation.html#Transformation.batch_elements_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.transformation.Transformation.batch_elements_coords" title="Link to this definition"></a></dt>
<dd><p>Get physical coordinates for a batch of elements.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>

<span class="c1"># Get coordinates for first 5 elements</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch_elements_coords</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Get coordinates for all elements after index 10</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch_elements_coords</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The starting element index</p></li>
<li><p><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of elements in the batch.
If -1, returns all elements starting from <cite>start</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Element coordinates tensor of shape <span class="math notranslate nohighlight">\([N_b, N_n, D]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = batch size</p></li>
<li><p><span class="math notranslate nohighlight">\(N_n\)</span> = nodes per element</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.batch_shape_val">
<span class="sig-name descname"><span class="pre">batch_shape_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/transformation.html#Transformation.batch_shape_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.transformation.Transformation.batch_shape_val" title="Link to this definition"></a></dt>
<dd><p>Get shape function values for a batch of quadrature points.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>

<span class="c1"># Get shape values at first 10 quadrature points</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch_shape_val</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Get shape values at all points after index 5</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch_shape_val</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">batch</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The starting quadrature point index</p></li>
<li><p><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of quadrature points in the batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Shape function values tensor of shape <span class="math notranslate nohighlight">\([N_b, N_s]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_b\)</span> = batch size</p></li>
<li><p><span class="math notranslate nohighlight">\(N_s\)</span> = shape functions per element</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.transformation.Transformation.batch_shape_grad_jxw">
<span class="sig-name descname"><span class="pre">batch_shape_grad_jxw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrature_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/transformation.html#Transformation.batch_shape_grad_jxw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.transformation.Transformation.batch_shape_grad_jxw" title="Link to this definition"></a></dt>
<dd><p>Get shape function gradients and Jacobian weights for batches of elements and quadrature points.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;tri&quot;</span><span class="p">)</span>

<span class="c1"># Get values for first 5 elements and first 10 quadrature points</span>
<span class="n">grads</span><span class="p">,</span> <span class="n">jxw</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch_shape_grad_jxw</span><span class="p">(</span>
    <span class="n">element_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">element_batch</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">quadrature_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">quadrature_batch</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>

<span class="c1"># Get values for all elements and quadrature points</span>
<span class="n">grads</span><span class="p">,</span> <span class="n">jxw</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">batch_shape_grad_jxw</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The starting element index, by default 0</p></li>
<li><p><strong>element_batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The number of elements in the batch.
If -1, uses all elements after start, by default -1</p></li>
<li><p><strong>quadrature_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The starting quadrature point index, by default 0</p></li>
<li><p><strong>quadrature_batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The number of quadrature points in the batch.
If -1, uses all points after start, by default -1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Shape gradients tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q, N_s, D]\)</span></p></li>
<li><p>Jacobian weights tensor of shape <span class="math notranslate nohighlight">\([N_e, N_q]\)</span></p></li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_e\)</span> = number of elements in batch</p></li>
<li><p><span class="math notranslate nohighlight">\(N_q\)</span> = number of quadrature points in batch</p></li>
<li><p><span class="math notranslate nohighlight">\(N_s\)</span> = shape functions per element</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = spatial dimension</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="polynomial">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Polynomial</a><a class="headerlink" href="#polynomial" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A polynomial class representing multivariate polynomials of the form:</p>
<div class="math notranslate nohighlight">
\[p(x_1,\ldots,x_n) = \sum_{i=1}^m c_i \prod_{j=1}^n x_j^{e_{ij}}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> is the number of variables (n_vars)</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> is the number of terms (n_terms)</p></li>
<li><p><span class="math notranslate nohighlight">\(c_i\)</span> are the coefficients (coef)</p></li>
<li><p><span class="math notranslate nohighlight">\(e_{ij}\)</span> are the exponents (exp)</p></li>
<li><p><span class="math notranslate nohighlight">\(x_j\)</span> are the variables</p></li>
</ul>
<p>For example, the polynomial <span class="math notranslate nohighlight">\(x^2y + 2xy^2 + 3\)</span> has:</p>
<ul class="simple">
<li><p>n_vars = 2 (x,y)</p></li>
<li><p>n_terms = 3</p></li>
<li><p>coef = [1, 2, 3]</p></li>
<li><p>exp = [[2,1,0], [1,2,0]]</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create polynomial with exponents and coefficients</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span> <span class="c1"># [n_vars(2), n_terms(3)]</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>             <span class="c1"># [n_terms(3)]</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>

<span class="c1"># Print polynomial</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>  <span class="c1"># xy^2 + x^2y + x^3</span>

<span class="c1"># Evaluate polynomial at point x</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="c1"># [n_vars]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># 2*3^2 + 2^2*3 + 2^3 = 38</span>

<span class="c1"># Take derivatives</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">deriv</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># y^2 + 2xy + 3x^2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">deriv</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># 2xy + x^2</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize a polynomial with exponents and coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp</strong> (<em>torch.Tensor</em>) – <p>Exponents tensor of shape <span class="math notranslate nohighlight">\([N_v, N_t]\)</span> where:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(N_v\)</span> = number of variables</p></li>
<li><p><span class="math notranslate nohighlight">\(N_t\)</span> = number of terms</p></li>
</ul>
</p></li>
<li><p><strong>coef</strong> (<em>Optional</em><em>[</em><em>torch.Tensor</em><em>]</em><em>, </em><em>optional</em>) – Coefficients tensor of shape <span class="math notranslate nohighlight">\([N_t]\)</span>, by default None.
If None, coefficients will be initialized as ones.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create polynomial x^2y + 2xy^2 + 3</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>  <span class="c1"># [2 vars, 3 terms]</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>            <span class="c1"># [3 terms]</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.n_vars">
<span class="sig-name descname"><span class="pre">n_vars</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.n_vars" title="Link to this definition"></a></dt>
<dd><p>Number of variables in polynomial
:no-index:</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.n_terms">
<span class="sig-name descname"><span class="pre">n_terms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.n_terms" title="Link to this definition"></a></dt>
<dd><p>Number of terms in polynomial
:no-index:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.forward" title="Link to this definition"></a></dt>
<dd><p>Evaluate the polynomial at given points.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a polynomial p(x,y) = 2x + 3y^2</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">exp</span><span class="p">)</span>

<span class="c1"># Evaluate at single point</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>  <span class="c1"># point (x=1, y=2)</span>
<span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># 2*1 + 3*2^2 = 14.0</span>
<span class="c1"># tensor(14.)</span>

<span class="c1"># Evaluate at multiple points</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>  <span class="c1"># points (1,2) and (2,1)</span>
<span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># [2*1 + 3*2^2, 2*2 + 3*1^2] = [14.0, 7.0]</span>
<span class="c1"># tensor([14., 7.])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em><em> [</em><em>n_batch</em><em>, </em><em>n_vars</em><em>] or </em><em>[</em><em>n_vars</em><em>]</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor [n_batch] or torch.Float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.get_exp_terms">
<span class="sig-name descname"><span class="pre">get_exp_terms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial.get_exp_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.get_exp_terms" title="Link to this definition"></a></dt>
<dd><p>Compute exponential terms for polynomial evaluation.</p>
<p>For a polynomial with terms <span class="math notranslate nohighlight">\(c_i x_1^{e_{i1}} x_2^{e_{i2}} \cdots x_n^{e_{in}}\)</span>,
computes the exponential terms <span class="math notranslate nohighlight">\(x_1^{e_{i1}} x_2^{e_{i2}} \cdots x_n^{e_{in}}\)</span>
for each term i.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create polynomial p(x,y) = 2x^2y + 3xy^2</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>  <span class="c1"># exponents for each term</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>     <span class="c1"># coefficients</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">exp</span><span class="p">)</span>

<span class="c1"># Single point evaluation</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>  <span class="c1"># point (x=2, y=3)</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">get_exp_terms</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># [2^2 * 3^1, 2^1 * 3^2]</span>
<span class="c1"># tensor([12., 54.])</span>

<span class="c1"># Multiple point evaluation</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>  <span class="c1"># points (2,3) and (1,2)</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">get_exp_terms</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># [[2^2 * 3^1, 2^1 * 3^2], [1^2 * 2^1, 1^1 * 2^2]]</span>
<span class="c1"># tensor([[12., 54.],</span>
<span class="c1">#         [ 2.,  4.]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input points tensor of shape:
* [n_vars] for single point
* [n_batch, n_vars] for multiple points
where:
* n_vars = number of variables
* n_batch = number of points</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Exponential terms tensor of shape:
* [n_terms] for single point input
* [n_batch, n_terms] for multiple point input
where:
* n_terms = number of polynomial terms</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.deriv">
<span class="sig-name descname"><span class="pre">deriv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var_ind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial.deriv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.deriv" title="Link to this definition"></a></dt>
<dd><p>Compute the derivative of the polynomial with respect to a variable.</p>
<p>For a polynomial <span class="math notranslate nohighlight">\(p(x,y,z) = ax^ny^mz^k\)</span>, the derivative with respect to x is:
<span class="math notranslate nohighlight">\(\frac{\partial p}{\partial x} = nax^{n-1}y^mz^k\)</span> if n&gt;0, or 0 if n=0</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create polynomial p(x,y) = x^2y + 2xy^2 + 3</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span> <span class="c1"># [n_vars(2), n_terms(3)]</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>             <span class="c1"># [n_terms(3)]</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>

<span class="c1"># Take derivative with respect to x</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">deriv</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># 2xy + 2y^2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span>

<span class="c1"># Take derivative with respect to y</span>
<span class="n">dy</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">deriv</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># x^2 + 4xy</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span>

<span class="c1"># Evaluate derivatives at point (2,3)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dx</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># 2*2*3 + 2*3^2 = 30</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dy</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># 2^2 + 4*2*3 = 28</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var_ind</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the index of the variable to be differentiated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>deriv_poly</strong> – the derivative of the polynomial</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.grad">
<span class="sig-name descname"><span class="pre">grad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial.grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.grad" title="Link to this definition"></a></dt>
<dd><p>Compute the gradient of the polynomial.</p>
<p>For a polynomial <span class="math notranslate nohighlight">\(p(x_1,\ldots,x_n)\)</span>, returns a vector of partial derivatives:
<span class="math notranslate nohighlight">\(\nabla p = [\frac{\partial p}{\partial x_1}, \ldots, \frac{\partial p}{\partial x_n}]\)</span></p>
<p>For example, given <span class="math notranslate nohighlight">\(p(x,y) = ax^ny^m\)</span>, the gradient is:
<span class="math notranslate nohighlight">\(\nabla p = [nax^{n-1}y^m, max^ny^{m-1}]\)</span></p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create polynomial p(x,y) = x^2y + 2xy^2 + 3</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span> <span class="c1"># [n_vars(2), n_terms(3)]</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>             <span class="c1"># [n_terms(3)]</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>

<span class="c1"># Take gradient</span>
<span class="n">grad</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">grad</span><span class="p">()</span>  <span class="c1"># [2xy + 2y^2, x^2 + 4xy]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grad</span><span class="p">)</span>

<span class="c1"># Evaluate gradient at point (2,3)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># [30, 28]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>grad_poly</strong> – the gradient of the polynomial</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials">Polynomials</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.reset_coef">
<span class="sig-name descname"><span class="pre">reset_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial.reset_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.reset_coef" title="Link to this definition"></a></dt>
<dd><p>Reset the coefficients of the polynomial while keeping the exponents unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coef</strong> (<em>torch.Tensor</em>) – The new coefficients to set. Must match the shape, device and dtype of the existing coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Returns self for method chaining.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.repeat">
<span class="sig-name descname"><span class="pre">repeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial.repeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.repeat" title="Link to this definition"></a></dt>
<dd><p>Repeat the polynomial along specified dimensions.</p>
<p>Creates a new Polynomials object by repeating the current polynomial’s coefficients and
exponents according to the provided repeat dimensions. This is similar to torch.repeat().</p>
<p>For example:</p>
<ul class="simple">
<li><p>repeat(3) creates 3 copies along a new first dimension</p></li>
<li><p>repeat(2,3) creates a 2x3 grid of copies in new dimensions</p></li>
</ul>
<p>The coefficients and exponents are repeated while preserving the polynomial structure,
effectively creating multiple independent copies of the same polynomial.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a polynomial</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>  <span class="c1"># x^2y + x</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>

<span class="c1"># Repeat 3 times along new first dimension</span>
<span class="n">polys1</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Shape: [3, n_vars, n_terms]</span>

<span class="c1"># Create 2x3 grid of copies</span>
<span class="n">polys2</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># Shape: [2, 3, n_vars, n_terms]</span>

<span class="c1"># Evaluate repeated polynomials</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># [2, 3, n_vars]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">polys2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># [2, 3] outputs</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of repetitions for each new dimension. Similar to torch.repeat() arguments.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new Polynomials object with the repeated structure. The shape will be [<a href="#id5"><span class="problematic" id="id6">*</span></a>args, …original_shape].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials">Polynomials</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.lin_exp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lin_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_vars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial.lin_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.lin_exp" title="Link to this definition"></a></dt>
<dd><p>Creates a linear polynomial with n_vars variables.
Creates a polynomial with <code class="docutils literal notranslate"><span class="pre">n_vars+1</span></code> terms:</p>
<ul class="simple">
<li><p>A constant term (all exponents 0)</p></li>
<li><p>Linear terms for each variable (exponent 1 for that variable, 0 for others)</p></li>
</ul>
<p>For example, with n_vars=2, creates polynomial with terms:
<span class="math notranslate nohighlight">\(1, x, y\)</span></p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create linear polynomial with 2 variables (1 + x + y)</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">lin_exp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>  <span class="c1"># 1 + x + y</span>

<span class="c1"># Create linear polynomial with 3 variables (1 + x + y + z)</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">lin_exp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>  <span class="c1"># 1 + x + y + z</span>

<span class="c1"># Specify dtype and device</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">lin_exp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># torch.float64</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># cuda:0</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_vars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of vairables</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Polynomial n_vars=n_vars n_terms=n_vars+1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.poly_exp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">poly_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_vars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial.poly_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.poly_exp" title="Link to this definition"></a></dt>
<dd><p>Creates a polynomial with terms up to a maximum total degree.</p>
<p>For n_vars variables and maximum degree dim, includes all terms where
the sum of exponents is less than or equal to dim, sorted by total degree.</p>
<p>For example, with n_vars=2, dim=2, creates polynomial with terms:
<span class="math notranslate nohighlight">\(1, x, y, x^2, xy, y^2\)</span></p>
<p>For n_vars=1, creates polynomial with terms up to power dim:
<span class="math notranslate nohighlight">\(1, x, x^2, \ldots, x^{dim}\)</span></p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create polynomial with terms up to degree 2 in 2 variables</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">poly_exp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>  <span class="c1"># 1 + x + y + x^2 + xy + y^2</span>

<span class="c1"># Create polynomial with terms up to degree 3 in 1 variable</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">poly_exp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>  <span class="c1"># 1 + x + x^2 + x^3</span>

<span class="c1"># Create polynomial with terms up to degree 2 in 3 variables</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">poly_exp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>  <span class="c1"># 1 + x + y + z + x^2 + xy + xz + y^2 + yz + z^2</span>

<span class="c1"># Specify dtype and device</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">poly_exp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># torch.float64</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># cuda:0</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_vars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of vairables</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of maximum dimension</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Polynomial n_vars=n_vars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.tens_exp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tens_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_vars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial.tens_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.tens_exp" title="Link to this definition"></a></dt>
<dd><p>Creates a tensor product polynomial with terms up to maximum degree in each variable.</p>
<p>For n_vars variables and maximum degree dim, includes all terms where
each exponent is less than or equal to dim, sorted by total degree.</p>
<p>For example, with n_vars=2, dim=2, creates polynomial with terms:
<span class="math notranslate nohighlight">\(P(x,y) = a_0 + a_1x + a_2y + a_3x^2 + a_4xy + a_5y^2 + a_6x^2y + a_7xy^2 + a_8x^2y^2\)</span></p>
<p>For n_vars=1, dim=d, creates polynomial with terms up to power dim:
<span class="math notranslate nohighlight">\(P(x) = a_0 + a_1x + a_2x^2 + ... + a_dx^d\)</span></p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create tensor product polynomial with 2 variables up to degree 2</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">tens_exp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>  <span class="c1"># 1 + x + y + x^2 + xy + y^2 + x^2y + xy^2 + x^2y^2</span>

<span class="c1"># Create tensor product polynomial with 1 variable up to degree 3</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">tens_exp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>  <span class="c1"># 1 + x + x^2 + x^3</span>

<span class="c1"># Specify dtype and device</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">tens_exp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># torch.float64</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># cuda:0</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_vars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of vairables</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of maximum dimension</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – the data type of the polynomial</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Polynomial n_vars=n_vars n_terms=(dim+1)**n_vars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.pyr_exp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pyr_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial.pyr_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.pyr_exp" title="Link to this definition"></a></dt>
<dd><p>Creates a pyramid polynomial with terms up to maximum total degree.</p>
<p>For order n, includes all terms where x+z &lt; n+1 and y+z &lt; n+1, sorted by total degree.</p>
<p>For example, with order=1, creates polynomial with terms:
<span class="math notranslate nohighlight">\(P(x,y,z) = a_0 + a_1x + a_2y + a_3z\)</span></p>
<p>With order=2, creates polynomial with terms:
<span class="math notranslate nohighlight">\(P(x,y,z) = a_0 + a_1x + a_2y + a_3z + a_4x^2 + a_5xy + a_6y^2 + a_7xz + a_8yz + a_9z^2\)</span></p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create order 1 pyramid polynomial</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">pyr_exp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>  <span class="c1"># 1 + x + y + z</span>

<span class="c1"># Create order 2 pyramid polynomial with custom dtype and device</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">pyr_exp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># torch.float64</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># cuda:0</span>

<span class="c1"># Evaluate polynomial at point x</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>  <span class="c1"># [x,y,z]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># Evaluates polynomial at (1,2,0.5)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum polynomial order</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>) – Data type of polynomial coefficients</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – Device to store polynomial on</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong> – Pyramid polynomial with n_vars=3 and appropriate number of terms</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomial.pri_exp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pri_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomial.pri_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomial.pri_exp" title="Link to this definition"></a></dt>
<dd><p>Creates a prismatic polynomial with terms up to maximum total degree.</p>
<p>For order n, includes all terms where x+y &lt; n+1, sorted by total degree.</p>
<p>For example, with order=1, creates polynomial with terms:
<span class="math notranslate nohighlight">\(P(x,y,z) = a_0 + a_1x + a_2y + a_3z\)</span></p>
<p>With order=2, creates polynomial with terms:
<span class="math notranslate nohighlight">\(P(x,y,z) = a_0 + a_1x + a_2y + a_3z + a_4x^2 + a_5xy + a_6y^2 + a_7xz + a_8yz + a_9z^2\)</span></p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create prismatic polynomial of order 2</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">pri_exp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>  <span class="c1"># 1 + x + y + z + x^2 + xy + y^2 + xz + yz + z^2</span>

<span class="c1"># Create with specific dtype and device</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">pri_exp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># torch.float64</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># cuda:0</span>

<span class="c1"># Evaluate polynomial at point x</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>  <span class="c1"># [x,y,z]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># Evaluates polynomial at (1,2,0.5)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum polynomial order</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>) – Data type of polynomial coefficients</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – Device to store polynomial on</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>polynomial</strong> – Prismatic polynomial with n_vars=3 and appropriate number of terms</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Polynomials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A collection of polynomials that can be evaluated and manipulated together.</p>
<p>This class represents a batch of polynomials, allowing vectorized operations across multiple polynomials.
Each polynomial has the same number of variables and terms, but can have different coefficients.</p>
<p>The polynomials are stored in a batched format with coefficients and exponents tensors:</p>
<ul class="simple">
<li><p>Coefficients tensor shape: [n_poly1, …, n_terms]</p></li>
<li><p>Exponents tensor shape: [n_poly1, …, n_vars, n_terms]</p></li>
</ul>
<p>Where n_poly1, … are the batch dimensions.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a batch of 2 quadratic polynomials in 2 variables</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span>
                  <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]])</span>  <span class="c1"># [2, 2, 5]</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span> <span class="c1"># [2, 5]</span>
<span class="n">polys</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>

<span class="c1"># Print batch shape and dimensions</span>
<span class="nb">print</span><span class="p">(</span><span class="n">polys</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>     <span class="c1"># (2,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">polys</span><span class="o">.</span><span class="n">n_vars</span><span class="p">)</span>    <span class="c1"># 2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">polys</span><span class="o">.</span><span class="n">n_terms</span><span class="p">)</span>   <span class="c1"># 5</span>

<span class="c1"># Evaluate polynomials at points</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]])</span>  <span class="c1"># [2, 2]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">polys</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Evaluates both polynomials at their respective points</span>

<span class="c1"># Take derivatives</span>
<span class="n">d_polys</span> <span class="o">=</span> <span class="n">polys</span><span class="o">.</span><span class="n">deriv</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Derivative with respect to first variable</span>

<span class="c1"># Convert to individual polynomials</span>
<span class="n">poly_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">polys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">polys</span><span class="p">))]</span>

<span class="c1"># Create with specific dtype and device</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span><span class="o">.</span><span class="n">double</span><span class="p">()</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">coef</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span><span class="o">.</span><span class="n">double</span><span class="p">()</span>
<span class="n">polys</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">polys</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>    <span class="c1"># torch.float64</span>
<span class="nb">print</span><span class="p">(</span><span class="n">polys</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>   <span class="c1"># cuda:0</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp</strong> (<em>torch.Tensor</em>) – Tensor of exponents with shape [n_poly1, …, n_vars, n_terms]</p></li>
<li><p><strong>coef</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Tensor of coefficients with shape [n_poly1, …, n_terms]. If None, defaults to ones.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials._coef">
<span class="sig-name descname"><span class="pre">_coef</span></span><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials._coef" title="Link to this definition"></a></dt>
<dd><p>The coefficients tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials._exp">
<span class="sig-name descname"><span class="pre">_exp</span></span><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials._exp" title="Link to this definition"></a></dt>
<dd><p>The exponents tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.n_polys">
<span class="sig-name descname"><span class="pre">n_polys</span></span><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.n_polys" title="Link to this definition"></a></dt>
<dd><p>The batch dimensions</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.n_vars">
<span class="sig-name descname"><span class="pre">n_vars</span></span><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.n_vars" title="Link to this definition"></a></dt>
<dd><p>Number of variables in each polynomial</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.n_terms">
<span class="sig-name descname"><span class="pre">n_terms</span></span><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.n_terms" title="Link to this definition"></a></dt>
<dd><p>Number of terms in each polynomial</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.device" title="Link to this definition"></a></dt>
<dd><p>The device the tensors are stored on</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.dtype">
<span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.dtype" title="Link to this definition"></a></dt>
<dd><p>The data type of the tensors</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.shape" title="Link to this definition"></a></dt>
<dd><p>The batch dimensions (same as n_polys)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize multiple polynomials with exponents and coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp</strong> (<em>torch.Tensor</em>) – Exponents tensor of shape <span class="math notranslate nohighlight">\([N_1, \ldots, N_v, N_t]\)</span> where:
* <span class="math notranslate nohighlight">\(N_1, \ldots\)</span> = batch dimensions for multiple polynomials
* <span class="math notranslate nohighlight">\(N_v\)</span> = number of variables in each polynomial
* <span class="math notranslate nohighlight">\(N_t\)</span> = number of terms in each polynomial</p></li>
<li><p><strong>coef</strong> (<em>Optional</em><em>[</em><em>torch.Tensor</em><em>]</em><em>, </em><em>optional</em>) – Coefficients tensor of shape <span class="math notranslate nohighlight">\([N_1, \ldots, N_t]\)</span> where:
* <span class="math notranslate nohighlight">\(N_1, \ldots\)</span> = batch dimensions for multiple polynomials
* <span class="math notranslate nohighlight">\(N_t\)</span> = number of terms in each polynomial
If None, coefficients will be initialized as ones.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create 2x3 grid of polynomials x^2y + 2xy^2 + 3</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]])</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># [2,3,2,3]</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>              <span class="c1"># [2,3,3]</span>
<span class="n">polys</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>  <span class="c1"># 2x3 grid of polynomials</span>

<span class="c1"># Print shape</span>
<span class="nb">print</span><span class="p">(</span><span class="n">polys</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2,3)</span>

<span class="c1"># Access individual polynomials</span>
<span class="nb">print</span><span class="p">(</span><span class="n">polys</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># x^2y + 2xy^2 + 3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">polys</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># x^2y + 2xy^2 + 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">n_polys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Batch dimensions for multiple polynomials
:no-index:</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">n_vars</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>Number of variables in each polynomial
:no-index:</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">n_terms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd><p>Number of terms in each polynomial
:no-index:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.numel">
<span class="sig-name descname"><span class="pre">numel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.numel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.numel" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id10">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd><p>Get batch dimensions of polynomials.
:no-index:</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.ndim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.ndim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id11">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id12">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.dim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.forward" title="Link to this definition"></a></dt>
<dd><p>Evaluates the polynomial at the given input points.</p>
<p>For a polynomial <span class="math notranslate nohighlight">\(p(x) = \sum_i c_i \prod_j x_j^{e_{ij}}\)</span>, computes:</p>
<ol class="arabic simple">
<li><p>Evaluates each term by raising inputs to exponents</p></li>
<li><p>Multiplies terms by coefficients</p></li>
<li><p>Sums the terms</p></li>
</ol>
<p>For example, for polynomial <span class="math notranslate nohighlight">\(2x^2y + 3xy^2\)</span> with point <span class="math notranslate nohighlight">\([2,3]\)</span>:</p>
<div class="math notranslate nohighlight">
\[2(2^2 \cdot 3^1) + 3(2^1 \cdot 3^2) = 2(12) + 3(18) = 78\]</div>
<p>The computation is vectorized across batches and/or multiple polynomials.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single polynomial evaluation</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>  <span class="c1"># x^2y + xy^2</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>           <span class="c1"># 2x^2y + 3xy^2</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>          <span class="c1"># Point [2,3]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>                        <span class="c1"># 2*(2^2*3) + 3*(2*3^2) = 78.0</span>

<span class="c1"># Batch evaluation</span>
<span class="n">x_batch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>  <span class="c1"># 2 points</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="p">(</span><span class="n">x_batch</span><span class="p">))</span>                  <span class="c1"># [78.0, 14.0]</span>

<span class="c1"># Multiple polynomials</span>
<span class="n">polys</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="p">([</span><span class="n">poly</span><span class="p">,</span> <span class="n">poly</span><span class="p">])</span>     <span class="c1"># 2 copies of same polynomial</span>
<span class="nb">print</span><span class="p">(</span><span class="n">polys</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>                       <span class="c1"># [78.0, 78.0]</span>

<span class="c1"># Batch + multiple polynomials</span>
<span class="nb">print</span><span class="p">(</span><span class="n">polys</span><span class="p">(</span><span class="n">x_batch</span><span class="p">))</span>                 <span class="c1"># [[78.0, 78.0], [14.0, 14.0]]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em><em> [</em><em>n_batch</em><em>, </em><em>n_poly1</em><em>, </em><em>...</em><em>, </em><em>n_vars</em><em>] or </em><em>[</em><em>n_poly1</em><em>, </em><em>...</em><em>, </em><em>n_vars</em><em>]</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor [n_batch, n_poly1, …] or [n_poly1, …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.get_exp_terms">
<span class="sig-name descname"><span class="pre">get_exp_terms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.get_exp_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.get_exp_terms" title="Link to this definition"></a></dt>
<dd><p>Evaluates the polynomial terms for each input point by raising to the appropriate exponents.</p>
<p>For each input point <span class="math notranslate nohighlight">\(x\)</span> and term with exponents <span class="math notranslate nohighlight">\(e\)</span>, computes:</p>
<div class="math notranslate nohighlight">
\[x_0^{e_0} \cdot x_1^{e_1} \cdot \ldots \cdot x_n^{e_n}\]</div>
<p>For example, for polynomial <span class="math notranslate nohighlight">\(x^2y\)</span> with point <span class="math notranslate nohighlight">\([2,3]\)</span>, computes:</p>
<div class="math notranslate nohighlight">
\[2^2 \cdot 3^1 = 12\]</div>
<p>The computation is vectorized across batches and/or multiple polynomials.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single polynomial evaluation</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>  <span class="c1"># x^2y + xy^2</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>           <span class="c1"># 2x^2y + 3xy^2</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>          <span class="c1"># Point [2,3]</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">get_exp_terms</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>         <span class="c1"># [12, 18] (2^2*3, 2*3^2)</span>

<span class="c1"># Batch evaluation</span>
<span class="n">x_batch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>  <span class="c1"># 2 points</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">get_exp_terms</span><span class="p">(</span><span class="n">x_batch</span><span class="p">)</span>   <span class="c1"># [[12, 18], [2, 4]]</span>

<span class="c1"># Multiple polynomials</span>
<span class="n">polys</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="p">([</span><span class="n">poly</span><span class="p">,</span> <span class="n">poly</span><span class="p">])</span>     <span class="c1"># 2 copies of same polynomial</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">polys</span><span class="o">.</span><span class="n">get_exp_terms</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>        <span class="c1"># [[12, 18], [12, 18]]</span>

<span class="c1"># Batch + multiple polynomials</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">polys</span><span class="o">.</span><span class="n">get_exp_terms</span><span class="p">(</span><span class="n">x_batch</span><span class="p">)</span>  <span class="c1"># [[[12, 18], [12, 18]],</span>
                                     <span class="c1">#  [[2, 4], [2, 4]]]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em><em> [</em><em>n_batch</em><em>, </em><em>n_poly1</em><em>, </em><em>...</em><em>, </em><em>n_vars</em><em>] or </em><em>[</em><em>n_poly1</em><em>, </em><em>...</em><em>, </em><em>n_vars</em><em>]</em>) – Input points to evaluate. Can include a batch dimension.
n_poly1, … are optional polynomial batch dimensions.
Last dimension must match number of variables.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Evaluated terms for each input point.
Output has same batch/polynomial dimensions as input.
Last dimension contains values for each term.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor [n_batch, n_poly1, …, n_terms] or [n_poly1, …, n_terms]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.apply_coefficient">
<span class="sig-name descname"><span class="pre">apply_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.apply_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.apply_coefficient" title="Link to this definition"></a></dt>
<dd><p>Applies the polynomial coefficients to the evaluated terms.</p>
<p>For each polynomial with coefficients <span class="math notranslate nohighlight">\(c\)</span> and evaluated terms <span class="math notranslate nohighlight">\(t\)</span>, computes:</p>
<div class="math notranslate nohighlight">
\[\sum_i c_i t_i\]</div>
<p>For example, for polynomial <span class="math notranslate nohighlight">\(2x^2 + 3y\)</span> with evaluated terms <span class="math notranslate nohighlight">\([4,3]\)</span>, computes:</p>
<div class="math notranslate nohighlight">
\[2 \cdot 4 + 3 \cdot 3 = 17\]</div>
<p>The computation is vectorized across batches and/or multiple polynomials.</p>
<p>The coefficients are broadcast to match the batch dimensions of the input.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single polynomial evaluation</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>  <span class="c1"># x^2, y</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>           <span class="c1"># 2x^2 + 3y</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>          <span class="c1"># terms = [x^2=4, y=3]</span>
<span class="n">poly</span><span class="o">.</span><span class="n">apply_coefficient</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span>          <span class="c1"># 2*4 + 3*3 = 17</span>

<span class="c1"># Batch evaluation</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span> <span class="c1"># 2 points</span>
<span class="n">poly</span><span class="o">.</span><span class="n">apply_coefficient</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span>          <span class="c1"># [2*4 + 3*3, 2*1 + 3*2]</span>

<span class="c1"># Multiple polynomials</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="c1"># 2x^2 + 3y</span>
                  <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]])</span>  <span class="c1"># x^2y + xy</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span> <span class="c1"># terms for each polynomial</span>
<span class="n">poly</span><span class="o">.</span><span class="n">apply_coefficient</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span>          <span class="c1"># [2*4 + 3*3, 1*12 + 1*2]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – ND Tensor of shape [n_batch, n_poly1, …, n_terms] or [n_poly1, …, n_terms]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>ND Tensor of shape [n_batch, n_poly1, …, n_poly2] or [n_poly1, …, n_poly2] where:</p>
<ul class="simple">
<li><p>n_batch = number of input points (optional)</p></li>
<li><p>n_poly1, …, n_poly2 = polynomial dimensions</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.map">
<span class="sig-name descname"><span class="pre">map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.map" title="Link to this definition"></a></dt>
<dd><p>Evaluates the polynomial at given input points.</p>
<p>For each polynomial with coefficients c and exponents e, computes:</p>
<div class="math notranslate nohighlight">
\[\sum_i c_i \prod_j x_j^{e_{ij}}\]</div>
<p>For example, for polynomial <span class="math notranslate nohighlight">\(2x^2 + 3y\)</span> evaluated at point <span class="math notranslate nohighlight">\((2,3)\)</span>, computes:</p>
<div class="math notranslate nohighlight">
\[2 \cdot 2^2 + 3 \cdot 3 = 17\]</div>
<p>The computation is vectorized across batches and/or multiple polynomials.
The input points are broadcast to match the polynomial dimensions.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single polynomial evaluation</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>  <span class="c1"># x^2y, xy^2</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>           <span class="c1"># 2x^2y + 3xy^2</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>          <span class="c1"># Point (2,3)</span>
<span class="n">poly</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                           <span class="c1"># 2*(2^2*3) + 3*(2*3^2) = 24 + 54 = 78</span>
<span class="c1"># tensor(78.)</span>

<span class="c1"># Batch evaluation</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>  <span class="c1"># Two points</span>
<span class="n">poly</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                                  <span class="c1"># Evaluate at both points</span>
<span class="c1"># tensor([78., 14.])</span>

<span class="c1"># Multiple polynomials</span>
<span class="n">polys</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="p">([</span><span class="n">poly</span><span class="p">,</span> <span class="n">poly</span><span class="p">])</span>  <span class="c1"># Two copies of same polynomial</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>       <span class="c1"># Single point</span>
<span class="n">polys</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                       <span class="c1"># Evaluate both polynomials</span>
<span class="c1"># tensor([78., 78.])</span>

<span class="c1"># Batch + multiple polynomials</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>  <span class="c1"># Two points</span>
<span class="n">polys</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                                 <span class="c1"># Evaluate both polys at both points</span>
<span class="c1"># tensor([[78., 78.],</span>
<span class="c1">#         [14., 14.]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input points tensor of shape [n_batch, n_vars] or [n_vars].
Each row represents a point to evaluate the polynomial(s) at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Evaluated polynomial values. Shape is:
- [n_batch, n_poly1, …] if input is [n_batch, n_vars]
- [n_poly1, …] if input is [n_vars]
Where n_poly1, … are the polynomial batch dimensions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.map_exp_terms">
<span class="sig-name descname"><span class="pre">map_exp_terms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.map_exp_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.map_exp_terms" title="Link to this definition"></a></dt>
<dd><p>Evaluates the polynomial terms at given input points by applying exponents.</p>
<p>For each polynomial with exponents e, computes:</p>
<div class="math notranslate nohighlight">
\[\prod_j x_j^{e_{ij}}\]</div>
<p>For example, for polynomial terms <span class="math notranslate nohighlight">\(x^2y, xy^2\)</span> evaluated at point <span class="math notranslate nohighlight">\((2,3)\)</span>, computes:</p>
<div class="math notranslate nohighlight">
\[[2^2 \cdot 3^1, 2^1 \cdot 3^2] = [12, 18]\]</div>
<p>The computation is vectorized across batches and/or multiple polynomials.
The input points are broadcast to match the polynomial dimensions.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single polynomial, single point</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>  <span class="c1"># x^2y, xy^2</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>  <span class="c1"># Point (2,3)</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">map_exp_terms</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Evaluate terms</span>
<span class="c1"># tensor([12., 18.])  # 2^2 * 3^1, 2^1 * 3^2</span>

<span class="c1"># Single polynomial, batch of points</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>  <span class="c1"># Two points</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">map_exp_terms</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Evaluate terms at each point</span>
<span class="c1"># tensor([[12., 18.],  # Point 1: 2^2 * 3^1, 2^1 * 3^2</span>
<span class="c1">#         [1., 4.]])   # Point 2: 1^2 * 2^1, 1^1 * 2^2</span>

<span class="c1"># Multiple polynomials</span>
<span class="n">polys</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="p">([</span><span class="n">poly</span><span class="p">,</span> <span class="n">poly</span><span class="p">])</span>  <span class="c1"># Two copies</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>       <span class="c1"># Single point</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">polys</span><span class="o">.</span><span class="n">map_exp_terms</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>      <span class="c1"># Evaluate terms for both polys</span>
<span class="c1"># tensor([[12., 18.],</span>
<span class="c1">#         [12., 18.]])</span>

<span class="c1"># Batch + multiple polynomials</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>  <span class="c1"># Two points</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">polys</span><span class="o">.</span><span class="n">map_exp_terms</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>               <span class="c1"># Evaluate at each point</span>
<span class="c1"># tensor([[[12., 18.],</span>
<span class="c1">#          [12., 18.]],</span>
<span class="c1">#         [[1., 4.],</span>
<span class="c1">#          [1., 4.]]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input points tensor of shape [n_batch, n_vars] or [n_vars].
Each row represents a point to evaluate the polynomial terms at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Evaluated polynomial term values. Shape is:
- [n_batch, n_poly1, …, n_terms] if input is [n_batch, n_vars]
- [n_poly1, …, n_terms] if input is [n_vars]
Where n_poly1, … are the polynomial batch dimensions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.reshape">
<span class="sig-name descname"><span class="pre">reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.reshape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.reshape" title="Link to this definition"></a></dt>
<dd><p>Reshapes the polynomial batch dimensions.</p>
<p>Creates a new Polynomials object with the coefficients and exponents reshaped to the specified dimensions.
The total number of elements must remain the same.</p>
<p>Similar to torch.reshape(), this operation changes the batch dimensions while preserving the polynomial structure.
The n_vars and n_terms dimensions are preserved at the end.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>) – The new shape dimensions. The product of these dimensions must equal the product of the original batch dimensions.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new Polynomials object with reshaped batch dimensions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials">Polynomials</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>  <span class="c1"># shape (6,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reshaped</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>   <span class="c1"># shape (2,3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.transpose">
<span class="sig-name descname"><span class="pre">transpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.transpose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.transpose" title="Link to this definition"></a></dt>
<dd><p>Transposes the polynomial batch dimensions.</p>
<p>Creates a new Polynomials object with the coefficients and exponents transposed according to the specified dimension ordering.
The n_vars and n_terms dimensions are preserved at the end.</p>
<p>Similar to torch.transpose(), this operation permutes the batch dimensions while preserving the polynomial structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>) – The new ordering of dimensions. Must include all dimensions up to dim().</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new Polynomials object with transposed batch dimensions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials">Polynomials</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>  <span class="c1"># shape (2,3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transposed</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># shape (3,2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.deriv">
<span class="sig-name descname"><span class="pre">deriv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var_ind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.deriv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.deriv" title="Link to this definition"></a></dt>
<dd><p>Compute the derivative of the polynomial with respect to a variable.</p>
<p>For a polynomial <span class="math notranslate nohighlight">\(p(x_1,\ldots,x_n)\)</span>, computes <span class="math notranslate nohighlight">\(\frac{\partial p}{\partial x_i}\)</span>
where i is the specified variable index.</p>
<p>For example, given <span class="math notranslate nohighlight">\(p(x,y) = ax^ny^m\)</span>, the derivatives are:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\frac{\partial p}{\partial x} = nax^{n-1}y^m\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{\partial p}{\partial y} = max^ny^{m-1}\)</span></p></li>
</ul>
<p>The derivative is computed by:</p>
<ol class="arabic simple">
<li><p>Decrementing the exponent of the specified variable by 1</p></li>
<li><p>Multiplying coefficients by the original exponent</p></li>
<li><p>Setting terms with exponent 0 to 0</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single polynomial derivative</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>  <span class="c1"># x^2y + xy^2</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>           <span class="c1"># 2x^2y + 3xy^2</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>

<span class="c1"># Derivative with respect to x</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">deriv</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                    <span class="c1"># 4xy + 3y^2</span>

<span class="c1"># Derivative with respect to y</span>
<span class="n">dy</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">deriv</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                    <span class="c1"># 2x^2 + 6xy</span>

<span class="c1"># Multiple polynomials</span>
<span class="n">polys</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="p">([</span><span class="n">poly</span><span class="p">,</span> <span class="n">poly</span><span class="p">])</span>     <span class="c1"># [2x^2y + 3xy^2, 2x^2y + 3xy^2]</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">polys</span><span class="o">.</span><span class="n">deriv</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                   <span class="c1"># [4xy + 3y^2, 4xy + 3y^2]</span>
<span class="n">dy</span> <span class="o">=</span> <span class="n">polys</span><span class="o">.</span><span class="n">deriv</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                   <span class="c1"># [2x^2 + 6xy, 2x^2 + 6xy]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var_ind</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the index of the variable to be differentiated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>deriv_poly</strong> – the derivative of the polynomial</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial">Polynomial</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.grad">
<span class="sig-name descname"><span class="pre">grad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.grad" title="Link to this definition"></a></dt>
<dd><p>Compute the gradient of the polynomial.</p>
<p>For a polynomial <span class="math notranslate nohighlight">\(p(x_1,\ldots,x_n)\)</span>, returns a vector of partial derivatives:
<span class="math notranslate nohighlight">\(\nabla p = [\frac{\partial p}{\partial x_1}, \ldots, \frac{\partial p}{\partial x_n}]\)</span></p>
<p>For example, given <span class="math notranslate nohighlight">\(p(x,y) = ax^ny^m\)</span>, the gradient is:
<span class="math notranslate nohighlight">\(\nabla p = [nax^{n-1}y^m, max^ny^{m-1}]\)</span></p>
<p>The gradient is computed by taking the derivative with respect to each variable:</p>
<ol class="arabic simple">
<li><p>For each variable i=1…n:
- Compute <span class="math notranslate nohighlight">\(\frac{\partial p}{\partial x_i}\)</span> using deriv(i)</p></li>
<li><p>Stack the derivatives into a vector</p></li>
</ol>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single polynomial gradient</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>  <span class="c1"># x^2y + xy^2</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>           <span class="c1"># 2x^2y + 3xy^2</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>
<span class="n">grad</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">grad</span><span class="p">()</span>                    <span class="c1"># [4xy + 3y^2, 2x^2 + 6xy]</span>

<span class="c1"># Multiple polynomials</span>
<span class="n">polys</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="p">([</span><span class="n">poly</span><span class="p">,</span> <span class="n">poly</span><span class="p">])</span>     <span class="c1"># [2x^2y + 3xy^2, 2x^2y + 3xy^2]</span>
<span class="n">grad</span> <span class="o">=</span> <span class="n">polys</span><span class="o">.</span><span class="n">grad</span><span class="p">()</span>                   <span class="c1"># [[4xy + 3y^2, 4xy + 3y^2],</span>
                                     <span class="c1">#  [2x^2 + 6xy, 2x^2 + 6xy]]</span>

<span class="c1"># Evaluate gradient at points</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>          <span class="c1"># Point [2,3]</span>
<span class="n">grad_vals</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                   <span class="c1"># [[36, 36], [24, 24]]</span>

<span class="c1"># Batch evaluation</span>
<span class="n">x_batch</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span>   <span class="c1"># 2 points</span>
                      <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>
<span class="n">grad_vals</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">x_batch</span><span class="p">)</span>             <span class="c1"># [[[36, 36], [24, 24]],</span>
                                     <span class="c1">#  [[8, 8], [4, 4]]]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>grad_poly</strong> – the gradient of the polynomial</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PolynomialTensor [n_vars, n_poly1, …, n_polyn] n_vars=n_vars n_terms = n_terms</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.reset_coef">
<span class="sig-name descname"><span class="pre">reset_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.reset_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.reset_coef" title="Link to this definition"></a></dt>
<dd><p>Reset the coefficients of the polynomial
:param coef:
:type coef: torch.Tensor [n_poly, n_terms]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.repeat">
<span class="sig-name descname"><span class="pre">repeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.repeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.repeat" title="Link to this definition"></a></dt>
<dd><p>Repeat the polynomial along specified dimensions.</p>
<p>Creates a new Polynomials object by repeating the current polynomial’s coefficients and
exponents according to the provided repeat dimensions. This is similar to torch.repeat().</p>
<p>For example:
- repeat(3) creates 3 copies along a new first dimension
- repeat(2,3) creates a 2x3 grid of copies in new dimensions</p>
<p>The coefficients and exponents are repeated while preserving the polynomial structure,
effectively creating multiple independent copies of the same polynomial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of repetitions for each dimension. Must match the number of dimensions
in the polynomial (self.dim()).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new Polynomials object with the repeated structure. The shape will be
[args[0]*original_shape[0], args[1]*original_shape[1], …].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials">Polynomials</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tensormesh.element.polynomial.Polynomials.stack">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><span class="pre">Polynomial</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></span><a class="reference internal" href="../_modules/tensormesh/element/polynomial.html#Polynomials.stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.polynomial.Polynomials.stack" title="Link to this definition"></a></dt>
<dd><p>Stack multiple polynomials into a single Polynomials object.</p>
<p>Takes a sequence of Polynomial or Polynomials objects and stacks them along a new first dimension.
All polynomials must have the same number of variables and terms.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create two simple polynomials: x^2 + y and 2x + y^2</span>
<span class="n">exp1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>  <span class="c1"># Exponents for x^2 + y</span>
<span class="n">coef1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>     <span class="c1"># Coefficients [1,1]</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp1</span><span class="p">,</span> <span class="n">coef1</span><span class="p">)</span>

<span class="n">exp2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>  <span class="c1"># Exponents for 2x + y^2</span>
<span class="n">coef2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>     <span class="c1"># Coefficients [2,1]</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp2</span><span class="p">,</span> <span class="n">coef2</span><span class="p">)</span>

<span class="c1"># Stack the polynomials</span>
<span class="n">stacked</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stacked</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (2,)</span>

<span class="c1"># Evaluate stacked polynomials at point [2,3]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stacked</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># [7, 13] = [(2^2 + 3), (2*2 + 3^2)]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>polys</strong> (<em>Sequence</em><em>[</em><em>Union</em><em>[</em><a class="reference internal" href="#tensormesh.element.polynomial.Polynomial" title="tensormesh.element.polynomial.Polynomial"><em>Polynomial</em></a><em>, </em><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><em>Polynomials</em></a><em>]</em><em>]</em>) – Sequence of polynomials to stack. All must have same n_vars, n_terms, dtype and device.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new Polynomials object with shape [len(polys), …] containing the stacked polynomials.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials">Polynomials</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp1</span><span class="p">,</span> <span class="n">coef1</span><span class="p">)</span>  <span class="c1"># First polynomial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">exp2</span><span class="p">,</span> <span class="n">coef2</span><span class="p">)</span>  <span class="c1"># Second polynomial with same structure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stacked</span> <span class="o">=</span> <span class="n">Polynomials</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stacked</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2,)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-tensormesh.element.basis">
<span id="basis"></span><h2><a class="toc-backref" href="#id16" role="doc-backlink">Basis</a><a class="headerlink" href="#module-tensormesh.element.basis" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.lin_linspace">
<span class="sig-name descname"><span class="pre">lin_linspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#lin_linspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.lin_linspace" title="Link to this definition"></a></dt>
<dd><p>Generate evenly spaced points along a line segment.</p>
<p>Creates a linear interpolation between two endpoints, generating points that are evenly
spaced along the line segment. The number of points is determined by the order parameter.</p>
<p>For order=1, returns just the endpoints if include_boundary=True, or an empty tensor if
include_boundary=False.</p>
<p>For order&gt;1, returns order+1 evenly spaced points (including endpoints) if include_boundary=True,
or order-1 interior points if include_boundary=False.</p>
<p>The function handles both single edges and batches of edges.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">edge</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>  <span class="c1"># Single edge from (0,0) to (1,1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">lin_linspace</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">include_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">tensor([[0.0000, 0.0000],  # Start point</span>
<span class="go">        [0.3333, 0.3333],  # Interior point 1</span>
<span class="go">        [0.6667, 0.6667],  # Interior point 2</span>
<span class="go">        [1.0000, 1.0000]]) # End point</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">lin_linspace</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">include_boundary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">tensor([[0.3333, 0.3333],  # Interior point 1</span>
<span class="go">        [0.6667, 0.6667]]) # Interior point 2</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge</strong> (<em>torch.Tensor</em><em> [</em><em>n_batch</em><em>, </em><em>2</em><em>, </em><em>n_dim</em><em>] or </em><em>[</em><em>2</em><em>, </em><em>n_dim</em><em>]</em>)</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the linspace, should be at least 1, default is 1</p></li>
<li><p><strong>include_boundary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to include the boundary</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>if include_boundary</em> – torch.Tensor [n_batch, order+1, n_dim] or [order+1, n_dim]</p></li>
<li><p><em>else</em> – torch.Tensor [n_batch, order-1, n_dim] or [order-1, n_dim]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.quad_linspace">
<span class="sig-name descname"><span class="pre">quad_linspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#quad_linspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.quad_linspace" title="Link to this definition"></a></dt>
<dd><p>Generate evenly spaced points in a quadrilateral element.</p>
<p>This function takes a quadrilateral element defined by 4 vertices and generates a grid of evenly spaced points.
The points can optionally include or exclude the boundary points.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">quad</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">quad_linspace</span><span class="p">(</span><span class="n">quad</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">tensor([[0.0000, 0.0000],  # Bottom left</span>
<span class="go">        [0.5000, 0.0000],  # Bottom middle</span>
<span class="go">        [1.0000, 0.0000],  # Bottom right</span>
<span class="go">        [0.0000, 0.5000],  # Middle left</span>
<span class="go">        [0.5000, 0.5000],  # Center</span>
<span class="go">        [1.0000, 0.5000],  # Middle right</span>
<span class="go">        [0.0000, 1.0000],  # Top left</span>
<span class="go">        [0.5000, 1.0000],  # Top middle</span>
<span class="go">        [1.0000, 1.0000]]) # Top right</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">quad_linspace</span><span class="p">(</span><span class="n">quad</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">include_boundary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">tensor([[0.5000, 0.5000]]) # Only interior point</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quad</strong> (<em>torch.Tensor</em><em> [</em><em>n_batch</em><em>, </em><em>4</em><em>, </em><em>n_dim</em><em>] or </em><em>[</em><em>4</em><em>, </em><em>n_dim</em><em>]</em>)</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>include_boundary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to include the boundary</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>if include_boundary</em> – torch.Tensor [n_batch, (order+1)^2, n_dim] or [(order+1)^2, n_dim]</p></li>
<li><p><em>else</em> – torch.Tensor [n_batch, (order-1)^2, n_dim] or [(order-1)^2, n_dim]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.tri_linspace">
<span class="sig-name descname"><span class="pre">tri_linspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#tri_linspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.tri_linspace" title="Link to this definition"></a></dt>
<dd><p>Return evenly spaced points in a triangle.</p>
<p>The points are evenly spaced in barycentric coordinates. If include_boundary is True,
points on the boundary are included. Otherwise, only interior points are returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tri</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span> <span class="c1"># Unit triangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">tri_linspace</span><span class="p">(</span><span class="n">tri</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">tensor([[0.0000, 0.0000],  # Corner points</span>
<span class="go">        [0.5000, 0.0000],</span>
<span class="go">        [1.0000, 0.0000],</span>
<span class="go">        [0.0000, 0.5000],</span>
<span class="go">        [0.5000, 0.5000],</span>
<span class="go">        [0.0000, 1.0000]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">tri_linspace</span><span class="p">(</span><span class="n">tri</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">include_boundary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">tensor([[0.3333, 0.3333]]) # Only interior point</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tri</strong> (<em>torch.Tensor</em><em> [</em><em>n_batch</em><em>, </em><em>3</em><em>, </em><em>n_dim</em><em>] or </em><em>[</em><em>3</em><em>, </em><em>n_dim</em><em>]</em>)</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>include_boundary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to include the boundary</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor [n_batch, (order+1)*(order+2)/2, n_dim] or [(order+1)*(order+2)/2, n_dim]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.hex_linspace">
<span class="sig-name descname"><span class="pre">hex_linspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#hex_linspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.hex_linspace" title="Link to this definition"></a></dt>
<dd><p>Generate evenly spaced points inside a hexahedron.</p>
<p>For order k, points are placed at:</p>
<ul class="simple">
<li><p>Vertices (order 1)</p></li>
<li><p>Edge points at <span class="math notranslate nohighlight">\(\{1/k, 2/k, ..., (k-1)/k\}\)</span> along each edge (order &gt;= 2)</p></li>
<li><p>Face points in a rectangular pattern on each face (order &gt;= 3)</p></li>
<li><p>Interior points (order &gt;= 4)</p></li>
</ul>
<p>When include_boundary=False, only interior points are returned.</p>
<p>The number of points generated is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}N_{points} = \begin{cases}
    (n+1)^3 &amp; \text{if include_boundary=True} \\
    (n-1)^3 &amp; \text{if include_boundary=False}
\end{cases}\end{split}\]</div>
<p>where n is the order.</p>
<p>The points are arranged in a regular 3D grid pattern.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span>
<span class="go">        [0.0, 0.0, 0.0],  # vertex 0</span>
<span class="go">        [1.0, 0.0, 0.0],  # vertex 1</span>
<span class="go">        [0.0, 1.0, 0.0],  # vertex 2</span>
<span class="go">        [0.0, 0.0, 1.0],  # vertex 3</span>
<span class="go">        [1.0, 1.0, 0.0],  # vertex 4</span>
<span class="go">        [1.0, 0.0, 1.0],  # vertex 5</span>
<span class="go">        [0.0, 1.0, 1.0],  # vertex 6</span>
<span class="go">        [1.0, 1.0, 1.0]]) # vertex 7</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">hex_linspace</span><span class="p">(</span><span class="nb">hex</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">include_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">tensor([[0.0000, 0.0000, 0.0000],  # vertex 0</span>
<span class="go">        [0.5000, 0.0000, 0.0000],  # edge 01 midpoint</span>
<span class="go">        [1.0000, 0.0000, 0.0000],  # vertex 1</span>
<span class="go">        [0.0000, 0.5000, 0.0000],  # edge 02 midpoint</span>
<span class="go">        [0.5000, 0.5000, 0.0000],  # face center</span>
<span class="go">        [1.0000, 0.5000, 0.0000],  # edge 14 midpoint</span>
<span class="go">        [0.0000, 1.0000, 0.0000],  # vertex 2</span>
<span class="go">        [0.5000, 1.0000, 0.0000],  # edge 24 midpoint</span>
<span class="go">        [1.0000, 1.0000, 0.0000],  # vertex 4</span>
<span class="go">        [0.0000, 0.0000, 0.5000],  # edge 03 midpoint</span>
<span class="go">        [0.5000, 0.0000, 0.5000],  # face center</span>
<span class="go">        [1.0000, 0.0000, 0.5000],  # edge 15 midpoint</span>
<span class="go">        [0.0000, 0.5000, 0.5000],  # face center</span>
<span class="go">        [0.5000, 0.5000, 0.5000],  # cell center</span>
<span class="go">        [1.0000, 0.5000, 0.5000],  # face center</span>
<span class="go">        [0.0000, 1.0000, 0.5000],  # edge 26 midpoint</span>
<span class="go">        [0.5000, 1.0000, 0.5000],  # face center</span>
<span class="go">        [1.0000, 1.0000, 0.5000],  # edge 46 midpoint</span>
<span class="go">        [0.0000, 0.0000, 1.0000],  # vertex 3</span>
<span class="go">        [0.5000, 0.0000, 1.0000],  # edge 35 midpoint</span>
<span class="go">        [1.0000, 0.0000, 1.0000],  # vertex 5</span>
<span class="go">        [0.0000, 0.5000, 1.0000],  # edge 36 midpoint</span>
<span class="go">        [0.5000, 0.5000, 1.0000],  # face center</span>
<span class="go">        [1.0000, 0.5000, 1.0000],  # edge 56 midpoint</span>
<span class="go">        [0.0000, 1.0000, 1.0000],  # vertex 6</span>
<span class="go">        [0.5000, 1.0000, 1.0000],  # edge 67 midpoint</span>
<span class="go">        [1.0000, 1.0000, 1.0000]]) # vertex 7</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">hex_linspace</span><span class="p">(</span><span class="nb">hex</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">include_boundary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">tensor([[0.5000, 0.5000, 0.5000]]) # Only interior point</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hex</strong> (<em>Optional</em><em>[</em><em>torch.Tensor</em><em>]</em>) – [n_batch, 8 or 6 or 5 or 4, n_dim] or [8 or 6 or 5 or 4, n_dim]</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>include_boundary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to include the boundary</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor [n_batch, (order+1)^3 or (order-1)^3, n_dim] or [(order+1)^3 or (order-1)^3, n_dim]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.tet_linspace">
<span class="sig-name descname"><span class="pre">tet_linspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#tet_linspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.tet_linspace" title="Link to this definition"></a></dt>
<dd><p>Generate evenly spaced points inside a tetrahedron.</p>
<p>The points are generated by first creating a regular grid in a cube, then filtering points
to keep only those inside the tetrahedron. For order k, points are placed at:</p>
<ul class="simple">
<li><p>Vertices (order 1)</p></li>
<li><p>Edge points at <span class="math notranslate nohighlight">\(\{1/k, 2/k, ..., (k-1)/k\}\)</span> along each edge (order &gt;= 2)</p></li>
<li><p>Face points in a triangular pattern (order &gt;= 3)</p></li>
<li><p>Interior points (order &gt;= 4)</p></li>
</ul>
<p>When include_boundary=False, only interior points are returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tet</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">tet_linspace</span><span class="p">(</span><span class="n">tet</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">torch.Size([10, 3])  # 4 vertices + 6 edge midpoints</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">tet_linspace</span><span class="p">(</span><span class="n">tet</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">include_boundary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">torch.Size([1, 3])  # Only interior point</span>
</pre></div>
</div>
<p>The points are generated by first creating a regular grid in a cube, then filtering
points to keep only those inside the tetrahedron. For order k, points are placed at:
- Vertices (order 1)
- Edge points at 1/k, 2/k, …, (k-1)/k along each edge (order &gt;= 2)
- Face points in a triangular pattern (order &gt;= 3)
- Interior points (order &gt;= 4)</p>
<p>When include_boundary=False, only interior points are returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tet</strong> (<em>torch.Tensor</em><em> [</em><em>n_batch</em><em>, </em><em>4</em><em>, </em><em>n_dim</em><em>] or </em><em>[</em><em>4</em><em>, </em><em>n_dim</em><em>]</em>)</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>include_boundary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to include the boundary</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor [n_batch, (order+1)*(order+2)*(order+3)/6, n_dim] or [ (order+1)*(order+2)*(order+3)/6, n_dim]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.pyr_linspace">
<span class="sig-name descname"><span class="pre">pyr_linspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#pyr_linspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.pyr_linspace" title="Link to this definition"></a></dt>
<dd><p>Generate linearly spaced points inside a pyramid element.</p>
<p>The points are arranged in a structured pattern with:</p>
<ul class="simple">
<li><p>Vertex points (order &gt;= 1)</p></li>
<li><p>Edge points in a linear pattern (order &gt;= 2)</p></li>
<li><p>Face points in a triangular/quadrilateral pattern (order &gt;= 3)</p></li>
<li><p>Interior points (order &gt;= 4)</p></li>
</ul>
<p>When include_boundary=False, only interior points are returned.</p>
<p>The pyramid element has a square base and triangular faces meeting at an apex.
The points are distributed in a tensor-product pattern that gets narrower
towards the apex.</p>
<p>The number of points follows the pattern:</p>
<div class="math notranslate nohighlight">
\[\begin{split}N_{points} = \begin{cases}
    \frac{(n+1)(n+2)(2n+3)}{6} &amp; \text{if include_boundary=True} \\
    \frac{(n-1)(n)(2n-3)}{6} &amp; \text{if include_boundary=False}
\end{cases}\end{split}\]</div>
<p>where n is the order.</p>
<p>The points are arranged in layers from bottom to top, with each layer having
a square pattern that reduces in size towards the apex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyr</strong> (<em>torch.Tensor</em><em> [</em><em>n_batch</em><em>, </em><em>5</em><em>, </em><em>n_dim</em><em>] or </em><em>[</em><em>5</em><em>, </em><em>n_dim</em><em>]</em>)</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>include_boundary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to include the boundary</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor [n_batch, (order+1)*(order+2)*(2*order2)/6, n_dim] or [(order+1)*(order+2)*(2*order2)/6, n_dim]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.pri_linspace">
<span class="sig-name descname"><span class="pre">pri_linspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#pri_linspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.pri_linspace" title="Link to this definition"></a></dt>
<dd><p>Generate evenly spaced points inside a triangular prism.</p>
<p>The points are generated by first creating a regular grid in a hexahedron, then filtering points
to keep only those inside the prism. For order k, points are placed at:</p>
<ul class="simple">
<li><p>Vertices (order 1)</p></li>
<li><p>Edge points at <span class="math notranslate nohighlight">\(\{1/k, 2/k, ..., (k-1)/k\}\)</span> along each edge (order &gt;= 2)</p></li>
<li><p>Face points in a triangular pattern on triangular faces and rectangular pattern on quad faces (order &gt;= 3)</p></li>
<li><p>Interior points (order &gt;= 4)</p></li>
</ul>
<p>When include_boundary=False, only interior points are returned.</p>
<p>The number of points generated is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}N_{points} = \begin{cases}
    \frac{(n+1)^2(n+2)}{2} &amp; \text{if include_boundary=True} \\
    \frac{(n-1)^2(n)}{2} &amp; \text{if include_boundary=False}
\end{cases}\end{split}\]</div>
<p>where n is the order.</p>
<p>The points are arranged in triangular layers from bottom to top, with each layer having
the same triangular pattern.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pri</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">pri_linspace</span><span class="p">(</span><span class="n">pri</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">torch.Size([18, 3])  # 6 vertices + 9 edge midpoints + 3 face centers</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">pri_linspace</span><span class="p">(</span><span class="n">pri</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">include_boundary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">torch.Size([4, 3])  # Only interior points</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pri</strong> (<em>torch.Tensor</em><em> [</em><em>n_batch</em><em>, </em><em>6</em><em>, </em><em>n_dim</em><em>] or </em><em>[</em><em>6</em><em>, </em><em>n_dim</em><em>]</em>)</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>include_boundary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to include the boundary</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor [n_batch, (order+1)^2(order+2)/2, n_dim] or [(order+1)^2(order+2)/2, n_dim]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.lin_basis">
<span class="sig-name descname"><span class="pre">lin_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#lin_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.lin_basis" title="Link to this definition"></a></dt>
<dd><p class="rubric">Examples</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>order = 3

    0 -- 2 -- 3 -- 1
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, n_dim]</p></li>
<li><p><strong>vertex</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, 1]</p></li>
<li><p><strong>edge</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_edge, 2]
the coordinate of the edge</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis, should be at least 1</p></li>
<li><p><strong>1</strong> (<em>default is</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor of shape [n_basis, n_dim]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.tri_basis">
<span class="sig-name descname"><span class="pre">tri_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#tri_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.tri_basis" title="Link to this definition"></a></dt>
<dd><p class="rubric">Examples</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>triangle order = 3

    2
    |\
    | \
    4--6
    |  |\
    |  | \
    5--9--3
    |  |  |\
    |  |  | \
    0--7--8--1
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, n_dim]</p></li>
<li><p><strong>vertex</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, 1]</p></li>
<li><p><strong>edge</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_edge, 2]</p></li>
<li><p><strong>face</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [1, 3]</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis, should be at least 1
default is 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.quad_basis">
<span class="sig-name descname"><span class="pre">quad_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#quad_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.quad_basis" title="Link to this definition"></a></dt>
<dd><p class="rubric">Examples</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Quadrilateral element with order=3

2 - 10 - 11 - 3
|   |    |    |
7 - 14 - 15 - 9
|   |    |    |
6 - 12 - 13 - 8
|   |    |    |
0 - 4  - 5  - 1
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, n_dim]</p></li>
<li><p><strong>vertex</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, 1]</p></li>
<li><p><strong>edge</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_edge, 2]</p></li>
<li><p><strong>face</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [1, 4]</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis, should be at least 1
default is 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.tet_basis">
<span class="sig-name descname"><span class="pre">tet_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#tet_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.tet_basis" title="Link to this definition"></a></dt>
<dd><p>Generate basis points for a tetrahedral element.</p>
<p>For order k, points are placed at:</p>
<ul class="simple">
<li><p>Vertices (order 1)</p></li>
<li><p>Edge points at <span class="math notranslate nohighlight">\(\{1/k, 2/k, ..., (k-1)/k\}\)</span> along each edge (order &gt;= 2)</p></li>
<li><p>Face points in a triangular pattern on each face (order &gt;= 3)</p></li>
<li><p>Interior points (order &gt;= 4)</p></li>
</ul>
<p>When order=3, the basis points are arranged as (showing one face):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>           3
          /|\
         / | \
        /  |  \
       9   8   7
      /    |    \
     /     |     \
    /      |      \
   /   14  13  12  \
  /        |        \
 /         |         \
0-----4----5----6-----1
         Face 0

   Vertices: 0,1,2,3
   Edge points: 4,5,6,7,8,9,10,11
   Face points: 12,13,14,15,16,17,18,19
   Interior point: 20 (not shown)
</pre></div>
</div>
<p>The number of basis points is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}N_{points} = \begin{cases}
    4 &amp; \text{if order = 1} \\
    10 &amp; \text{if order = 2} \\
    20 &amp; \text{if order = 3} \\
    35 &amp; \text{if order = 4}
\end{cases}\end{split}\]</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span>
<span class="go">        [0,0,0], # vertex 0</span>
<span class="go">        [1,0,0], # vertex 1</span>
<span class="go">        [0,1,0], # vertex 2</span>
<span class="go">        [0,0,1]  # vertex 3</span>
<span class="go">    ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vertex</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edge</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">tet_basis</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vertex</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">torch.Size([10, 3])  # 4 vertices + 6 edge midpoints</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, n_dim]</p></li>
<li><p><strong>vertex</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, 1]</p></li>
<li><p><strong>edge</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_edge, 2]</p></li>
<li><p><strong>face</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_face, 3]</p></li>
<li><p><strong>cell</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [1, 4]</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis, should be at least 1,
default is 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.hex_basis">
<span class="sig-name descname"><span class="pre">hex_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#hex_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.hex_basis" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, n_dim]</p></li>
<li><p><strong>vertex</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, 1]</p></li>
<li><p><strong>edge</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_edge, 2]</p></li>
<li><p><strong>face</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_face, 4]</p></li>
<li><p><strong>cell</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [1, 6]</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis, should be at least 1,
default is 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.pyr_basis">
<span class="sig-name descname"><span class="pre">pyr_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#pyr_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.pyr_basis" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, n_dim]</p></li>
<li><p><strong>vertex</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, 1]</p></li>
<li><p><strong>edge</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_edge, 2]</p></li>
<li><p><strong>face</strong> (<em>Tuple</em><em>[</em><em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>,</em><em>...</em><em>]</em><em>,</em><em>...</em><em>]</em>) – Tuple of Tuple of int, each tuple is a face</p></li>
<li><p><strong>cell</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [1, 5]</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis, should be at least 1,
default is 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.pri_basis">
<span class="sig-name descname"><span class="pre">pri_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#pri_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.pri_basis" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, n_dim]</p></li>
<li><p><strong>vertex</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, 1]</p></li>
<li><p><strong>edge</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_edge, 2]</p></li>
<li><p><strong>face</strong> (<em>Tuple</em><em>[</em><em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>,</em><em>...</em><em>]</em><em>,</em><em>...</em><em>]</em>) – Tuple of Tuple of int, each tuple is a face</p></li>
<li><p><strong>cell</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [1, 6]</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis, should be at least 1,
default is 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – 2D Tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.accumulate_range">
<span class="sig-name descname"><span class="pre">accumulate_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nums</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#accumulate_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.accumulate_range" title="Link to this definition"></a></dt>
<dd><p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">accumulate_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">tensor([[0, 1],</span>
<span class="go">        [2, 3],</span>
<span class="go">        [4, 5]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">accumlate_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">((0, 1), (2, 3, 4))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the start index</p></li>
<li><p><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of batch</p></li>
<li><p><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of elements</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>index</strong> – 2D Tensor of shape [batch, num]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.index_reverse_mapping">
<span class="sig-name descname"><span class="pre">index_reverse_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#index_reverse_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.index_reverse_mapping" title="Link to this definition"></a></dt>
<dd><p>The last dimension of the index is a unique combination,
which could be found in the table. The combination will be substituted
by the index (row number) of the table.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Single tensor index</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_reverse_mapping</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
<span class="go">tensor([0, 1, 2])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Multiple tensor indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">index_reverse_mapping</span><span class="p">([</span><span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">],</span> <span class="n">table</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx1</span>
<span class="go">tensor([0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx2</span>
<span class="go">tensor([2, 3])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Union</em><em>[</em><em>torch.Tensor</em><em>,</em><em>Sequence</em><em>[</em><em>torch.Tensor</em><em>]</em><em>]</em>) – […, n_dim] or sequence of […, n_dim]</p></li>
<li><p><strong>table</strong> (<em>torch.Tensor</em>) – [n_combination, n_dim]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>index</strong> – […] or sequence of […]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.facet_basis_index_2d">
<span class="sig-name descname"><span class="pre">facet_basis_index_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#facet_basis_index_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.facet_basis_index_2d" title="Link to this definition"></a></dt>
<dd><p>Get the basis function indices for facets (edges) of a 2D element.</p>
<p>For a 2D element like a triangle or quadrilateral, this function returns the indices
of basis functions along each edge/facet. The indices include both vertex nodes and
any higher-order nodes along the edges.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vertex</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span>  <span class="c1"># Triangle vertices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edge</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>  <span class="c1"># Triangle edges</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">facet_basis_index_2d</span><span class="p">(</span><span class="n">vertex</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="go">tensor([[1, 2],  # First edge connects vertices 1-2</span>
<span class="go">        [0, 2],  # Second edge connects vertices 0-2</span>
<span class="go">        [0, 1]]) # Third edge connects vertices 0-1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">facet_basis_index_2d</span><span class="p">(</span><span class="n">vertex</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="go">tensor([[1, 2, 3],  # First edge: vertices 1-2 plus midpoint node 3</span>
<span class="go">        [0, 2, 4],  # Second edge: vertices 0-2 plus midpoint node 4</span>
<span class="go">        [0, 1, 5]]) # Third edge: vertices 0-1 plus midpoint node 5</span>
</pre></div>
</div>
<p>The returned indices can be used to extract basis functions or nodes along element edges,
which is useful for enforcing continuity between elements or applying boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vertex</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, 1]</p></li>
<li><p><strong>edge</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_edge, 2]</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis, should be at least 1
default is 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>index</strong> – 2D Tensor of shape [n_edge, order+1]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.tet_facet_basis_index">
<span class="sig-name descname"><span class="pre">tet_facet_basis_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#tet_facet_basis_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.tet_facet_basis_index" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vertex</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, 1]</p></li>
<li><p><strong>edge</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_edge, 2]</p></li>
<li><p><strong>face</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_face, 3]</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis, should be at least 1
default is 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>index</strong> – 2D Tensor of shape [n_face, (order+1)(order+2)//2]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.hex_facet_basis_index">
<span class="sig-name descname"><span class="pre">hex_facet_basis_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#hex_facet_basis_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.hex_facet_basis_index" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vertex</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, 1]</p></li>
<li><p><strong>edge</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_edge, 2]</p></li>
<li><p><strong>face</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_face, 4]</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis, should be at least 1
default is 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>index</strong> – 2D Tensor of shape [n_face, (order+1)(order+2)//2]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.mix_facet_basis_index">
<span class="sig-name descname"><span class="pre">mix_facet_basis_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#mix_facet_basis_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.mix_facet_basis_index" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vertex</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, 1]</p></li>
<li><p><strong>edge</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_edge, 2]</p></li>
<li><p><strong>face</strong> (<em>Tuple</em><em>[</em><em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>,</em><em>...</em><em>]</em><em>,</em><em>...</em><em>]</em>) – Tuple of Tuple of int, each tuple is a face</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the basis, should be at least 1
default is 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tri_index</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_tri_facet, n_basis_per_tri_facet]</p></li>
<li><p><strong>quad_index</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_quad_facet, n_basis_per_quad_facet]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.basis.edge_index">
<span class="sig-name descname"><span class="pre">edge_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/basis.html#edge_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.basis.edge_index" title="Link to this definition"></a></dt>
<dd><p>Get the edge basis indices for a given order.</p>
<p>For a given order n, returns the connectivity array for the edges of the element. Each row represents
an edge segment between two consecutive basis nodes along an edge.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vertex</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edge</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="n">edge_index</span><span class="p">(</span><span class="n">vertex</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span>
<span class="go">tensor([[0, 1],  # First edge segment</span>
<span class="go">        [1, 2]]) # Second edge segment</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Higher order elements have more segments per edge</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span> <span class="o">=</span> <span class="n">edge_index</span><span class="p">(</span><span class="n">vertex</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edges</span>
<span class="go">tensor([[0, 2],  # First edge divided into two segments</span>
<span class="go">        [2, 1],</span>
<span class="go">        [1, 3],  # Second edge divided into two segments</span>
<span class="go">        [3, 2]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vertex</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_vertex, 1]</p></li>
<li><p><strong>edge</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape [n_edge, 2]</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The order of the basis</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>edges</strong> – 2D Tensor of shape [n_ordered_edge, 2] containing edge segment connectivity</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-tensormesh.element.quadrature">
<span id="quadrature"></span><h2><a class="toc-backref" href="#id17" role="doc-backlink">Quadrature</a><a class="headerlink" href="#module-tensormesh.element.quadrature" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.quadrature.lin_quadrature">
<span class="sig-name descname"><span class="pre">lin_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/quadrature.html#lin_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.quadrature.lin_quadrature" title="Link to this definition"></a></dt>
<dd><p>Return the quadrature points within [0, 1]
:param order:
:type order: int, optional
:param dtype:
:type dtype: torch.dtype, optional
:param device:
:type device: torch.device, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>quadrature_weights</strong> (<em>torch.Tensor [n_quadrature]</em>)</p></li>
<li><p><strong>quadrature_points</strong> (<em>torch.Tensor [n_quadrature, dim]</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.quadrature.tri_quadrature">
<span class="sig-name descname"><span class="pre">tri_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/quadrature.html#tri_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.quadrature.tri_quadrature" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The default is 1.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>weights</strong> (<em>torch.Tensor [n_quadrature]</em>)</p></li>
<li><p><strong>points</strong> (<em>torch.Tensor [n_quadrature, 2]</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.quadrature.tet_quadrature">
<span class="sig-name descname"><span class="pre">tet_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/quadrature.html#tet_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.quadrature.tet_quadrature" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The default is 1.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>weights</strong> (<em>torch.Tensor [n_quadrature]</em>)</p></li>
<li><p><strong>points</strong> (<em>torch.Tensor [n_quadrature, 3]</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.quadrature.quad_quadrature">
<span class="sig-name descname"><span class="pre">quad_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/quadrature.html#quad_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.quadrature.quad_quadrature" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The default is 1.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>weights</strong> (<em>torch.Tensor [n_quadrature]</em>)</p></li>
<li><p><strong>points</strong> (<em>torch.Tensor [n_quadrature, 2]</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.quadrature.hex_quadrature">
<span class="sig-name descname"><span class="pre">hex_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/quadrature.html#hex_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.quadrature.hex_quadrature" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The default is 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>weights</strong> (<em>torch.Tensor [n_quadrature]</em>)</p></li>
<li><p><strong>points</strong> (<em>torch.Tensor [n_quadrature, 3]</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.quadrature.pyr_quadrature">
<span class="sig-name descname"><span class="pre">pyr_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/quadrature.html#pyr_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.quadrature.pyr_quadrature" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The default is 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>weights</strong> (<em>torch.Tensor [n_quadrature]</em>)</p></li>
<li><p><strong>points</strong> (<em>torch.Tensor [n_quadrature, 3]</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.quadrature.pri_quadrature">
<span class="sig-name descname"><span class="pre">pri_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/quadrature.html#pri_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.quadrature.pri_quadrature" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The default is 1.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>weights</strong> (<em>torch.Tensor [n_quadrature]</em>)</p></li>
<li><p><strong>points</strong> (<em>torch.Tensor [n_quadrature, 3]</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.quadrature.facet_quadrature_2d">
<span class="sig-name descname"><span class="pre">facet_quadrature_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">facet_mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/quadrature.html#facet_quadrature_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.quadrature.facet_quadrature_2d" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>facet_mapping</strong> (<a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><em>Polynomials</em></a><em> [</em><em>n_facet</em><em>, </em><em>dim</em><em>] </em><em>n_vars=dim-1</em><em>, </em><em>n_terms = dim</em>)</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the facet quadrature</p></li>
<li><p><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether transform to cell coordinate rather than facet coordinate,
if <cite>False</cite> the return shape will be  [n_quadrature_per_facet, dim-1]
default <cite>True</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>facet_quadrature_weights</strong> (<em>torch.Tensor</em>) – 2D tensor of shape [n_facet, n_quadrature_per_facet] or 1D tensor of shape[n_quadrature_per_facet]</p></li>
<li><p><strong>facet_quadrature_points</strong> (<em>torch.Tensor</em>) – 3D tensor of shape [n_facet, n_quadrature_per_facet, dim] or 2D tensor of shape[n_quadrature_per_facet, dim-1]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.quadrature.tet_facet_quadrature">
<span class="sig-name descname"><span class="pre">tet_facet_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">facet_mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/quadrature.html#tet_facet_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.quadrature.tet_facet_quadrature" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>facet_mapping</strong> (<em>PolynomialMatrix</em><em> [</em><em>n_facet</em><em>, </em><em>dim</em><em>] </em><em>n_vars=dim-1</em><em>, </em><em>n_terms = dim</em>)</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the facet quadrature</p></li>
<li><p><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether transform to cell coordinate rather than facet coordinate,
if <cite>False</cite> the return shape will be  [n_quadrature_per_facet, dim-1]
default <cite>True</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>facet_quadrature_weights</strong> (<em>torch.Tensor</em>) – 2D tensor of shape [n_facet, n_quadrature_per_facet] or 1D tensor of shape[n_quadrature_per_facet]</p></li>
<li><p><strong>facet_quadrature_points</strong> (<em>torch.Tensor</em>) – 3D tensor [n_facet, n_quadrature_per_facet, dim] or 2D tensor [n_quadrature_per_facet, dim-1]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.quadrature.hex_facet_quadrature">
<span class="sig-name descname"><span class="pre">hex_facet_quadrature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">facet_mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/quadrature.html#hex_facet_quadrature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.quadrature.hex_facet_quadrature" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>facet_mapping</strong> (<em>PolynomialMatrix</em><em> [</em><em>n_facet</em><em>, </em><em>dim</em><em>] </em><em>n_vars=dim-1</em><em>, </em><em>n_terms = dim</em>)</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the facet quadrature</p></li>
<li><p><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether transform to cell coordinate rather than facet coordinate,
if <cite>False</cite> the return shape will be  [n_quadrature_per_facet, dim-1]
default <cite>True</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>facet_qudrature_weights</strong> (<em>torch.Tensor</em>) – 2D tensor of shape [n_facet, n_quadrature_per_facet] or 1D tensor of shape[n_quadrature_per_facet]</p></li>
<li><p><strong>facet_quadrature_points</strong> (<em>torch.Tensor</em>) – 3D tensor of shape [n_facet, n_quadrature_per_facet, dim] or 1D tensor [n_quadrature_per_facet, dim-1]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.quadrature.mix_facet_quadrature_3d">
<span class="sig-name descname"><span class="pre">mix_facet_quadrature_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">facet_mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><span class="pre">Polynomials</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">facets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/tensormesh/element/quadrature.html#mix_facet_quadrature_3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.quadrature.mix_facet_quadrature_3d" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>facet_mapping</strong> (<a class="reference internal" href="#tensormesh.element.polynomial.Polynomials" title="tensormesh.element.polynomial.Polynomials"><em>Polynomials</em></a><em> [</em><em>n_facet</em><em>, </em><em>dim</em><em>] </em><em>n_vars=dim-1</em><em>, </em><em>n_terms = dim</em>)</p></li>
<li><p><strong>facets</strong> (<em>Tuple</em><em>[</em><em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>,</em><em>...</em><em>]</em><em>,</em><em>...</em><em>]</em>) – faces of the element</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the order of the facet quadrature</p></li>
<li><p><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether transform to cell coordinate rather than facet coordinate,
if <cite>False</cite> the return shape will be  [n_quadrature_per_facet, dim-1]
default <cite>True</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>if transform = <cite>False</cite></p></li>
<li><p><strong>tri_facet_quadrature_weights</strong> (<em>torch.Tensor [n_tri_facet, n_quadrature_per_facet]</em>)</p></li>
<li><p><strong>tri_facet_quadrature_points</strong> (<em>torch.Tensor[n_tri_facet, n_quadrature_per_facet, dim]</em>)</p></li>
<li><p><strong>quad_facet_quadrature_weights</strong> (<em>torch.Tensor [n_quad_facet, n_quadrature_per_facet]</em>)</p></li>
<li><p><strong>quad_facet_quadrature_points</strong> (<em>torch.Tensor[n_quad_facet, n_quadrature_per_facet, dim]</em>)</p></li>
<li><p>elif transform = <cite>True</cite></p></li>
<li><p><strong>tri_facet_quadrature_weights</strong> (<em>torch.Tensor [n_quadrature_per_tri_facet]</em>)</p></li>
<li><p><strong>tri_facet_quadrature_points</strong> (<em>torch.Tensor[n_quadrature_per_facet, dim-1]</em>)</p></li>
<li><p><strong>quad_facet_quadrature_weights</strong> (<em>torch.Tensor [n_quadrature_per_quad_facet]</em>)</p></li>
<li><p><strong>quad_facet_quadrature_points</strong> (<em>torch.Tensor[n_quadrature_per_facet, dim-1]</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-tensormesh.element.normal">
<span id="normal"></span><h2><a class="toc-backref" href="#id18" role="doc-backlink">Normal</a><a class="headerlink" href="#module-tensormesh.element.normal" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.normal.outwards_normal_2d">
<span class="sig-name descname"><span class="pre">outwards_normal_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/normal.html#outwards_normal_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.normal.outwards_normal_2d" title="Link to this definition"></a></dt>
<dd><p>compute the outwards normal for 2d convex polygons</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape (n_points, 2)</p></li>
<li><p><strong>edges</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape (n_edges, 2)</p></li>
<li><p><strong>is_right_hand</strong> (<em>torch.Tensor</em>) – 1D Tensor of shape (n_edges, )
if the outward normal is right-handed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>normals</strong> – 2D Tensor of shape (n_edges, 2)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tensormesh.element.normal.outwards_normal_3d">
<span class="sig-name descname"><span class="pre">outwards_normal_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tensormesh/element/normal.html#outwards_normal_3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tensormesh.element.normal.outwards_normal_3d" title="Link to this definition"></a></dt>
<dd><p>compute the outwards normal for 3d convex polyhedrons</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>torch.Tensor</em>) – 2D Tensor of shape (n_points, dim)</p></li>
<li><p><strong>faces</strong> (<em>Tuple</em><em>[</em><em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>,</em><em>...</em><em>]</em><em>,</em><em>...</em><em>]</em>) – Tuple of Tuple of int, each tuple is a face</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>normals</strong> – 2D Tensor of shape (n_faces, dim)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mesh.html" class="btn btn-neutral float-left" title="tensormesh.mesh" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="assemble.html" class="btn btn-neutral float-right" title="tensormesh.assemble" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, walkerchi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>